import{$ as it,Aa as Q,O as tt,S as et,T as at,V as O,Y as ot,Z as nt,_ as rt,fa as M,ka as st,ma as ct,z as R}from"./chunk-FWDXF6DS.js";import{P as K}from"./chunk-HZ46BFL2.js";import{Ja as X}from"./chunk-DALLY2ZR.js";import{cd as $,h as C,tb as E,xc as L}from"./chunk-4KPHYKUF.js";import{Bc as N,Ec as b,Pb as m,X as l,_ as p,ad as Z,qd as x,s as J,sd as v,v as W,vd as G,w as c}from"./chunk-ODNNZUPK.js";import{a as j,r as D}from"./chunk-LELMSWC2.js";import{h as U,k as Y}from"./chunk-L7YPSK2Y.js";import{a as n,g as H,i,n as s}from"./chunk-NSVULBS3.js";i();s();var q=H(j());i();s();var dt={location:0,distance:50,threshold:.2,shouldSort:!0,keys:[{name:"info.name",weight:.5},{name:"info.keybaseUsername",weight:.3},{name:"info.website",weight:.1},{name:"voteAccountPubkey",weight:.1},{name:"identityPubkey",weight:.1}]},mt={identityPublicKey:"7GkMBmtrTZz8QbjSe1sXvAUtz7Pp42SQxfT5ymmJD4We",voteAccountPublicKey:"J2nUHEAgZFRyuJbFjdqPrAa9gyWDuc7hErtDQHPhsYRp"};i();s();var ut=n(t=>(r,a)=>{let e=t.indexOf(r.voteAccountPubkey),u=t.indexOf(a.voteAccountPubkey);return(e>-1?e:1/0)-(u>-1?u:1/0)},"recommendedValidatorSorter");i();s();i();s();var lt=new Error("Failed to fetch recommended staking validators.");async function pt(){try{let t=await U.api().get("/staking/v1/recommended");if(!Y(t))throw lt;let r=t.data;return tt.parse(r).validators}catch{throw lt}}n(pt,"getRecommendedValidators");var St=n(()=>{let t=at.recommendedValidators();return G({enabled:!0,queryKey:t,gcTime:ot.Long,staleTime:nt.Never,async queryFn(){return pt()}})},"useRecommendedValidators");function kt(){let t=it(),{results:r=[]}=t,a=St(),{data:e=null,isFetched:u}=rt(),I=Z.isFeatureEnabled("kill-phantom-validator"),[P,o]=(0,q.useState)(""),d=X(P),h=(0,q.useMemo)(()=>{let A=r.map(V=>({...V,totalApy:V?.totalApy?et(V.totalApy):0})),T=a.data??[];if(T.length===0)return A;let f=A.sort(ut(T));return I?f.filter(V=>V.identityPubkey!==mt.identityPublicKey):f},[r,a.data,I]),w=R(h,d||"",dt),F=(0,q.useCallback)(()=>{t.isError&&!t.isFetching&&t.refetch(),a.isError&&!a.isFetching&&a.refetch()},[a,t]),S=!t.isFetched||!u||!a.isFetched,y=t.isError||a.isError,k=t.isSuccess;return{isLoading:S,isSuccess:k,hasError:y,searchResults:w,showApy:e!==null,onRefetch:F,searchTerm:P,setSearchTerm:o}}n(kt,"useValidatorListPageProps");i();s();function z({stakePubkey:t,authorizedPubkey:r,votePubkey:a}){return c.StakeProgram.delegate({stakePubkey:t,authorizedPubkey:r,votePubkey:a})}n(z,"delegateStake");var gt=n(t=>{let{t:r}=D(),a=x(),e=O(),{mutateAsync:u}=K(t);return v({mutationFn:n(async({accountIdentifier:o,senderAddress:d,stakePubkey:h,authorizedPubkey:w,votePubkey:F})=>{if(!d)throw M;let{networkID:S,address:y}=d,k=z({stakePubkey:h,authorizedPubkey:w,votePubkey:F}),A=await E(k,{connection:t}),T={ownerAddress:y??"",networkID:S,data:{signature:""},type:C.DelegateStake,display:{summary:{topLeft:{text:r("transactionsPendingDelegatingStake")}}}};e.approved({chainType:l.Solana,chainName:p.Solana,networkId:m.getSolanaNetworkIDValue(S),type:"delegate"});let f=await u({accountIdentifier:o,feePayer:new c.PublicKey(y),transaction:A,pendingTransactionInput:T});return e.submittedTransaction(f,{chainType:l.Solana,chainName:p.Solana,networkId:m.getSolanaNetworkIDValue(S),method:"signAndSendTransaction",walletAddress:y}),{networkID:S,id:f??""}},"mutationFn"),onSuccess:n(o=>{L({connection:t,signature:o.id}).then(()=>{e.transactionStatus(o.id,{chainType:l.Solana,chainName:p.Solana,networkId:m.getSolanaNetworkIDValue(o.networkID),status:{type:"confirmed"}})}).catch(d=>{e.transactionStatus(o.id,{chainType:l.Solana,chainName:p.Solana,networkId:m.getSolanaNetworkIDValue(o.networkID),status:{type:"error"}}),b.captureError(d,N.Staking)}),Q(t,o.id,a)},"onSuccess")})},"useDelegateStake");i();s();function ht({stakePubkey:t,authorizedPubkey:r,amount:a,transaction:e=new W.Transaction}){return e.add(c.StakeProgram.withdraw({stakePubkey:t,authorizedPubkey:r,toPubkey:r,lamports:a})),e}n(ht,"withdrawStake");var wt=n(t=>{let{t:r}=D(),a=x(),e=O(),{mutateAsync:u}=K(t);return v({mutationFn:n(async({accountIdentifier:o,senderAddress:d,stakePubkey:h,authorizedPubkey:w,amount:F})=>{if(!d)throw M;let{networkID:S,address:y}=d,k=ht({stakePubkey:h,authorizedPubkey:w,amount:F}),A=await E(k,{connection:t}),T={ownerAddress:y??"",networkID:S,data:{signature:""},type:C.WithdrawStake,display:{summary:{topLeft:{text:r("transactionsPendingWithdrawingStake")}}}};e.approved({chainType:l.Solana,chainName:p.Solana,networkId:m.getSolanaNetworkIDValue(S),type:"withdraw"});let f=await u({accountIdentifier:o,feePayer:new c.PublicKey(y),transaction:A,pendingTransactionInput:T});return e.submittedTransaction(f,{chainType:l.Solana,chainName:p.Solana,networkId:m.getSolanaNetworkIDValue(S),method:"signAndSendTransaction",walletAddress:y}),{networkID:S,id:f??""}},"mutationFn"),onSuccess:n(o=>{L({connection:t,signature:o.id}).then(()=>{e.transactionStatus(o.id,{chainType:l.Solana,chainName:p.Solana,networkId:m.getSolanaNetworkIDValue(o.networkID),status:{type:"confirmed"}})}).catch(d=>{e.transactionStatus(o.id,{chainType:l.Solana,chainName:p.Solana,networkId:m.getSolanaNetworkIDValue(o.networkID),status:{type:"error"}}),b.captureError(d,N.Staking)}),Q(t,o.id,a)},"onSuccess")})},"useWithdrawStake");i();s();function At({ownerPublicKey:t,lamports:r,transaction:a=new W.Transaction}){let e=c.Keypair.generate();return a.add(c.StakeProgram.createAccount({fromPubkey:t,stakePubkey:e.publicKey,authorized:new c.Authorized(t,t),lamports:r})),[a,e]}n(At,"createStakeAccount");function Tt({lamports:t,votePubkey:r,authorizedPubkey:a}){let[e,u]=At({ownerPublicKey:a,lamports:t});return e.add(z({stakePubkey:u.publicKey,authorizedPubkey:a,votePubkey:r})),[e,u]}n(Tt,"createStakeAccountAndDelegateStake");var Dt=n(t=>{let{t:r}=D(),a=x(),e=O(),{mutateAsync:u}=K(t);return v({mutationFn:n(async({accountIdentifier:o,senderAddress:d,lamports:h,votePubkey:w,authorizedPubkey:F,usdPerSol:S})=>{if(!d)throw M;let{networkID:y,address:k}=d,[A,T]=Tt({accountIdentifier:o,senderAddress:d,lamports:h,votePubkey:w,authorizedPubkey:F}),f=await E(A,{connection:t}),V={ownerAddress:k??"",networkID:y,data:{signature:""},type:C.CreateAccountAndDelegateStake,display:{summary:{topLeft:{text:r("transactionsPendingCreatingAndDelegatingStake")}}}};e.approved({chainType:l.Solana,chainName:p.Solana,networkId:m.getSolanaNetworkIDValue(y),type:"delegate"});let _=await u({accountIdentifier:o,feePayer:new c.PublicKey(k),transaction:f,pendingTransactionInput:V,opts:{additionalSignerAccounts:[T]}});e.submittedTransaction(_,{chainType:l.Solana,chainName:p.Solana,networkId:m.getSolanaNetworkIDValue(y),method:"signAndSendTransaction",walletAddress:k});let B=J(h),ft=S?B.times(S):void 0;return e.createStakeAccountAndDelegateStake({sol:B.toNumber(),usd:ft?.toNumber(),voteAccountPubkey:w}),{networkID:y,id:_??""}},"mutationFn"),onSuccess:n(o=>{L({connection:t,signature:o.id}).then(()=>{e.transactionStatus(o.id,{chainType:l.Solana,chainName:p.Solana,networkId:m.getSolanaNetworkIDValue(o.networkID),status:{type:"confirmed"}})}).catch(d=>{e.transactionStatus(o.id,{chainType:l.Solana,chainName:p.Solana,networkId:m.getSolanaNetworkIDValue(o.networkID),status:{type:"error"}}),b.captureError(d,N.Staking)}),Q(t,o.id,a)},"onSuccess")})},"useCreateStakeAccountAndDelegateStake");i();s();i();s();var yt=H(j());function It({navigateToConvertStakeAccount:t}){let{t:r}=D(),{pickedLSTProvider:a}=ct(m.solana.mainnetID),e=a($,!0),{hasConvertibleStakeAccounts:u}=st(e),I=r("convertToPhantomLST"),P=(0,yt.useCallback)(()=>{t()},[t]);return{shouldShowLiquidStakingCTA:u,title:I,onPress:P}}n(It,"useFooterButton");export{kt as a,It as b,gt as c,wt as d,Dt as e};
//# sourceMappingURL=chunk-RPAWFSR5.js.map
