import{a as Tr}from"./chunk-CHXPHGEW.js";import{a as Ut,b as Et,c as Je}from"./chunk-3JCRVFH6.js";import{a as B,l as gg}from"./chunk-JOOVJERF.js";import{a as hg}from"./chunk-Z4NIAEKD.js";import{A as wg,B as Sg,C as nl,D as bg,X as xg,a as gf,z as yg}from"./chunk-FWDXF6DS.js";import{A as ag,C as pn,E as ig,F as cg,J as _s,N as ug,O as dn,R as mt,a as Dm,ha as lg,i as tg,ia as pg,ib as Eg,j as rg,ma as mn,n as og,s as si,t as to,ta as ii,ua as dg,w as ai,wa as mg,x as ng,ya as fg,z as sg}from"./chunk-HZ46BFL2.js";import{a as Tg,b as Ag}from"./chunk-GW7A3FSK.js";import{a as $f}from"./chunk-KK53XKFJ.js";import{Ja as Ha,W as bf,e as wr,qa as Tf,s as Sf,ua as Cs}from"./chunk-DALLY2ZR.js";import{a as Nm}from"./chunk-MN377ENM.js";import{$a as Ga,Db as af,E as nn,G as Xu,H as Es,Hb as Ka,Ib as nr,Lb as cf,Mb as uf,Nb as lf,Pb as pf,Wb as df,Y as rf,b as Xm,e as Jm,jc as mf,m as ef,ma as Qa,n as on,na as yr,nc as We,ob as sf,ra as qa,rb as _e,rc as ff,s as tf,va as of}from"./chunk-4HRGOILD.js";import{$ as vf,$b as Ja,A as cn,Ab as tl,Ac as Vf,Ad as Xf,Bb as Nf,Bc as ln,Cc as jf,Dc as Hf,Hd as ko,Kb as Bf,Lb as Lf,Lc as ie,Mc as rl,Nc as ri,Pb as Uf,Q as $a,Qd as Jf,Rb as Mf,T as Cf,Tb as Of,Td as Co,U as Ee,V as Wa,Vb as Qf,Xb as qf,Y as _f,Yd as X,Z as If,Zb as zf,_ as Ff,_b as Gf,a as nf,aa as Za,ac as ei,b as za,ca as Pf,ee as eg,f as el,g as Af,gd as oi,h as kt,hb as Ya,i as an,ie as ol,j as Sr,je as ar,k as br,ld as oe,mb as Rf,md as St,nd as Wf,oe as je,pe as ni,sb as Xa,t as xf,tb as Df,u as Ef,vc as Kf,wd as sr,xc as un,y as kf,yd as Zf,zc as ti,zd as Yf}from"./chunk-4KPHYKUF.js";import{$c as hr,Ac as Y,Ad as Ym,Bc as M,Db as zE,Dc as en,E as Bm,Ec as P,G as Lm,Gb as GE,Ib as Om,Nb as Qm,Pb as x,Qb as Dr,Rb as ee,Sb as Yu,Tb as qm,Ub as Ot,Uc as Ke,Vb as et,Vc as Km,Wb as O,X as he,Xb as xs,Xc as Oa,Yb as zm,Yc as tn,Z as Um,Zc as rn,Zd as z,_ as ne,_b as fr,aa as Yo,ad as Ht,e as Ua,fd as wt,g as vm,ge as Se,i as xt,ic as Gm,id as Vm,jc as gr,jd as jm,m as Pm,ma as Mm,md as Hm,nc as Xo,oa as pt,oc as Jo,p as Rm,pa as we,pd as $m,qd as ze,sd as Eo,tb as Zu,td as Wm,ud as Zm,vd as ae,w as ve,wd as pe,x as $e}from"./chunk-ODNNZUPK.js";import{F as Im,G as Zo,P as Fm,d as _m}from"./chunk-UAQWDGIM.js";import{Fa as ks,Na as hf,T as Ju,X as eo,a as L,aa as Va,bb as yf,ca as fe,d as _,e as U,eb as HE,fb as $E,ga as Nr,hb as WE,ja as dt,la as ja,lb as sn,m as v,r as Ie,rb as wf,s as Ve,v as KE,wa as jE,y as VE}from"./chunk-LELMSWC2.js";import{h as K,k as le}from"./chunk-L7YPSK2Y.js";import{A as Mt,B as xo,C as or,g as i,j as Ma,y as ke}from"./chunk-VAUOTJLY.js";import{a as s,d as Ge,g as D,i as u,j as g,l as qE,m as Buffer,n as l}from"./chunk-NSVULBS3.js";var _g=Ge((Br,Cg)=>{u();l();var kg=typeof self<"u"?self:Br,ci=function(){function e(){this.fetch=!1,this.DOMException=kg.DOMException}return s(e,"F"),e.prototype=kg,new e}();(function(e){var t=function(r){var o={searchParams:"URLSearchParams"in e,iterable:"Symbol"in e&&"iterator"in Symbol,blob:"FileReader"in e&&"Blob"in e&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in e,arrayBuffer:"ArrayBuffer"in e};function n(k){return k&&DataView.prototype.isPrototypeOf(k)}if(s(n,"isDataView"),o.arrayBuffer)var a=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],c=ArrayBuffer.isView||function(k){return k&&a.indexOf(Object.prototype.toString.call(k))>-1};function p(k){if(typeof k!="string"&&(k=String(k)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(k))throw new TypeError("Invalid character in header field name");return k.toLowerCase()}s(p,"normalizeName");function m(k){return typeof k!="string"&&(k=String(k)),k}s(m,"normalizeValue");function d(k){var F={next:s(function(){var G=k.shift();return{done:G===void 0,value:G}},"next")};return o.iterable&&(F[Symbol.iterator]=function(){return F}),F}s(d,"iteratorFor");function f(k){this.map={},k instanceof f?k.forEach(function(F,G){this.append(G,F)},this):Array.isArray(k)?k.forEach(function(F){this.append(F[0],F[1])},this):k&&Object.getOwnPropertyNames(k).forEach(function(F){this.append(F,k[F])},this)}s(f,"Headers"),f.prototype.append=function(k,F){k=p(k),F=m(F);var G=this.map[k];this.map[k]=G?G+", "+F:F},f.prototype.delete=function(k){delete this.map[p(k)]},f.prototype.get=function(k){return k=p(k),this.has(k)?this.map[k]:null},f.prototype.has=function(k){return this.map.hasOwnProperty(p(k))},f.prototype.set=function(k,F){this.map[p(k)]=m(F)},f.prototype.forEach=function(k,F){for(var G in this.map)this.map.hasOwnProperty(G)&&k.call(F,this.map[G],G,this)},f.prototype.keys=function(){var k=[];return this.forEach(function(F,G){k.push(G)}),d(k)},f.prototype.values=function(){var k=[];return this.forEach(function(F){k.push(F)}),d(k)},f.prototype.entries=function(){var k=[];return this.forEach(function(F,G){k.push([G,F])}),d(k)},o.iterable&&(f.prototype[Symbol.iterator]=f.prototype.entries);function h(k){if(k.bodyUsed)return Promise.reject(new TypeError("Already read"));k.bodyUsed=!0}s(h,"consumed");function w(k){return new Promise(function(F,G){k.onload=function(){F(k.result)},k.onerror=function(){G(k.error)}})}s(w,"fileReaderReady");function y(k){var F=new FileReader,G=w(F);return F.readAsArrayBuffer(k),G}s(y,"readBlobAsArrayBuffer");function S(k){var F=new FileReader,G=w(F);return F.readAsText(k),G}s(S,"readBlobAsText");function T(k){for(var F=new Uint8Array(k),G=new Array(F.length),W=0;W<F.length;W++)G[W]=String.fromCharCode(F[W]);return G.join("")}s(T,"readArrayBufferAsText");function b(k){if(k.slice)return k.slice(0);var F=new Uint8Array(k.byteLength);return F.set(new Uint8Array(k)),F.buffer}s(b,"bufferClone");function A(){return this.bodyUsed=!1,this._initBody=function(k){this._bodyInit=k,k?typeof k=="string"?this._bodyText=k:o.blob&&Blob.prototype.isPrototypeOf(k)?this._bodyBlob=k:o.formData&&FormData.prototype.isPrototypeOf(k)?this._bodyFormData=k:o.searchParams&&URLSearchParams.prototype.isPrototypeOf(k)?this._bodyText=k.toString():o.arrayBuffer&&o.blob&&n(k)?(this._bodyArrayBuffer=b(k.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):o.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(k)||c(k))?this._bodyArrayBuffer=b(k):this._bodyText=k=Object.prototype.toString.call(k):this._bodyText="",this.headers.get("content-type")||(typeof k=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):o.searchParams&&URLSearchParams.prototype.isPrototypeOf(k)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},o.blob&&(this.blob=function(){var k=h(this);if(k)return k;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?h(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(y)}),this.text=function(){var k=h(this);if(k)return k;if(this._bodyBlob)return S(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(T(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},o.formData&&(this.formData=function(){return this.text().then(N)}),this.json=function(){return this.text().then(JSON.parse)},this}s(A,"Body");var E=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function C(k){var F=k.toUpperCase();return E.indexOf(F)>-1?F:k}s(C,"normalizeMethod");function I(k,F){F=F||{};var G=F.body;if(k instanceof I){if(k.bodyUsed)throw new TypeError("Already read");this.url=k.url,this.credentials=k.credentials,F.headers||(this.headers=new f(k.headers)),this.method=k.method,this.mode=k.mode,this.signal=k.signal,!G&&k._bodyInit!=null&&(G=k._bodyInit,k.bodyUsed=!0)}else this.url=String(k);if(this.credentials=F.credentials||this.credentials||"same-origin",(F.headers||!this.headers)&&(this.headers=new f(F.headers)),this.method=C(F.method||this.method||"GET"),this.mode=F.mode||this.mode||null,this.signal=F.signal||this.signal,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&G)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(G)}s(I,"Request"),I.prototype.clone=function(){return new I(this,{body:this._bodyInit})};function N(k){var F=new FormData;return k.trim().split("&").forEach(function(G){if(G){var W=G.split("="),re=W.shift().replace(/\+/g," "),Z=W.join("=").replace(/\+/g," ");F.append(decodeURIComponent(re),decodeURIComponent(Z))}}),F}s(N,"decode");function Q(k){var F=new f,G=k.replace(/\r?\n[\t ]+/g," ");return G.split(/\r?\n/).forEach(function(W){var re=W.split(":"),Z=re.shift().trim();if(Z){var He=re.join(":").trim();F.append(Z,He)}}),F}s(Q,"parseHeaders"),A.call(I.prototype);function R(k,F){F||(F={}),this.type="default",this.status=F.status===void 0?200:F.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in F?F.statusText:"OK",this.headers=new f(F.headers),this.url=F.url||"",this._initBody(k)}s(R,"Response"),A.call(R.prototype),R.prototype.clone=function(){return new R(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new f(this.headers),url:this.url})},R.error=function(){var k=new R(null,{status:0,statusText:""});return k.type="error",k};var H=[301,302,303,307,308];R.redirect=function(k,F){if(H.indexOf(F)===-1)throw new RangeError("Invalid status code");return new R(null,{status:F,headers:{location:k}})},r.DOMException=e.DOMException;try{new r.DOMException}catch{r.DOMException=function(F,G){this.message=F,this.name=G;var W=Error(F);this.stack=W.stack},r.DOMException.prototype=Object.create(Error.prototype),r.DOMException.prototype.constructor=r.DOMException}function q(k,F){return new Promise(function(G,W){var re=new I(k,F);if(re.signal&&re.signal.aborted)return W(new r.DOMException("Aborted","AbortError"));var Z=new XMLHttpRequest;function He(){Z.abort()}s(He,"abortXhr"),Z.onload=function(){var Ue={status:Z.status,statusText:Z.statusText,headers:Q(Z.getAllResponseHeaders()||"")};Ue.url="responseURL"in Z?Z.responseURL:Ue.headers.get("X-Request-URL");var st="response"in Z?Z.response:Z.responseText;G(new R(st,Ue))},Z.onerror=function(){W(new TypeError("Network request failed"))},Z.ontimeout=function(){W(new TypeError("Network request failed"))},Z.onabort=function(){W(new r.DOMException("Aborted","AbortError"))},Z.open(re.method,re.url,!0),re.credentials==="include"?Z.withCredentials=!0:re.credentials==="omit"&&(Z.withCredentials=!1),"responseType"in Z&&o.blob&&(Z.responseType="blob"),re.headers.forEach(function(Ue,st){Z.setRequestHeader(st,Ue)}),re.signal&&(re.signal.addEventListener("abort",He),Z.onreadystatechange=function(){Z.readyState===4&&re.signal.removeEventListener("abort",He)}),Z.send(typeof re._bodyInit>"u"?null:re._bodyInit)})}return s(q,"fetch"),q.polyfill=!0,e.fetch||(e.fetch=q,e.Headers=f,e.Request=I,e.Response=R),r.Headers=f,r.Request=I,r.Response=R,r.fetch=q,Object.defineProperty(r,"__esModule",{value:!0}),r}({})})(ci);ci.fetch.ponyfill=!0;delete ci.fetch.polyfill;var fn=ci;Br=fn.fetch;Br.default=fn.fetch;Br.fetch=fn.fetch;Br.Headers=fn.Headers;Br.Request=fn.Request;Br.Response=fn.Response;Cg.exports=Br});var Fg=Ge((qB,Ig)=>{u();l();(function(){var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",t={rotl:s(function(r,o){return r<<o|r>>>32-o},"rotl"),rotr:s(function(r,o){return r<<32-o|r>>>o},"rotr"),endian:s(function(r){if(r.constructor==Number)return t.rotl(r,8)&16711935|t.rotl(r,24)&4278255360;for(var o=0;o<r.length;o++)r[o]=t.endian(r[o]);return r},"endian"),randomBytes:s(function(r){for(var o=[];r>0;r--)o.push(Math.floor(Math.random()*256));return o},"randomBytes"),bytesToWords:s(function(r){for(var o=[],n=0,a=0;n<r.length;n++,a+=8)o[a>>>5]|=r[n]<<24-a%32;return o},"bytesToWords"),wordsToBytes:s(function(r){for(var o=[],n=0;n<r.length*32;n+=8)o.push(r[n>>>5]>>>24-n%32&255);return o},"wordsToBytes"),bytesToHex:s(function(r){for(var o=[],n=0;n<r.length;n++)o.push((r[n]>>>4).toString(16)),o.push((r[n]&15).toString(16));return o.join("")},"bytesToHex"),hexToBytes:s(function(r){for(var o=[],n=0;n<r.length;n+=2)o.push(parseInt(r.substr(n,2),16));return o},"hexToBytes"),bytesToBase64:s(function(r){for(var o=[],n=0;n<r.length;n+=3)for(var a=r[n]<<16|r[n+1]<<8|r[n+2],c=0;c<4;c++)n*8+c*6<=r.length*8?o.push(e.charAt(a>>>6*(3-c)&63)):o.push("=");return o.join("")},"bytesToBase64"),base64ToBytes:s(function(r){r=r.replace(/[^A-Z0-9+\/]/ig,"");for(var o=[],n=0,a=0;n<r.length;a=++n%4)a!=0&&o.push((e.indexOf(r.charAt(n-1))&Math.pow(2,-2*a+8)-1)<<a*2|e.indexOf(r.charAt(n))>>>6-a*2);return o},"base64ToBytes")};Ig.exports=t})()});var al=Ge((VB,vg)=>{u();l();var sl={utf8:{stringToBytes:s(function(e){return sl.bin.stringToBytes(unescape(encodeURIComponent(e)))},"stringToBytes"),bytesToString:s(function(e){return decodeURIComponent(escape(sl.bin.bytesToString(e)))},"bytesToString")},bin:{stringToBytes:s(function(e){for(var t=[],r=0;r<e.length;r++)t.push(e.charCodeAt(r)&255);return t},"stringToBytes"),bytesToString:s(function(e){for(var t=[],r=0;r<e.length;r++)t.push(String.fromCharCode(e[r]));return t.join("")},"bytesToString")}};vg.exports=sl});var Rg=Ge((WB,Pg)=>{u();l();(function(){var e=Fg(),t=al().utf8,r=al().bin,o=s(function(a){a.constructor==String?a=t.stringToBytes(a):typeof Buffer<"u"&&typeof Buffer.isBuffer=="function"&&Buffer.isBuffer(a)?a=Array.prototype.slice.call(a,0):Array.isArray(a)||(a=a.toString());var c=e.bytesToWords(a),p=a.length*8,m=[],d=1732584193,f=-271733879,h=-1732584194,w=271733878,y=-1009589776;c[p>>5]|=128<<24-p%32,c[(p+64>>>9<<4)+15]=p;for(var S=0;S<c.length;S+=16){for(var T=d,b=f,A=h,E=w,C=y,I=0;I<80;I++){if(I<16)m[I]=c[S+I];else{var N=m[I-3]^m[I-8]^m[I-14]^m[I-16];m[I]=N<<1|N>>>31}var Q=(d<<5|d>>>27)+y+(m[I]>>>0)+(I<20?(f&h|~f&w)+1518500249:I<40?(f^h^w)+1859775393:I<60?(f&h|f&w|h&w)-1894007588:(f^h^w)-899497514);y=w,w=h,h=f<<30|f>>>2,f=d,d=Q}d+=T,f+=b,h+=A,w+=E,y+=C}return[d,f,h,w,y]},"sha1"),n=s(function(a,c){var p=e.wordsToBytes(o(a));return c&&c.asBytes?p:c&&c.asString?r.bytesToString(p):e.bytesToHex(p)},"api");n._blocksize=16,n._digestsize=20,Pg.exports=n})()});var Bg=Ge((nL,YE)=>{YE.exports={name:"@phantom-labs/blocklist",version:"0.13.0",main:"index.js",types:"index.d.ts",repository:"git@github.com:phantom-labs/blocklist.git",author:"Jordan Leigh <AlwaysBCoding@gmail.com>",license:"MIT",scripts:{build:"node build.js"},dependencies:{"js-yaml":"^4.1.0",sha3:"^2.1.4"}}});var Lg=Ge((sL,XE)=>{XE.exports={blocklist:["phantomweb.app","aurory.app","solvision.io","staratlas.art","starsatlas.com","sollet.cc","raydlum.io","aurorynft.com","sneks.gg","solletweb.io","i-sollet.com","fancyfrenchienft.art","solanawebwallet.online","phahtom.com","server-syncwallet.com","staratias.app","raydium.network","grapesnetwork.me","staratias.art","soistarter.org","audius-nft.top","aurory.me","degenapes.app","phantom-app.online","phantomwallet.net","dapps-node.com","phantom-app.link","solanaoutage.com","walletconnectdapps.net","staratlas.cx","web-phantom.app","0120tt.com"],whitelist:[],fuzzylist:[],contentHash:"830ea1c9a833213eabc17990adf053081f503b1203ca9a2c711db7199e657293"}});var Ug=Ge(ul=>{u();l();var{version:JE}=Bg(),ek=Lg(),tk=s(()=>JE,"getVersion"),rk=s(()=>ek,"getBlocklist");ul.getVersion=tk;ul.getBlocklist=rk});var Og=Ge(hn=>{"use strict";u();l();hn.__esModule=!0;hn.distance=hn.closest=void 0;var Lr=new Uint32Array(65536),ok=s(function(e,t){for(var r=e.length,o=t.length,n=1<<r-1,a=-1,c=0,p=r,m=r;m--;)Lr[e.charCodeAt(m)]|=1<<m;for(m=0;m<o;m++){var d=Lr[t.charCodeAt(m)],f=d|c;d|=(d&a)+a^a,c|=~(d|a),a&=d,c&n&&p++,a&n&&p--,c=c<<1|1,a=a<<1|~(f|c),c&=f}for(m=r;m--;)Lr[e.charCodeAt(m)]=0;return p},"myers_32"),nk=s(function(e,t){for(var r=t.length,o=e.length,n=[],a=[],c=Math.ceil(r/32),p=Math.ceil(o/32),m=0;m<c;m++)a[m]=-1,n[m]=0;for(var d=0;d<p-1;d++){for(var f=0,h=-1,w=d*32,y=Math.min(32,o)+w,S=w;S<y;S++)Lr[e.charCodeAt(S)]|=1<<S;for(var m=0;m<r;m++){var T=Lr[t.charCodeAt(m)],b=a[m/32|0]>>>m&1,A=n[m/32|0]>>>m&1,E=T|f,C=((T|A)&h)+h^h|T|A,I=f|~(C|h),N=h&C;I>>>31^b&&(a[m/32|0]^=1<<m),N>>>31^A&&(n[m/32|0]^=1<<m),I=I<<1|b,N=N<<1|A,h=N|~(E|I),f=I&E}for(var S=w;S<y;S++)Lr[e.charCodeAt(S)]=0}for(var Q=0,R=-1,H=d*32,q=Math.min(32,o-H)+H,S=H;S<q;S++)Lr[e.charCodeAt(S)]|=1<<S;for(var k=o,m=0;m<r;m++){var T=Lr[t.charCodeAt(m)],b=a[m/32|0]>>>m&1,A=n[m/32|0]>>>m&1,E=T|Q,C=((T|A)&R)+R^R|T|A,I=Q|~(C|R),N=R&C;k+=I>>>o-1&1,k-=N>>>o-1&1,I>>>31^b&&(a[m/32|0]^=1<<m),N>>>31^A&&(n[m/32|0]^=1<<m),I=I<<1|b,N=N<<1|A,R=N|~(E|I),Q=I&E}for(var S=H;S<q;S++)Lr[e.charCodeAt(S)]=0;return k},"myers_x"),Mg=s(function(e,t){if(e.length<t.length){var r=t;t=e,e=r}return t.length===0?e.length:e.length<=32?ok(e,t):nk(e,t)},"distance");hn.distance=Mg;var sk=s(function(e,t){for(var r=1/0,o=0,n=0;n<t.length;n++){var a=Mg(e,t[n]);a<r&&(r=a,o=n)}return t[o]},"closest");hn.closest=sk});var Qg=Ge((ll,Is)=>{u();l();(function(){"use strict";var e;try{e=typeof Intl<"u"&&typeof Intl.Collator<"u"?Intl.Collator("generic",{sensitivity:"base"}):null}catch{console.log("Collator could not be initialized and wouldn't be used")}var t=Og(),r=[],o=[],n={get:s(function(a,c,p){var m=p&&e&&p.useCollator;if(m){var d=a.length,f=c.length;if(d===0)return f;if(f===0)return d;var h,w,y,S,T;for(y=0;y<f;++y)r[y]=y,o[y]=c.charCodeAt(y);r[f]=f;var b;for(y=0;y<d;++y){for(w=y+1,S=0;S<f;++S)h=w,b=e.compare(a.charAt(y),String.fromCharCode(o[S]))===0,w=r[S]+(b?0:1),T=h+1,w>T&&(w=T),T=r[S+1]+1,w>T&&(w=T),r[S]=h;r[S]=w}return w}return t.distance(a,c)},"get")};typeof define<"u"&&define!==null&&define.amd?define(function(){return n}):typeof Is<"u"&&Is!==null&&typeof ll<"u"&&Is.exports===ll?Is.exports=n:(typeof self<"u"&&typeof self.postMessage=="function"&&typeof self.importScripts=="function"||typeof self<"u"&&self!==null)&&(self.Levenshtein=n)})()});var Pb=Ge(vb=>{"use strict";u();l();var Xn=L();function Hv(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}s(Hv,"is");var $v=typeof Object.is=="function"?Object.is:Hv,Wv=Xn.useState,Zv=Xn.useEffect,Yv=Xn.useLayoutEffect,Xv=Xn.useDebugValue;function Jv(e,t){var r=t(),o=Wv({inst:{value:r,getSnapshot:t}}),n=o[0].inst,a=o[1];return Yv(function(){n.value=r,n.getSnapshot=t,dd(n)&&a({inst:n})},[e,r,t]),Zv(function(){return dd(n)&&a({inst:n}),e(function(){dd(n)&&a({inst:n})})},[e]),Xv(r),r}s(Jv,"useSyncExternalStore$2");function dd(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!$v(e,r)}catch{return!0}}s(dd,"checkIfSnapshotChanged");function eP(e,t){return t()}s(eP,"useSyncExternalStore$1");var tP=typeof self>"u"||typeof self.document>"u"||typeof self.document.createElement>"u"?eP:Jv;vb.useSyncExternalStore=Xn.useSyncExternalStore!==void 0?Xn.useSyncExternalStore:tP});var Db=Ge(Rb=>{"use strict";u();l();g.NODE_ENV!=="production"&&function(){function e(y,S){return y===S&&(y!==0||1/y===1/S)||y!==y&&S!==S}s(e,"is");function t(y,S){f||n.startTransition===void 0||(f=!0,console.error("You are using an outdated, pre-release alpha of React 18 that does not support useSyncExternalStore. The use-sync-external-store shim will not work correctly. Upgrade to a newer pre-release."));var T=S();if(!h){var b=S();a(T,b)||(console.error("The result of getSnapshot should be cached to avoid an infinite loop"),h=!0)}b=c({inst:{value:T,getSnapshot:S}});var A=b[0].inst,E=b[1];return m(function(){A.value=T,A.getSnapshot=S,r(A)&&E({inst:A})},[y,T,S]),p(function(){return r(A)&&E({inst:A}),y(function(){r(A)&&E({inst:A})})},[y]),d(T),T}s(t,"useSyncExternalStore$2");function r(y){var S=y.getSnapshot;y=y.value;try{var T=S();return!a(y,T)}catch{return!0}}s(r,"checkIfSnapshotChanged");function o(y,S){return S()}s(o,"useSyncExternalStore$1"),typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"&&typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStart=="function"&&__REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStart(Error());var n=L(),a=typeof Object.is=="function"?Object.is:e,c=n.useState,p=n.useEffect,m=n.useLayoutEffect,d=n.useDebugValue,f=!1,h=!1,w=typeof self>"u"||typeof self.document>"u"||typeof self.document.createElement>"u"?o:t;Rb.useSyncExternalStore=n.useSyncExternalStore!==void 0?n.useSyncExternalStore:w,typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"&&typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStop=="function"&&__REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStop(Error())}()});var fd=Ge((Yre,md)=>{"use strict";u();l();g.NODE_ENV==="production"?md.exports=Pb():md.exports=Db()});var Bb=Ge(Nb=>{"use strict";u();l();var ru=L(),rP=fd();function oP(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}s(oP,"is");var nP=typeof Object.is=="function"?Object.is:oP,sP=rP.useSyncExternalStore,aP=ru.useRef,iP=ru.useEffect,cP=ru.useMemo,uP=ru.useDebugValue;Nb.useSyncExternalStoreWithSelector=function(e,t,r,o,n){var a=aP(null);if(a.current===null){var c={hasValue:!1,value:null};a.current=c}else c=a.current;a=cP(function(){function m(y){if(!d){if(d=!0,f=y,y=o(y),n!==void 0&&c.hasValue){var S=c.value;if(n(S,y))return h=S}return h=y}if(S=h,nP(f,y))return S;var T=o(y);return n!==void 0&&n(S,T)?(f=y,S):(f=y,h=T)}s(m,"memoizedSelector");var d=!1,f,h,w=r===void 0?null:r;return[function(){return m(t())},w===null?void 0:function(){return m(w())}]},[t,r,o,n]);var p=sP(e,a[0],a[1]);return iP(function(){c.hasValue=!0,c.value=p},[p]),uP(p),p}});var Ub=Ge(Lb=>{"use strict";u();l();g.NODE_ENV!=="production"&&function(){function e(d,f){return d===f&&(d!==0||1/d===1/f)||d!==d&&f!==f}s(e,"is"),typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"&&typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStart=="function"&&__REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStart(Error());var t=L(),r=fd(),o=typeof Object.is=="function"?Object.is:e,n=r.useSyncExternalStore,a=t.useRef,c=t.useEffect,p=t.useMemo,m=t.useDebugValue;Lb.useSyncExternalStoreWithSelector=function(d,f,h,w,y){var S=a(null);if(S.current===null){var T={hasValue:!1,value:null};S.current=T}else T=S.current;S=p(function(){function A(Q){if(!E){if(E=!0,C=Q,Q=w(Q),y!==void 0&&T.hasValue){var R=T.value;if(y(R,Q))return I=R}return I=Q}if(R=I,o(C,Q))return R;var H=w(Q);return y!==void 0&&y(R,H)?(C=Q,R):(C=Q,I=H)}s(A,"memoizedSelector");var E=!1,C,I,N=h===void 0?null:h;return[function(){return A(f())},N===null?void 0:function(){return A(N())}]},[f,h,w,y]);var b=n(d,S[0],S[1]);return c(function(){T.hasValue=!0,T.value=b},[b]),m(b),b},typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"&&typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStop=="function"&&__REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStop(Error())}()});var Mb=Ge((coe,gd)=>{"use strict";u();l();g.NODE_ENV==="production"?gd.exports=Bb():gd.exports=Ub()});var EA=Ge((nhe,xA)=>{"use strict";u();l();xA.exports=e=>{if(Object.prototype.toString.call(e)!=="[object Object]")return!1;let t=Object.getPrototypeOf(e);return t===null||t===Object.prototype}});var vA=Ge((IA,FA)=>{"use strict";u();l();var Eu=EA(),{hasOwnProperty:CA}=Object.prototype,{propertyIsEnumerable:x1}=Object,ns=s((e,t,r)=>Object.defineProperty(e,t,{value:r,writable:!0,enumerable:!0,configurable:!0}),"defineProperty"),E1=IA,kA={concatArrays:!1,ignoreUndefined:!1},ku=s(e=>{let t=[];for(let r in e)CA.call(e,r)&&t.push(r);if(Object.getOwnPropertySymbols){let r=Object.getOwnPropertySymbols(e);for(let o of r)x1.call(e,o)&&t.push(o)}return t},"getEnumerableOwnPropertyKeys");function ss(e){return Array.isArray(e)?k1(e):Eu(e)?C1(e):e}s(ss,"clone");function k1(e){let t=e.slice(0,0);return ku(e).forEach(r=>{ns(t,r,ss(e[r]))}),t}s(k1,"cloneArray");function C1(e){let t=Object.getPrototypeOf(e)===null?Object.create(null):{};return ku(e).forEach(r=>{ns(t,r,ss(e[r]))}),t}s(C1,"cloneOptionObject");var _A=s((e,t,r,o)=>(r.forEach(n=>{typeof t[n]>"u"&&o.ignoreUndefined||(n in e&&e[n]!==Object.getPrototypeOf(e)?ns(e,n,Ld(e[n],t[n],o)):ns(e,n,ss(t[n])))}),e),"mergeKeys"),_1=s((e,t,r)=>{let o=e.slice(0,0),n=0;return[e,t].forEach(a=>{let c=[];for(let p=0;p<a.length;p++)CA.call(a,p)&&(c.push(String(p)),a===e?ns(o,n++,a[p]):ns(o,n++,ss(a[p])));o=_A(o,a,ku(a).filter(p=>!c.includes(p)),r)}),o},"concatArrays");function Ld(e,t,r){return r.concatArrays&&Array.isArray(e)&&Array.isArray(t)?_1(e,t,r):!Eu(t)||!Eu(e)?ss(t):_A(e,t,ku(t),r)}s(Ld,"merge");FA.exports=function(...e){let t=Ld(ss(kA),this!==E1&&this||{},kA),r={_:{}};for(let o of e)if(o!==void 0){if(!Eu(o))throw new TypeError("`"+o+"` is not an Option Object");r=Ld(r,{_:o},t)}return r._}});var Px=Ge((xTe,vx)=>{u();l();function CD(e,t,r,o){for(var n=-1,a=e==null?0:e.length;++n<a;){var c=e[n];t(o,c,r(c),e)}return o}s(CD,"arrayAggregator");vx.exports=CD});var Dx=Ge((_Te,Rx)=>{u();l();var _D=$E();function ID(e,t,r,o){return _D(e,function(n,a,c){t(o,n,r(n),c)}),o}s(ID,"baseAggregator");Rx.exports=ID});var Bx=Ge((PTe,Nx)=>{u();l();var FD=Px(),vD=Dx(),PD=jE(),RD=VE();function DD(e,t){return function(r,o){var n=RD(r)?FD:vD,a=t?t():{};return n(r,e,PD(o,2),a)}}s(DD,"createAggregator");Nx.exports=DD});var Ux=Ge((BTe,Lx)=>{u();l();var ND=KE(),BD=Bx(),LD=BD(function(e,t,r){ND(e,r,t)});Lx.exports=LD});u();l();u();l();var Dg=D(_g(),1),Ng=D(Rg(),1),il=D(qE(),1);var gn=(e=>(e.BLOCK="BLOCK",e.NONE="NONE",e))(gn||{});function ZE(e,t){for(let r=0;r<e.k;r++){let o=(0,Ng.default)(`${e.salt}_${t}_${r}`,{asBytes:!0}),a=il.Buffer.from(o).subarray(0,4).readUInt32BE(0)%e.bits,c=Math.floor(a/24),p=il.Buffer.from(e.bitVector.slice(c*4,c*4+4),"base64"),m=a%24,d=Math.floor(m/8),f=m%8;if(!(p[d]&1<<7-f))return!1}return!0}s(ZE,"lookup");var JB=typeof self<"u"&&self.fetch?self.fetch:Dg.default;function cl(e,t,r,o){let a=new URL(o).hostname.toLowerCase().replace(/\.$/,"").split(".");for(let c=0;c<a.length-1;c++){let p=a.slice(c).join(".");if(t.includes(p)||ZE(e,p)&&!r.includes(p))return"BLOCK"}return"NONE"}s(cl,"scanDomain");var ui=D(Ug());var Vg=D(Qg());u();l();var qg="https://blocklist.phantom.app/multichain.json",pl="https://blowfish-blocklist-proxy.phantom.app",ak="https://github.com/phantom-labs/blocklist",yL=s((e=3)=>({retry:e,retryDelay:s(t=>Math.min(1e3*2**t,3e4),"retryDelay")}),"reactQueryExponentialBackoff"),ik={SLIPPAGE_EXCEEDED:"SLIPPAGE_EXCEEDED",INSUFFICIENT_FUNDS:"INSUFFICIENT_FUNDS",INSUFFICIENT_GAS:"INSUFFICIENT_GAS",UNKNOWN_ERROR:"UNKNOWN_ERROR",SIMULATION_FAILED:"SIMULATION_FAILED",TRANSACTION_EXPIRED:"TRANSACTION_EXPIRED",ACCOUNT_FROZEN:"ACCOUNT_FROZEN",SIMULATION_TIMEOUT:"SIMULATION_TIMEOUT",STALE_QUOTE:"STALE_QUOTE"},ro;(function(e){e[e.info=5]="info",e[e.error=4]="error",e[e.criticalError=3]="criticalError",e[e.alert=2]="alert",e[e.criticalAlert=1]="criticalAlert"})(ro||(ro={}));function ck(e){return{[ro.criticalAlert]:"1-critical-alert",[ro.alert]:"2-alert",[ro.criticalError]:"3-critical-error",[ro.error]:"4-error",[ro.info]:"5-information"}[e]}s(ck,"scanWarningVariantToUiLevel");var uk=3,gl=6e5,lk=6e4,FL=i.object({type:i.union([i.literal("all"),i.literal("blocklist"),i.literal("whitelist"),i.literal("error"),i.literal("fuzzy"),i.literal("blowfishBloomFilter")]),result:i.boolean(),source:i.optional(i.string()),match:i.string().optional(),isSubdomainDomainWhitelisted:i.boolean().optional()}),vL=i.object({localHash:i.any(),cursor:i.any()}),hl=i.object({bitVector:i.string(),k:i.number(),hash:i.string(),bits:i.number(),salt:i.string()}),jg=i.union([i.object({bloomFilter:hl,bloomFilterHash:i.string(),recentlyAdded:i.array(i.string()),recentlyRemoved:i.array(i.string()),nextCursor:i.string()}),i.object({bloomFilter:hl.optional(),bloomFilterHash:i.optional(i.string()),recentlyAdded:i.array(i.string()),recentlyRemoved:i.array(i.string()),nextCursor:i.string()})]),Hg=i.object({bloomFilter:hl,lastUpdated:i.number()}).nullish(),$g=i.object({recentlyAdded:i.array(i.string()),recentlyRemoved:i.array(i.string()),lastUpdated:i.number().optional()}).nullish(),Fs=class{static{s(this,"PhishingDetector")}blocklist;whitelist;fuzzylist;tolerance;constructor(t,r,o,n){this.blocklist=dl(t),this.whitelist=dl(r),this.fuzzylist=dl(o),this.tolerance=n||uk}check(t,r){if(!t)return{type:"all",result:!1,isSubdomainDomainWhitelisted:!1};let o=li(t),n=yl(o);if(dk(n,this.whitelist)){let m=new URL(t).hostname;if(ml(yl(m),this.blocklist)){let f={type:"blocklist",result:!0,source:m,isSubdomainDomainWhitelisted:!0};return r.capture("blockedDomain",{data:f}),f}else return{type:"whitelist",result:!1,source:m,isSubdomainDomainWhitelisted:!0}}if(ml(n,this.whitelist))return{type:"whitelist",result:!1,source:o,isSubdomainDomainWhitelisted:!1};if(ml(n,this.blocklist)){let m={type:"blocklist",result:!0,source:o,isSubdomainDomainWhitelisted:!1};return r.capture("blockedDomain",{data:m}),m}if(this.tolerance>0){let m=zg(n);m=m.replace("www.","");let d=this.fuzzylist.find(f=>{let h=zg(f);return Vg.default.get(m,h)<=this.tolerance});if(d)return{type:"fuzzy",result:!0,match:pk(d),source:o,isSubdomainDomainWhitelisted:!1}}return{type:"all",result:!1,source:o,isSubdomainDomainWhitelisted:!1}}},li=s(e=>{let t=new URL(e).hostname.replace(/\.$/,"").split(".");return t.slice(0).slice(-(t.length===4?3:2)).join(".")},"removeSubdomainFromDomain"),dl=s(e=>e.map(yl),"processDomainList"),yl=s(e=>e.split(".").reverse(),"domainToParts"),pk=s(e=>e.slice().reverse().join("."),"domainPartsToDomain"),zg=s(e=>e.slice(1).reverse().join("."),"domainPartsToFuzzyForm"),ml=s((e,t)=>t.some(r=>r.length>e.length?!1:r.every((o,n)=>e[n]===o)),"matchPartsAgainstList"),dk=s((e,t)=>t.some(r=>r[0]===e[0]&&r[1]===e[1]&&r[2]==="*"),"matchWhitelistedHostingDomain"),mk=s(async e=>{let t=(0,ui.getBlocklist)(),r=await e.get(pe.CachedBlocklistDiff),o=null;try{o=JSON.parse(`${r}`)}catch(n){P.captureError(new Error(`Error parsing blocklist diff: ${n?.message}`),M.Generic)}if(o&&o.expiresAt&&o.expiresAt>Date.now())return new Fs(t.blocklist.concat(o.blocklist),t.whitelist.concat(o.whitelist),t.fuzzylist.concat(o.fuzzylist));{let n={},a=(0,ui.getVersion)();o&&(n.lastContentHash=`${o.contentHash}`),a&&(n.localBlocklistVersion=`${a}`);let c=await K.headers(n).get(qg);if(c.status===200){let p=c.data;return p.expiresAt=Date.now()+gl,e.set(pe.CachedBlocklistDiff,JSON.stringify(p)),new Fs(t.blocklist.concat(p.blocklist),t.whitelist.concat(p.whitelist),t.fuzzylist.concat(p.fuzzylist))}else{if(c.status===304)return o.expiresAt=Date.now()+gl,e.set(pe.CachedBlocklistDiff,JSON.stringify(o)),new Fs(t.blocklist.concat(o.blocklist),t.whitelist.concat(o.whitelist),t.fuzzylist.concat(o.fuzzylist));throw new Error("Invalid response from blocklist")}}},"updateLocalBlocklist"),fk=s(async(e,t,r)=>{let o,n;try{o=await Ht.isFeatureEnabledAsync("kill-blowfish-blocklist-cursor"),n=await Ht.isFeatureEnabledAsync("kill-previous-blocklist")}catch{o=!1,n=!1}let a;try{if(n)return o?Kg(r,e,t):Gg(r,e,t);{a=await mk(e);let c=a.check(r,t);return c.type==="all"?o?Kg(r,e,t):Gg(r,e,t):c}}catch{return{result:!1,type:"error",isSubdomainDomainWhitelisted:!1}}},"detectPhishing"),Gg=s(async(e,t,r)=>{if(!e)return{type:"all",result:!1,isSubdomainDomainWhitelisted:!1};let o=li(e),n=await t.getAll([pe.CachedBloomFilter,pe.CachedBloomFilterHash,pe.CachedScanDataRecents,pe.CachedScanDataCursor]),a=n[pe.CachedBloomFilter]??null,c=n[pe.CachedBloomFilterHash]??null,p=n[pe.CachedScanDataCursor]??null,m=n[pe.CachedScanDataRecents]??null,d=null,f={recentlyAdded:[],recentlyRemoved:[],lastUpdated:0},h=null;if(a){let y=Hg.safeParse(a);y.success?d=y.data:await fl(t)}if(m){let y=$g.safeParse(m);y.success?f=y.data:await fl(t)}if(p){let S=i.string().safeParse(p);S.success?h=S.data:await fl(t)}if(!f||f.lastUpdated==null||Date.now()>f.lastUpdated+lk){let y={localHash:c,cursor:h},S=await K.post(pl,y);if(S.status!==200)return{result:!1,type:"error",isSubdomainDomainWhitelisted:!1};let T=S.data,b,A=jg.safeParse(T);if(A.success)b=A.data;else return{result:!1,type:"error",isSubdomainDomainWhitelisted:!1};let E=[],C=[],I=typeof c=="string"&&b.bloomFilterHash?c!==b.bloomFilterHash:!1;f!=null&&!I&&(E=f.recentlyAdded,C=f.recentlyRemoved),E=E.concat(b.recentlyAdded),C=C.concat(b.recentlyRemoved),E=E.filter(Q=>b.recentlyRemoved.indexOf(Q)<0),C=C.filter(Q=>b.recentlyAdded.indexOf(Q)<0);let N={recentlyAdded:E,recentlyRemoved:C,lastUpdated:Date.now()};if(await t.set(pe.CachedScanDataRecents,N),f=N,b.nextCursor!==h&&await t.set(pe.CachedScanDataCursor,b.nextCursor),b.bloomFilter!=null){let Q={bloomFilter:b.bloomFilter,lastUpdated:Date.now()};await Promise.all([t.set(pe.CachedBloomFilter,Q),t.set(pe.CachedBloomFilterHash,b.bloomFilterHash)]),d=Q}}if(!d)return{type:"all",result:!1,isSubdomainDomainWhitelisted:!1};let w=cl(d.bloomFilter,f.recentlyAdded,f.recentlyRemoved,e);if(w===gn.BLOCK){let y={result:!0,source:o,type:"blowfishBloomFilter"};return r.capture("blockedDomain",{data:y}),y}else if(w===gn.NONE)return{result:!1,type:"all",isSubdomainDomainWhitelisted:!1};return{result:!1,type:"error",isSubdomainDomainWhitelisted:!1}},"checkBlowfishBlocklist");async function fl(e){await e.remove([pe.CachedBloomFilter,pe.CachedBloomFilterHash,pe.CachedScanDataRecents,pe.CachedScanDataCursor])}s(fl,"resetState");var Kg=s(async(e,t,r)=>{if(!e)return{type:"all",result:!1,isSubdomainDomainWhitelisted:!1};let o=li(e),n=await t.getAll([pe.CachedBloomFilter,pe.CachedBloomFilterHash,pe.CachedScanDataRecents]),a=n[pe.CachedBloomFilter]??null,c=n[pe.CachedBloomFilterHash]??null,p=n[pe.CachedScanDataRecents]??null,m=null,d={recentlyAdded:[],recentlyRemoved:[],lastUpdated:0};if(a){let h=Hg.safeParse(a);h.success?m=h.data:await t.remove([pe.CachedBloomFilter,pe.CachedBloomFilterHash,pe.CachedScanDataRecents])}if(p){let h=$g.safeParse(p);h.success?d=h.data:await t.remove([pe.CachedBloomFilter,pe.CachedBloomFilterHash,pe.CachedScanDataRecents])}if(!d||d.lastUpdated==null||Date.now()>d.lastUpdated+gl){let h={localHash:c},w=await K.post(pl,h);if(w.status!==200)return{result:!1,type:"error",isSubdomainDomainWhitelisted:!1};let y=w.data,S,T=jg.safeParse(y);if(T.success)S=T.data;else return{result:!1,type:"error",isSubdomainDomainWhitelisted:!1};let b={recentlyAdded:S.recentlyAdded,recentlyRemoved:S.recentlyRemoved,lastUpdated:Date.now()};if(await t.set(pe.CachedScanDataRecents,b),d=b,S.bloomFilter!=null){let A={bloomFilter:S.bloomFilter,lastUpdated:Date.now()};await Promise.all([t.set(pe.CachedBloomFilter,A),t.set(pe.CachedBloomFilterHash,S.bloomFilterHash)]),m=A}}if(!m)return{type:"all",result:!1,isSubdomainDomainWhitelisted:!1};let f=cl(m.bloomFilter,d.recentlyAdded,d.recentlyRemoved,e);if(f===gn.BLOCK){let h={result:!0,source:o,type:"blowfishBloomFilter"};return r.capture("blockedDomain",{data:h}),h}else if(f===gn.NONE)return{result:!1,type:"all",isSubdomainDomainWhitelisted:!1};return{result:!1,type:"error",isSubdomainDomainWhitelisted:!1}},"checkBlowfishBlocklistOld");u();l();u();l();var gk=s(e=>e/1e8,"satsToBTC");u();l();u();l();u();l();var _o;(function(e){e.Plus="PLUS",e.Minus="MINUS",e.Equal="EQUAL"})(_o||(_o={}));var wl;(function(e){e.fungible="fungible",e.collectible="collectible",e.native="native",e.unknown="unknown"})(wl||(wl={}));var Sl;(function(e){e.approval="approval",e.revokal="revokal",e.transfer="transfer",e.mint="mint",e.unknown="unknown"})(Sl||(Sl={}));var yn;(function(e){e.Green="GREEN",e.Red="RED",e.White="WHITE"})(yn||(yn={}));var pi={[yn.Green]:"spotPositive",[yn.Red]:"spotNegative",[yn.White]:"textBase"};function hk(e){switch(e){case _o.Plus:return pi.GREEN;case _o.Minus:return pi.RED;case _o.Equal:return pi.WHITE;default:return pi.WHITE}}s(hk,"getColorForStateChangeSign");function yk(e){let t=e?.advancedDetails&&"safeguard"in e.advancedDetails?e?.advancedDetails?.safeguard:void 0;if(t?.recommended&&!t?.shouldBundle&&!t.error&&!t.verifyError&&t?.transactions&&t.transactions.length>0)return t.transactions}s(yk,"extractSafeguardTransactions");function Wg(e,t){if(e.params&&"safeguard"in e.params&&e.params.safeguard&&t?.advancedDetails&&"safeguard"in t.advancedDetails&&t.advancedDetails.safeguard?.transactions){let r=t.advancedDetails.safeguard;if(r.error)return r.error;let o=e.params.transactions,n=r.transactions;if(n){let a;try{Hf(o,n)}catch(c){c instanceof ln?a=c:c instanceof Error?a=ln.createUnknownError(c.message):a=ln.createUnknownError("Non error type",c)}if(a)return t.advancedDetails.safeguard.verifyError=a,a}}}s(Wg,"processSafeguardErrors");function Zg(e){if(e.advancedDetails&&"requestId"in e.advancedDetails)return e.advancedDetails.requestId}s(Zg,"extractRequestId");u();l();var wk=s(async(e,t,r)=>{let o=`/simulation/v1?language=${e}`,n=await K.api().post(o,{...r,chainId:r.networkID,appVersion:ke,platform:Mt,deviceId:t});if(!le(n))throw new Error("Failed to scan message");return n.data},"getScanMessage"),bl=s(async(e,t,r)=>{let o=`/simulation/v1?language=${e}`,n={...r.params,...r.params&&"safeguard"in r.params?{safeguard:{...r.params.safeguard,lighthouseProgramId:jf}}:{}},a=await K.api().post(o,{...r,chainId:r.networkID,params:n,metadata:r.metadata,appVersion:ke,platform:Mt,deviceId:t});if(!le(a))throw new Error("Failed to scan transaction");let c=a.data,p=Wg(r,c);if(p instanceof ln){let m=Zg(c);P.captureMessage(`Verify error ${m??""}: ${p.message}`,M.Safeguard)}return c},"getScanTransaction");var cU=i.union([i.literal("signTransaction"),i.literal("signAllTransactions"),i.literal("signAndSendTransaction"),i.literal("signAndSendAllTransactions")]);u();l();var Tl=(J=>(J.HasOnboarded="hasOnboarded",J.ResetHasOnboarded="resetHasOnboarded",J.LockExtension="lockExtension",J.UnlockExtension="unlockExtension",J.IsExtensionUnlocked="IsExtensionUnlocked",J.SetPassword="setPassword",J.VerifyPassword="verifyPassword",J.UpdatePassword="updatePassword",J.ImportPrivateKeyAccount="importPrivateKeyAccount",J.ImportReadOnlyAccount="importReadOnlyAccount",J.ImportSeedAccount="importSeedAccount",J.ImportSeedlessAccount="importSocialSeedAccount",J.IsExistingSeed="isExistingSeed",J.AddAccountForSeed="addAccountForSeed",J.AddAccountForSeedless="addAccountForSeedless",J.AddLedgerAccounts="addLedgerAccounts",J.DeriveAddresses="deriveAddresses",J.ExportPrivateKey="exportPrivateKey",J.ExportEntropy="exportEntropy",J.SetAccountIcon="setAccountIcon",J.RemoveAccount="removeAccount",J.ReorderAccount="reorderAccount",J.GetAllAccounts="getAllAccounts",J.GetAllSeeds="getAllSeeds",J.GetAllSeedless="getAllSeedlessSeeds",J.GetAuthenticationPublicKey="getAuthenticationPublicKey",J.Sign="sign",J.CheckVaultIntegrity="checkVaultIntegrity",J.GetPhantomOrganization="getPhantomOrganization",J.GetOrCreatePhantomOrganization="getOrCreatePhantomOrganization",J.RetrieveKMSWallet="RetrieveKMSWallet",J.GetKMSWalletStatus="GetKMSWalletStatus",J.AddUserToCurrentUserOrganization="addUserToCurrentUserOrganization",J.DeleteUserFromOrganization="deleteUserFromOrganization",J.UpdateUserInOrganization="updateUserInOrganization",J.GetAccounts="getAccounts",J.GetKmsAccounts="getKmsAccounts",J.GetWalletWithTag="getWalletWithTag",J.LogMessage="logMessage",J.DownloadLogs="downloadLogs",J.ProviderInjectionOptions="providerInjectionOptions",J.ServiceWorkerMutexAcquire="serviceWorkerMutexAcquire",J.ServiceWorkerMutexRelease="serviceWorkerMutexRelease",J))(Tl||{});u();l();var Yg=i.enum(["Native","Fungible","SemiFungible","NonFungible","Unknown"]),Ur=i.object({id:i.string(),displayName:i.string().optional(),logoURI:i.union([i.string(),i.null()]).optional(),tokenType:Yg,decimals:i.number().optional(),symbol:i.string().optional(),isSpam:i.boolean().optional()}),Xg=i.object({id:Dr,displayName:i.string(),logoURI:i.union([i.string(),i.null()]).optional()}),di=i.object({token:Ur,amount:i.string(),to:Dr,from:Dr}),Al=i.literal("UNCLASSIFIED_APP_INTERACTION"),xl=i.literal("TOKEN_SEND"),El=i.literal("TOKEN_BURN"),kl=i.literal("TOKEN_SWAP"),Cl=i.literal("TOKEN_UNWRAP"),_l=i.literal("WITHDRAW_STAKE"),Il=i.literal("DEACTIVATE_STAKE"),Fl=i.literal("STAKE"),vl=i.literal("COLLECTIBLE_LIST"),Pl=i.literal("COLLECTIBLE_BUY_ITEM"),Rl=i.literal("COLLECTIBLE_CANCEL_BID"),Dl=i.literal("COLLECTIBLE_BID_ITEM"),Nl=i.literal("COLLECTIBLE_UNLIST"),Bl=i.literal("COLLECTIBLE_SELL_ITEM"),Ll=i.literal("CANCEL_TX"),Ul=i.literal("TOKEN_APPROVAL"),Ml=i.literal("CANCEL_ORDER"),Ol=i.literal("COLLECTION_APPROVAL"),Ql=i.literal("BRIDGE_INIT"),Sk=i.union([Al,xl,El,kl,Cl,_l,Il,Fl,vl,Pl,Rl,Dl,Nl,Bl,Ll,Ul,Ml,Ol,Ql]),Jg=i.object({transactionType:Al,balanceChanges:i.array(di),dapp:i.union([Sr,i.null()]).optional()}),eh=i.object({transactionType:xl,balanceChanges:i.array(di).nonempty(),dapp:i.union([Sr,i.null()]).optional()}),th=i.object({transactionType:El,dapp:i.union([Sr,i.null()]).optional(),token:Ur,amount:i.string()}),rh=i.object({transactionType:kl,dapp:i.union([Sr,i.null()]).optional(),receiveToken:Ur,sendToken:Ur,receiveAmount:i.string(),sendAmount:i.string()}),oh=i.object({transactionType:Cl,token:Ur,amount:i.string()}),nh=i.object({transactionType:_l,stakeAccount:Dr,amount:i.string()}),sh=i.object({transactionType:Il,stakeAccount:Dr,amount:i.string()}),ah=i.object({transactionType:Fl,stakeAccount:Dr,amount:i.string(),validatorName:i.string().optional(),validatorWebsite:i.string().optional(),keybaseUsername:i.string().optional()}),ih=i.object({transactionType:Ll}),wn=i.object({dapp:i.union([Sr,i.null()]),itemAmount:i.string().optional(),item:Ur,forAmount:i.string(),forAsset:Ur,listingUrl:i.string().optional()}),ch=wn.merge(i.object({transactionType:vl})),uh=wn.merge(i.object({transactionType:Pl})),lh=wn.merge(i.object({transactionType:Rl})),ph=wn.merge(i.object({transactionType:Dl})),dh=wn.merge(i.object({transactionType:Nl})),mh=wn.merge(i.object({transactionType:Bl})),fh=i.object({transactionType:Ul,dapp:i.union([Sr,i.null()]).optional(),token:Ur,value:i.string().optional(),isApproved:i.boolean()}),gh=i.object({transactionType:Ml,dapp:i.union([Sr,i.null()]).optional(),orderId:i.string()}),hh=i.object({transactionType:Ol,collection:Xg,dapp:i.union([Sr,i.null()]).optional(),isApproved:i.boolean()}),yh=i.object({transactionType:Ql,dapp:i.union([Sr,i.null()]).optional(),balanceChanges:i.array(di).nonempty(),explorerUrl:i.string().optional()}),wh=i.enum(["success","failed"]),Sh=i.object({networkFee:i.string().optional(),networkFeePayer:i.string().optional(),status:wh,errorMessage:i.union([i.string(),i.null()]),blockNumber:i.string(),chainId:pt,transactionId:i.string()}),mi=i.object({timestamp:i.number(),owner:Dr,id:Dr,interactionData:i.union([Jg,eh,th,rh,oh,nh,sh,ah,ch,uh,lh,ph,dh,mh,ih,fh,gh,hh,yh]),chainMeta:Sh}),ft=s(e=>e.split("/")[1]?.split(":").slice(1).join(":"),"extractAddressfromBri");u();l();u();l();var bh=1e-5,Th="0,0.[00000]",bk="0,0.[00]a",Tk=1e6,Ah=s((e,t=Th)=>{let r=new _(e);if(r.abs().isGreaterThan(0)&&r.abs().isLessThan(bh))return`< ${r.isLessThan(0)?"-":""}${bh}`;let o=(0,ag.default)(r.toNumber());return t===Th&&r.isGreaterThanOrEqualTo(Tk)?o.format(bk):o.format(t)},"formatTokenAmount");var Ct=s((e,t)=>{let r=new _(e).div(Cf(t)).toNumber();return Ah(r)},"amountToFormattedAmount");u();l();var Io=s(e=>{switch(e){case"SemiFungible":case"NonFungible":return!0;default:return!1}},"isCollectibleTokenType"),ql=s((e,t)=>{let r=ft(e.to),o=ft(e.from),n=t.some(c=>c.address.toLowerCase()===r.toLowerCase()),a=t.some(c=>c.address.toLowerCase()===o.toLowerCase());return n&&!a},"isReceiveTransaction");u();l();var zl=D(L());u();l();var xh=s(({interactionData:e,isError:t,selectedAccountAddresses:r,getKnownAddressLabel:o,start:n,networkID:a})=>{let p=e.balanceChanges[0],{token:{symbol:m,displayName:d,tokenType:f,decimals:h},amount:w}=p,y=ql(p,r),S=Io(f),b=Ak({isCollectible:S,sign:y?"+":"-",amount:w,decimals:h,tokenSymbol:m,tokenType:f,isError:t});if(y){let C=ft(p.from),I=Xu(C,void 0,o(C,a));return{topLeft:{text:`${v.t("transactionsReceived")} ${S?d||v.t("richTransactionDetailUnknownNFT"):""}`},topRight:{text:`${b}`,color:"spotPositive"},bottomLeft:{text:v.t("transactionsFromParagraphInterpolated",{from:I,defaultValue:`From ${I}`})},start:n}}let A=ft(p.to),E=Xu(A,void 0,o(A,a));return{topLeft:{text:t?v.t("transactionsSendFailed"):`${v.t("transactionsSent")} ${S?d||v.t("richTransactionDetailUnknownNFT"):""}`},topRight:{text:`${b}`,color:"textBase"},bottomLeft:{text:v.t("transactionsToParagraphInterpolated",{to:E,defaultValue:`To ${E}`})},start:n}},"tokenSendLabel");function Ak({isCollectible:e,sign:t,amount:r,decimals:o,tokenSymbol:n,tokenType:a,isError:c}){return c||o===void 0||a==="NonFungible"?"":e?`${t}${Ct(r,o)}`:`${t}${Ct(r,o)}${n?` ${Tr(n,6)}`:""}`}s(Ak,"getValueDisplay");var xk=["So11111111111111111111111111111111111111112","501"],Ek=s((e,t,r,o,n)=>{let{interactionData:a,chainMeta:c}=e,{transactionType:p}=a,m=c.status==="failed",d=c.chainId,f=x.getTokenSymbol(d),h=x.getTokenDecimals(d),w=t("historyUnknownDappName"),y=zl.default.createElement(r,{activityItem:e,size:"small",isDetailViewOrSvg:!1});switch(p){case"TOKEN_SEND":return xh({interactionData:a,isError:m,selectedAccountAddresses:n,getKnownAddressLabel:o,start:y,networkID:d});case"TOKEN_BURN":{let{amount:S,token:T}=a,b="";return T.displayName?S==="1"?b=T.displayName:b=`${T.displayName} (${S})`:b=t("richTransactionDetailUnknownNFT"),{topLeft:{text:m?`${t("transactionsFailedBurn")}`:`${t("transactionsBurned")}`},bottomLeft:{text:b},start:y}}case"TOKEN_UNWRAP":{let{amount:S,token:T}=a;return{topLeft:{text:m?`${t("transactionsUnwrappedFailed")}`:`${t("transactionsUnwrapped")}`},topRight:{text:m?"":`${Ct(S,T.decimals??0)} ${T.symbol}`,color:"textBase"},start:y}}case"TOKEN_SWAP":{let{receiveAmount:S,receiveToken:T,sendAmount:b,sendToken:A,dapp:E}=a,C=E?E.displayName:t("historyUnknownDappName"),I=Es(ft(A.id)||""),N=Es(ft(T.id)||""),Q="";!m&&T.decimals!==void 0&&(Q=`+${Ct(S,T.decimals)} ${Tr(T.symbol||N,6)}`);let R="";return!m&&A.decimals!==void 0&&(R=`-${Ct(b,A.decimals)} ${Tr(A.symbol||I,6)}`),{topLeft:{text:t(m?"transactionsFailedSwap":"transactionsSwapped")},topRight:{text:Q,color:"spotPositive"},bottomLeft:{text:C},bottomRight:{text:R,color:"textBase"},start:y}}case"BRIDGE_INIT":{let S=a.dapp?a.dapp.displayName:w,b=a.balanceChanges[0],{token:{symbol:A,decimals:E},amount:C}=b,I=A?` ${Tr(A,6)}`:"";if(!m&&E!==void 0){let N=`-${Ct(C,E)}${I}`;return{topLeft:{text:m?t("transactionBridgeInitiatedFailed"):`${t("transactionBridgeInitiated")}`},bottomLeft:{text:S},topRight:{text:`${N}`,color:"textBase"},start:y}}return{topLeft:{text:m?t("transactionBridgeInitiatedFailed"):`${t("transactionBridgeInitiated")}`},bottomLeft:{text:S},start:y}}case"WITHDRAW_STAKE":{let{amount:S,stakeAccount:T}=a,b=ft(T),A=x.getTokenSymbol(d);return{topLeft:{text:t(m?"transactionsWithdrawStakeFailed":"transactionsWithdrawStake")},topRight:{text:m?"":`${Ct(S,h)} ${Tr(A,6)}`,color:"textBase"},bottomLeft:{text:nn(b,4)},start:y}}case"DEACTIVATE_STAKE":{let{stakeAccount:S}=a,T=ft(S);return{topLeft:{text:t(m?"transactionsDeactivateStakeFailed":"transactionsDeactivateStake")},bottomLeft:{text:nn(T,4)},start:y}}case"STAKE":{let{amount:S,stakeAccount:T,validatorName:b}=a,A=ft(T);return{topLeft:{text:t(m?"transactionsStakedFailed":"transactionsStaked")},topRight:{text:m?"":`${Ct(S,h)} ${Tr(f,6)}`,color:"textBase"},bottomLeft:{text:b||nn(A,4)},start:y}}case"COLLECTIBLE_LIST":{let{dapp:S,item:T}=a,b=S?S.displayName:t("historyUnknownDappName"),A=T.displayName||t("richTransactionDetailUnknownNFT");return{topLeft:{text:m?t("transactionsListedFailed"):t("transactionsListedInterpolated",{name:A})},bottomLeft:{text:b},start:y}}case"COLLECTIBLE_BUY_ITEM":{let{dapp:S,itemAmount:T,item:b,forAsset:A,forAmount:E}=a,C=S?S.displayName:t("historyUnknownDappName"),I=Eh(E,A.decimals,Tr(A.symbol||"",6)),N=b.symbol||Es(ft(b.id)),Q=T&&b.tokenType==="SemiFungible"?`+${T} ${N}`:`+${N}`;return{topLeft:{text:t(m?"transactionsBuyFailed":"transactionsBoughtCollectible")},topRight:{text:m?"":Q,color:"spotPositive"},bottomRight:{text:m?"":`${I}`,color:"textBase"},bottomLeft:{text:C},start:y}}case"COLLECTIBLE_CANCEL_BID":{let{dapp:S,item:T}=a,b=S?S.displayName:t("historyUnknownDappName"),A=T.displayName||t("richTransactionDetailUnknownNFT");return{topLeft:{text:m?t("transactionsCancelBidOnFailed"):t("transactionsCancelBidOnInterpolated",{name:A})},bottomLeft:{text:b},start:y}}case"COLLECTIBLE_BID_ITEM":{let{dapp:S,item:T}=a,b=S?S.displayName:t("historyUnknownDappName"),A=T.displayName||t("richTransactionDetailUnknownNFT");return{topLeft:{text:m?t("transactionsBidFailed"):t("transactionsBidOnInterpolated",{name:A})},bottomLeft:{text:b},start:y}}case"COLLECTIBLE_UNLIST":{let{dapp:S,item:T}=a,b=S?S.displayName:t("historyUnknownDappName"),A=T.displayName||t("richTransactionDetailUnknownNFT");return{topLeft:{text:m?t("transactionsUnlistedFailed"):t("transactionsUnlistedInterpolated",{name:A})},bottomLeft:{text:b},start:y}}case"COLLECTIBLE_SELL_ITEM":{let{dapp:S,itemAmount:T,item:b,forAsset:A,forAmount:E}=a,C=S?S.displayName:t("historyUnknownDappName"),I=A.decimals!==void 0?`+${Ct(E,A.decimals)} ${Tr(A.symbol||"",6)}`:t("transactionsUnknownAmount"),N=b.symbol||Es(ft(b.id)),Q=T&&b.tokenType==="SemiFungible"?`-${T} ${N}`:`-${N}`;return{topLeft:{text:t(m?"transactionsSoldFailed":"transactionsSoldCollectible")},topRight:{text:m?"":`${I}`,color:"spotPositive"},bottomRight:{text:m?"":Q,color:"textBase"},bottomLeft:{text:C},start:y}}case"CANCEL_TX":return{topLeft:{text:t(m?"transactionCancelledFailed":"transactionCancelled")},start:y};case"TOKEN_APPROVAL":{let{dapp:S,token:T,isApproved:b}=a,A=Io(T.tokenType)?T.displayName:T.symbol,E;return m?b?Io(T.tokenType)?E=t("transactionApproveTokenFailed",{tokenSymbol:A}):E=t("transactionApprovalFailed"):Io(T.tokenType)?E=t("transactionRevokeApproveTokenFailed",{tokenSymbol:A}):E=t("transactionRevokeFailed"):b?E=t("transactionApproveToken",{tokenSymbol:A}):E=t("transactionRevokeApproveToken",{tokenSymbol:A}),{topLeft:{text:E},bottomLeft:{text:S?S.displayName:w,color:"textIncidental"},start:y}}case"COLLECTION_APPROVAL":{let{collection:S,isApproved:T,dapp:b}=a,A=S.displayName,E;return m?T?E=t("transactionApproveTokenFailed",{tokenSymbol:A}):E=t("transactionRevokeApproveTokenFailed",{tokenSymbol:A}):T?E=t("transactionApproveToken",{tokenSymbol:A}):E=t("transactionRevokeApproveToken",{tokenSymbol:A}),{topLeft:{text:E},bottomLeft:{text:b?b.displayName:w,color:"textIncidental"},start:y}}case"CANCEL_ORDER":{let{dapp:S}=a;return{topLeft:{text:t(m?"transactionCancelOrderFailed":"transactionCancelOrder")},bottomLeft:{text:S?.displayName||t("historyUnknownDappName"),color:"textIncidental"},start:y}}case"UNCLASSIFIED_APP_INTERACTION":{let{dapp:S}=a,T=S?S.displayName:w;return{topLeft:{text:t(m?"transactionsFailedAppInteraction":"transactionsAppInteraction")},bottomLeft:{text:T},start:y}}}},"createActivityRowLabels"),kk=s((e,t)=>{let{display:r,type:o}=e,{topLeft:n,topRight:a,bottomLeft:c,bottomRight:p}=r.summary,m=zl.default.createElement(t,{logoUri:r.summary.logoUri,pendingTransactionType:o,size:"small"});return{topLeft:n,topRight:a,bottomLeft:c,bottomRight:p,start:m}},"createPendingTransactionRowLabels"),Gl=s((e,t,r)=>{let o=(e??[]).map(Nf);if(t){let n=o.find(a=>a.chainId===t)?.address;if(n){let a={chainId:t,address:n};r&&(a.filters=[{type:"token",value:r}]),o=[a]}}return o},"getAccountsWithFilter"),Kl=s(e=>{if(!e)return;let t=X(e);if(t.resourceType!==ee.nativeToken)return e.type===oe.SPL?e.data.splTokenAccountPubkey:t.address},"getTokenActivityFilterId"),Ck=s((e,t)=>{let r=ft(e.id);return xk.includes(r)&&(e.tokenType="Native"),e.tokenType==="Native"?{chainId:t,slip44:x.getSlip44(t),resourceType:ee.nativeToken}:{chainId:t,address:r,resourceType:ee.address}},"getFungibleCaip19FromToken"),Eh=s((e,t,r)=>{if(!e||!t)return v.t("transactionsUnknownAmount");let o=Ee(e,t),n=o.abs(),a=o.isZero()?"":o.isPositive()?"-":"+",c=ar(n);return`${a}${c} ${r}`},"formatPaidAmount");u();l();var vs=D(L());var _k=i.object({orderIds:i.array(i.object({bytesValue:i.string(),bytesArrayValue:i.string(),stringValue:i.string()}))}),Ik=s(async(e,t)=>{if(t==="LI.FI")return{label:v.t("transactionBridgeStatusLink",{dappName:"LI.FI"}),value:`https://explorer.li.fi/tx/${e}`};if(t==="deBridge")try{let r=await K.get(`https://stats-api.dln.trade/api/Transaction/${e}/orderIds`),o=_k.safeParse(r.data);if(!o.success){P.captureError(new Error("Failed to parse deBridge response"),M.History);return}let n=o.data.orderIds[0]?.stringValue;if(!n){P.captureError(new Error("No orderId found in deBridge response"),M.History);return}return{label:v.t("transactionBridgeStatusLink",{dappName:"DeBridge"}),value:`https://app.debridge.finance/order?orderId=${n}`}}catch(r){P.captureError(new Error(`Could not fetch bridge explorer url: ${r}`),M.History);return}},"getBridgeExplorerUrl"),Fk=s((e,t)=>{let[r,o]=(0,vs.useState)(),[n,a]=(0,vs.useState)(!1);return(0,vs.useEffect)(()=>{e&&t&&s(async()=>{a(!0);try{let p=await Ik(e,t);o(p)}finally{a(!1)}},"fetchBridgeUrl")()},[e,t]),{bridgeUrl:r,isLoading:n}},"useBridgeExplorerUrl");u();l();u();l();u();l();var _t={showTimeToMineRowInPendingTransactionDetail:!1,showFeeRowInPendingTransactionDetail:!0};var kh={..._t};u();l();var Ch={..._t};u();l();var _h={showTimeToMineRowInPendingTransactionDetail:!1,showFeeRowInPendingTransactionDetail:!1};u();l();var Ih={..._t,showTimeToMineRowInPendingTransactionDetail:!0};u();l();var Fh={..._t};u();l();var vh={..._t};u();l();var Ph={..._t};u();l();var Rh={..._t};u();l();var Dh={showTimeToMineRowInPendingTransactionDetail:!1,showFeeRowInPendingTransactionDetail:!1};u();l();var Nh={showTimeToMineRowInPendingTransactionDetail:!1,showFeeRowInPendingTransactionDetail:!1};var vk=new Jo({[ne.Solana]:Dh,[ne.Ethereum]:Ih,[ne.Polygon]:Rh,[ne.Monad]:Ph,[ne.Base]:Ch,[ne.Arbitrum]:kh,[ne.Bitcoin]:_h,[ne.Sui]:Nh,[ne.Hypercore]:Fh,[ne.Hyperevm]:vh}),Bh=Xo(vk);u();l();u();l();u();l();u();l();var Uh=D(L(),1);var Lh=new WeakMap;function Mh(e,t){let r=tg(t),o=Pk(r);for(let[n,a]of e)(!o.has(n)||t?.dangerouslyForceHydrate)&&(o.add(n),r.set(n,a))}s(Mh,"useHydrateAtoms");var Pk=s(e=>{let t=Lh.get(e);return t||(t=new WeakSet,Lh.set(e,t)),t},"getHydratedSet");var Vh=D(L());u();l();var Gh=D(L());u();l();var Rk=10,Dk="/history/v2",Ps=class extends Error{static{s(this,"ActivityItemsFetchCacheBustError")}message="406: Cache bust!"},fi=class extends Error{static{s(this,"ActivityItemsFetchResponseMalformed")}message="Server response malformed."},Vl=class extends Error{static{s(this,"ActivityItemsFetchServerError")}},jl=class extends Error{static{s(this,"ActivityItemsFetchClientError")}},Oh=i.object({next:i.union([i.null(),i.string()]),results:i.array(mi)}),Qh=s(async e=>{let t=await K.api().retry(3,2e3).post(`${Dk}`,e);if(t.status===406)throw new Ps;if(t.status>=400&&t.status<500)throw new jl(`FetchActivityItem: Status code: ${t.status}`);if(t.status>=500)throw new Vl(`FetchActivityItem: Status code: ${t.status}`);return t.data},"_fetch"),qh=s(e=>!Array.isArray(e.results)||typeof e.next!="string"&&e.next!==null,"isResponseMalformed"),Hl=s(async e=>{let t=await Qh(e);if(qh(t))throw new fi;for(;t.results?.length<Rk&&t.next;){if(qh(t))throw new fi;let r=await Qh({next:t.next,isSpam:e.isSpam});t.next=r.next,t.results=[...t.results,...r.results]}try{return Oh.parse(t)}catch(r){let o=r,n=[],a=o.issues;for(let m=0;m<a.length;++m){let d=a[m].path;if(d[0]!=="results")throw P.captureError(o,M.History),o;let f=d[1];if(typeof f!="number")throw P.captureError(o,M.History),o;n.push(f)}n.sort(function(m,d){return d-m});let c=n.map(m=>t.results[m]).map(m=>m.interactionData?.transactionType||""),p=[];for(let m=0;m<n.length;++m){let d=n[m],f=t.results[d],h={timestamp:f?.timestamp,owner:f?.owner,id:f?.id,chainMeta:f?.chainMeta,interactionData:{transactionType:"UNCLASSIFIED_APP_INTERACTION",balanceChanges:[]}};try{mi.parse(h),t.results[d]=h,p.push(d)}catch{}}for(let m=0;m<n.length;++m){let d=n[m];p.indexOf(d)===-1&&t.results.splice(d,1)}n.length&&console.error(`Removed history items, ${c.join(",")}`);try{return Oh.parse(t)}catch(m){let d=m;throw P.captureError(d,M.History),d}}},"fetchActivityItems");var Nk=3e5,Rs="fetch-infinite-activity-items",Kh=s(({accounts:e,isSpam:t})=>[Rs,e,t],"infiniteActivityItemsQueryKey"),Bk=s((e,t)=>{e.removeQueries({queryKey:t})},"bustCache"),$l=s(({accounts:e,isSpam:t})=>{let r=ze();(0,Gh.useEffect)(()=>()=>{r.cancelQueries({queryKey:[Rs],exact:!1})},[r]);let o=Kh({accounts:e,isSpam:t});return Wm({queryKey:o,queryFn:s(async({pageParam:c})=>{try{let p;c&&c!==""?p=await Hl({next:c,isSpam:t}):p=await Hl({accounts:e||[],isSpam:t});let m=p.results.map(d=>(d.interactionData.transactionType==="TOKEN_SEND"&&d.interactionData.balanceChanges.sort(Lk(e)),d));return{...p,results:m}}catch(p){throw p instanceof Ps&&Bk(r,o),P.captureError(p,M.History),p}},"queryFn"),getNextPageParam:s(c=>c?.next,"getNextPageParam"),staleTime:Nk,retry:!1,enabled:!!e?.length&&e.every(c=>!x.isLocalNetworkID(c.chainId)),initialPageParam:""})},"useFetchInfiniteActivityItems");function Lk(e){return(t,r)=>{let o=zh(t,e),n=zh(r,e);return o?-1:n?1:0}}s(Lk,"balanceChangeSort");function zh(e,t){let r=e.to.split("/address:")[1],o=e.from.split("/address:")[1];return t.some(n=>n.address.toLowerCase()===r.toLowerCase()||n.address.toLowerCase()===o.toLowerCase())}s(zh,"findRelevantTransfers");var Uk=s(({fungible:e,isSpam:t=!1})=>{let{data:r=Jm,status:o}=sf(),n=r.isDeveloperMode,a=Kl(e),{data:c}=mf({address:e?.data.walletAddress,networkID:e?.data.chain.id}),p=(0,Vh.useMemo)(()=>Gl(c?[c]:[],e?.data.chain.id,a),[c,e?.data.chain.id,a]),m=$l({accounts:p,isSpam:t}),d=m.isPending||o==="pending";return{activityItemsData:m,isLoadingHistory:d,isDeveloperMode:n}},"useFungibleActivityByFungible");u();l();var jh=s(e=>e.replace(/^(^[\w-_]*:\/\/)?(?:www\.)?/i,"").split("/")[0],"removeWebPrefixes");u();l();u();l();var ir="Auto";var Pe={buyFungible:void 0,buyUsdValue:void 0,sellFungible:void 0,sellUsdValue:void 0,sellAmount:"",uiSellAmountCryptoInput:"",amountType:"sell",quoteResponse:void 0,selectedProviderIndex:0,selectedBaseProvider:ir,gasEstimation:{isFetching:!1,estimate:void 0,estimateWithBuffer:void 0},hasNoRoutes:!1,isFetchingQuote:!1,error:null,searchQuery:"",numSearchResults:0,primaryCurrency:"crypto",uiSellAmountLocalFiatInput:"",uiBuyAmountCryptoInput:"",uiBuyAmountLocalFiatInput:"",canInputFiatSellAmount:!1,swapFilter:void 0},V=We(e=>({...Pe,resetQuote:s(()=>e({quoteResponse:Pe.quoteResponse,isFetchingQuote:Pe.isFetchingQuote,hasNoRoutes:Pe.hasNoRoutes,selectedProviderIndex:Pe.selectedProviderIndex,error:Pe.error,uiSellAmountLocalFiatInput:Pe.uiSellAmountLocalFiatInput,selectedBaseProvider:Pe.selectedBaseProvider}),"resetQuote"),resetSwapper:s(()=>e({quoteResponse:Pe.quoteResponse,gasEstimation:Pe.gasEstimation,error:Pe.error,sellAmount:"",uiSellAmountCryptoInput:"",uiBuyAmountCryptoInput:Pe.uiBuyAmountCryptoInput,swapFilter:Pe.swapFilter,selectedBaseProvider:Pe.selectedBaseProvider,selectedProviderIndex:Pe.selectedProviderIndex}),"resetSwapper"),setBuyFungible:s(t=>e({buyFungible:t}),"setBuyFungible"),setBuyUsdValue:s(t=>e({buyUsdValue:t}),"setBuyUsdValue"),setHasNoRoutes:s(t=>e({hasNoRoutes:t}),"setHasNoRoutes"),setIsFetchingQuote:s(t=>e({isFetchingQuote:t}),"setIsFetchingQuote"),setQuoteResponse:s(t=>e({quoteResponse:t,hasNoRoutes:!1}),"setQuoteResponse"),setSelectedProviderIndex:s(t=>e({selectedProviderIndex:t}),"setSelectedProviderIndex"),setSelectedBaseProvider:s(t=>e({selectedBaseProvider:t}),"setSelectedBaseProvider"),setGasEstimation:s(({estimate:t,estimateWithBuffer:r,isFetching:o})=>e(n=>({gasEstimation:{...n.gasEstimation,...t!==void 0&&{estimate:t},...r!==void 0&&{estimateWithBuffer:r},...o!==void 0&&{isFetching:o}}})),"setGasEstimation"),setSellAmount:s(t=>e({sellAmount:t}),"setSellAmount"),setAmountType:s(t=>e({amountType:t}),"setAmountType"),setSellUsdValue:s(t=>e({sellUsdValue:t}),"setSellUsdValue"),setSellFungible:s(t=>e({sellFungible:t}),"setSellFungible"),setUiSellAmountCryptoInput:s(t=>e({uiSellAmountCryptoInput:t}),"setUiSellAmountCryptoInput"),setError:s(t=>e({error:t}),"setError"),setSearchQuery:s(t=>e({searchQuery:t}),"setSearchQuery"),setNumSearchResults:s(t=>e({numSearchResults:t}),"setNumSearchResults"),setPrimaryCurrency:s(t=>e({primaryCurrency:t}),"setPrimaryCurrency"),setUiSellAmountLocalFiatInput:s(t=>e({uiSellAmountLocalFiatInput:t}),"setUiSellAmountLocalFiatInput"),setUiBuyAmountCryptoInput:s(t=>e({uiBuyAmountCryptoInput:t}),"setUiBuyAmountCryptoInput"),setUiBuyAmountLocalFiatInput:s(t=>e({uiBuyAmountLocalFiatInput:t}),"setUiBuyAmountLocalFiatInput"),setCanInputFiatSellAmount:s(t=>e({canInputFiatSellAmount:t}),"setCanInputFiatSellAmount"),setSwapFilter:s(t=>e({swapFilter:t}),"setSwapFilter"),switchTokensForSell:s(()=>{e(t=>{let r=t.sellFungible??t.buyFungible,o=t.buyFungible??t.sellFungible,n=t.uiBuyAmountCryptoInput,a=t.uiBuyAmountLocalFiatInput;return{sellFungible:o,buyFungible:r,uiSellAmountCryptoInput:n,uiSellAmountLocalFiatInput:a,uiBuyAmountCryptoInput:Pe.uiBuyAmountCryptoInput,uiBuyAmountLocalFiatInput:Pe.uiBuyAmountLocalFiatInput,sellAmount:n,swapFilter:void 0,selectedBaseProvider:t.selectedBaseProvider}})},"switchTokensForSell"),switchTokensForBuy:s(()=>{e(t=>{let r=t.sellFungible??t.buyFungible,o=t.buyFungible??t.sellFungible,n=t.uiSellAmountCryptoInput,a=t.uiSellAmountLocalFiatInput;return{sellFungible:o,buyFungible:r,uiSellAmountCryptoInput:Pe.uiSellAmountCryptoInput,uiSellAmountLocalFiatInput:Pe.uiSellAmountLocalFiatInput,uiBuyAmountCryptoInput:n,uiBuyAmountLocalFiatInput:a,sellAmount:n,swapFilter:void 0,selectedBaseProvider:t.selectedBaseProvider}})},"switchTokensForBuy"),resetUiAmounts:s(()=>e({uiSellAmountCryptoInput:Pe.uiSellAmountCryptoInput,uiSellAmountLocalFiatInput:Pe.uiSellAmountLocalFiatInput,uiBuyAmountCryptoInput:Pe.uiBuyAmountCryptoInput,uiBuyAmountLocalFiatInput:Pe.uiBuyAmountLocalFiatInput,sellAmount:Pe.sellAmount,selectedBaseProvider:Pe.selectedBaseProvider}),"resetUiAmounts"),setPairAndAmount:s(({sell:t,buy:r,swapAmount:o})=>e(n=>{let a="uiSellAmountCryptoInput";return o.perspective==="sell"?n.primaryCurrency==="crypto"?a="uiSellAmountCryptoInput":a="uiSellAmountLocalFiatInput":n.primaryCurrency==="crypto"?a="uiBuyAmountCryptoInput":a="uiBuyAmountLocalFiatInput",{...n,sellFungible:t,buyFungible:r,[a]:o.amount,sellAmount:o.amount}}),"setPairAndAmount")}));u();l();var gi=i.object({name:i.string(),message:i.string()}),Yh=i.object({chainId:pt,name:i.string(),symbol:i.string(),decimals:i.number(),logoURI:i.optional(i.string()),includesBridge:i.optional(i.boolean())}),Mk=Yh.extend({address:i.string(),resourceType:i.literal(ee.address)}),Ok=Yh.extend({slip44:i.string(),resourceType:i.literal(ee.nativeToken)}),N2=i.union([Mk,Ok]),Xh=i.object({id:i.string(),name:i.string(),logoUri:i.string()}),Qk=i.union([i.enum(["network","phantom","gasless","ata","gasless_network","tips","priority_fee"]),i.string()]),qk=i.object({name:i.string(),percentage:i.number(),amount:i.number(),type:Qk}),zk=i.object({name:i.string(),proportion:i.string()}),Jh=i.object({sellAmount:i.string(),buyAmount:i.string(),rfqProps:i.optional(i.object({expireAt:i.number(),quoteId:i.string()})),analyticsContext:i.optional(i.string())}),hi=Jh.extend({priceImpact:i.number(),sources:i.array(zk),fees:i.array(qk),slippageTolerance:i.optional(i.number()),baseProvider:Xh}),Gk=i.object({success:i.boolean(),error:i.string().optional(),data:i.object({ataFeeUSD:i.number().optional(),networkFeeUSD:i.number().optional(),totalAmountUSD:i.number().optional()}).optional()}),Kk=i.enum(["sync","async"]),yi=hi.extend({transactionData:i.array(i.string()),gaslessSignature:i.optional(i.string()),gaslessSwapFeeResult:i.optional(Gk),executionMode:i.optional(Kk)}),Vk=yi,B2=hi.extend({transactionData:i.array(i.string())}),Wl=hi.extend({allowanceTarget:i.string(),exchangeAddress:i.string(),gas:i.number(),value:i.string(),transactionData:i.string()}),Zl=hi.extend({transactionData:i.array(i.string())}),Hh=i.object({name:i.string(),amount:i.string(),token:Ot,percentage:i.string(),included:i.boolean(),amountUSD:i.optional(i.string())}),jk=i.object({name:i.string(),key:i.string(),logoURI:i.string()}),ey=i.object({name:i.string(),symbol:i.string()}),Hk=i.object({transactionData:i.string(),buyToken:Ot,sellToken:Ot,nonIncludedNonGasFees:i.string(),feeCosts:i.array(Hh),chainId:pt,tool:jk,value:i.optional(i.string()),allowanceTarget:i.optional(i.string()),approvalMetadata:i.optional(ey),approvalExactAmount:i.optional(i.string()),exchangeAddress:i.optional(i.string()),gasCosts:i.optional(i.array(i.number())),includedFeeCosts:i.optional(i.array(Hh))}),Yl=Jh.extend({baseProvider:Xh,executionDuration:i.number(),tags:i.array(i.string()),steps:i.array(Hk)}),$k=i.union([yi,Wl,Zl,Yl,Vk]),Ds=i.enum(["solana","eip155","sui","xchain"]),wi=i.object({type:Ds,taker:Ot,buyToken:Ot,sellToken:Ot,slippageTolerance:i.number(),simulationTolerance:i.optional(i.number()),gasBuffer:i.optional(i.number()),quotes:i.array($k),tradeFee:i.optional(i.array(i.number())),estimateGasFee:i.optional(i.array(i.number())),includesAllProviders:i.optional(i.boolean())}),Wk=i.enum(["swap-approval","swap","bridge-approval","bridge"]),Zk=i.enum(["swap","bridge"]),Yk=i.enum(["swap","bridge"]),Xk=i.enum(["bridge"]),Si=i.object({sellToken:Ot,buyToken:Ot,approvalMetadata:i.optional(ey)}),Jk=i.object({type:i.literal("solana"),transactions:i.array(i.string()),transactionTypes:i.array(Zk),transactionPairs:i.optional(i.array(Si))});var eC=i.object({type:i.literal("evm"),transactions:i.array(Zo),transactionTypes:i.array(Wk),transactionPairs:i.optional(i.array(Si))}),tC=i.object({type:i.literal("sui"),transactions:i.array(i.string()),transactionTypes:i.array(Yk),transactionPairs:i.optional(i.array(Si))}),rC=i.object({type:i.literal("bitcoin"),transactions:i.array(i.string()),transactionTypes:i.array(Xk),transactionPairs:i.optional(i.array(Si))}),L2=i.union([Jk,eC,tC,rC]),$h;(function(e){e.Pricing="pricing",e.Provider="provider",e.ProviderPressable="providerPressable",e.ExchangeRate="exchangeRate",e.PriceImpact="priceImpact",e.Network="network",e.ExecutionDuration="executionDuration",e.Slippage="slippage",e.SlippagePressable="slippagePressable",e.Fees="fees",e.HighPriceImpact="highPriceImpact",e.HighSlippage="highSlippage",e.TransferFees="transferFees"})($h||($h={}));var oC=i.object({name:i.string(),amount:i.string()}).strict(),nC=i.object({name:i.string(),feeUsd:i.number().nullish(),amount:i.string(),time:i.object({text:i.string(),isFast:i.boolean()}),logoURI:i.string()}),U2=i.union([oC,nC]),Wh;(function(e){e.Buy="buy",e.Sell="sell"})(Wh||(Wh={}));var Zh;(function(e){e.SwapProviders="SwapProviders",e.SwapReview="SwapReview",e.SwapTermsOfService="SwapTermsOfService",e.SwapConfirmation="SwapConfirmation",e.InsufficientBalance="InsufficientBalance"})(Zh||(Zh={}));u();l();function se(e){return Yl.safeParse(e).success}s(se,"isBridgeQuote");var It=s(e=>yi.safeParse(e).success,"isSolanaSwapQuote"),ty=s(e=>It(e),"isCashSwapQuote");function cr(e){return Wl.safeParse(e).success}s(cr,"isEvmSwapQuote");function Mr(e){return Zl.safeParse(e).success}s(Mr,"isSuiSwapQuote");function ry(e){return e?"gaslessSignature"in e:!1}s(ry,"isGaslessSwapQuote");function Ar(e){return It(e)||cr(e)||Mr(e)}s(Ar,"isSingleNetworkSwapQuote");u();l();var be;(function(e){e.Idle="idle",e.Started="started",e.Simulating="simulating",e.SimulationRequestErrored="simulationRequestErrored",e.SimulationFailed="simulationFailed",e.SimulationSkipped="simulationSkipped",e.Simulated="simulated",e.SubmittingTransaction="submittingTransaction",e.TransactionSubmissionFailed="transactionSubmissionFailed",e.TransactionSubmitted="transactionSubmitted",e.ConfirmingTransaction="confirmingTransaction",e.TransactionNotConfirmed="transactionNotConfirmed",e.TransactionConfirmed="transactionConfirmed"})(be||(be={}));u();l();var j;(function(e){e.ExecuteSwapStarted="executeSwapStarted",e.SimulationRequestStarted="simulationRequestStarted",e.SimulationPassed="simulationPassed",e.SimulationFailed="simulationFailed",e.SimulationSkipped="simulationSkipped",e.SubmittingTransaction="submittingTransaction",e.TransactionSubmissionFailed="transactionSubmissionFailed",e.TransactionSubmissionStarted="transactionSubmissionStarted",e.TransactionSubmissionSuccess="transactionSubmissionSuccess",e.TransactionConfirmationStarted="transactionConfirmationStarted",e.TransactionConfirmationFailed="transactionConfirmationFailed",e.TransactionConfirmed="transactionConfirmed"})(j||(j={}));u();l();function bt(e){return e.type==="pair"||e.type==="changingToken"||e.type==="refreshing"}s(bt,"hasPair");u();l();var Dt=D(L());u();l();u();l();u();l();u();l();var oo="cash-account",sC="grouped-balances",Ns=[oo,sC],Xl=[oo,"cash-activity"],no={account:s((e,t)=>[oo,"account",{userId:e,isCashEnabled:t}],"account"),balance:s((e,t)=>[oo,"balance",{userId:e,isCashEnabled:t}],"balance"),cashKMSAccount:s(e=>[oo,"kms-account",{user:e}],"cashKMSAccount"),bankDetails:s(e=>[oo,"bankDetails",{user:e}],"bankDetails"),enrollment:s(e=>[oo,"enrollment",{userId:e}],"enrollment"),groupedBalances:s((e,t,r)=>[...Ns,{userID:e,addresses:t,isCashEnabled:r}],"groupedBalances"),lastBroadcastDate:s(()=>[oo,"lastBroadcastDate"],"lastBroadcastDate"),cashActivity:s((e,t)=>[...Xl,{userID:e?.userID,params:t}],"cashActivity")};var bi=s((e,t)=>e.invalidateQueries({queryKey:no.balance(t)}),"invalidateCashBalance"),oy=s(e=>e.invalidateQueries({queryKey:Ns}),"invalidateGroupedBalances"),ny=s(e=>e.invalidateQueries({queryKey:Xl}),"invalidateCashActivity");var sy=s(async(e,t)=>{let r=new Date().toISOString();await t.set("cash-account:lastBroadcastDate",r),e.setQueryData(no.lastBroadcastDate(),r),await e.invalidateQueries({queryKey:no.lastBroadcastDate()})},"invalidateLastBroadcastDate");u();l();u();l();u();l();function ay(e){return e.toLowerCase().replace(/(^|\s|\.)(\w)/g,(t,r,o)=>r+o.toUpperCase())}s(ay,"toTitleCase");u();l();var Jl;(function(e){e.NotEnrolled="not_enrolled",e.Unverified="unverified",e.Verified="verified",e.Suspended="suspended",e.Closed="closed"})(Jl||(Jl={}));var ep;(function(e){e.Crypto="crypto",e.CryptoRecover="crypto_recover",e.Banking="banking",e.Fiat="fiat",e.Cards="cards",e.PaymentLinks="payment_links",e.AccountManagement="account_management"})(ep||(ep={}));var tp;(function(e){e.NotEnrolled="not_enrolled",e.Unverified="unverified",e.Verified="verified"})(tp||(tp={}));var Or;(function(e){e.PhantomUsername="phantom_username",e.Signup="signup",e.Tos="tos",e.Kyc="kyc",e.EmailVerification="email_verification",e.DataSharingConsent="data_sharing_consent",e.L1KycVerification="l1_kyc_verification",e.L2DocumentVerification="l2_document_verification"})(Or||(Or={}));var Ti;(function(e){e.Pending="pending",e.Completed="completed",e.Verified="verified",e.Failed="failed",e.Rejected="rejected",e.NotStarted="not_started",e.Expired="expired",e.NotApplicable="not_applicable"})(Ti||(Ti={}));var iy=i.nativeEnum(Jl),aC=i.nativeEnum(ep),cy=i.nativeEnum(tp),iC=i.nativeEnum(Or),cC=i.nativeEnum(Ti),uC=i.object({type:iC,status:cC.nullish().transform(B),description:i.string().nullish().transform(B),url:i.string().nullish().transform(B),errorMessage:i.string().nullish().transform(B),metadata:i.record(i.string(),i.any()).nullish().transform(B)}),Ai;(function(e){e.NotStarted="not_started",e.Pending="pending",e.Failed="failed",e.Rejected="rejected",e.Verified="verified"})(Ai||(Ai={}));var lC=i.object({kycStartedAt:i.string().nullish().transform(B),idVerificationStatus:i.nativeEnum(Ai).nullish().transform(B),kycVerificationStatus:i.nativeEnum(Ai).nullish().transform(B)}),pC=i.object({consentTimestamp:i.string().nullish().transform(B),consented:i.boolean().nullish().transform(B)}),dC=i.object({authIntentId:i.string().nullish().transform(B)}),mC=i.object({kycMetadata:lC.nullish().transform(B),dataSharing:pC.nullish().transform(B),authIntent:dC.nullish().transform(B)}),fC=i.object({type:i.string(),required:i.boolean(),description:i.string().nullish().transform(B)}),gC=i.object({type:i.nativeEnum(Or),required:i.boolean(),description:i.string(),data:i.object({type:i.union([i.literal(Or.DataSharingConsent),i.literal(Or.L1KycVerification),i.literal(Or.L2DocumentVerification)]).nullish().transform(B),currentStatus:i.nativeEnum(Ti).nullish().transform(B),authIntentId:i.string().nullish().transform(B),consentRequired:i.boolean().nullish().transform(B)}).nullish().transform(B)}),xi;(function(e){e.NotStarted="not_started",e.Pending="pending",e.Failed="failed",e.RegionLocked="region_locked",e.NeedsMoreInfo="needs_more_info",e.Completed="completed",e.CardReady="card_ready"})(xi||(xi={}));var rp=i.object({accountStatus:iy.nullish().transform(B),features:i.array(aC).optional().default([]),availableTransitions:i.array(iy).optional().default([]),canAdvance:i.boolean().optional().default(!1),currentTier:cy.nullish().transform(B),nextTier:cy.nullish().transform(B),nextTierDescription:i.string().nullish().transform(B),nextTierRequirements:i.array(uC).optional().default([]),nextTierRequiredFields:i.record(i.string(),fC).nullish().transform(B),nextSteps:i.array(gC).optional().default([]),verificationState:i.nativeEnum(xi).nullish().transform(B),metadata:mC.nullish().transform(B)});var Ei;(function(e){e.NotSubmitted="not_submitted",e.Accepted="accepted",e.NotAccepted="not_accepted"})(Ei||(Ei={}));var ki;(function(e){e.NotSubmitted="not_submitted",e.Incomplete="incomplete",e.PendingReview="pending",e.Approved="approved",e.Rejected="rejected"})(ki||(ki={}));var Ci;(function(e){e.Crypto="crypto",e.CryptoRecover="crypto_recover",e.Banking="banking",e.Fiat="fiat",e.Cards="cards",e.PaymentLinks="payment_links",e.AccountManagement="account_management"})(Ci||(Ci={}));var hC=s(e=>Object.values(Ci).includes(e),"canUseCashAccountFeature"),Me;(function(e){e.Pending="pending",e.Processing="processing",e.Completed="completed",e.Refunded="refunded",e.Failed="failed",e.Canceled="canceled",e.Unknown="unknown"})(Me||(Me={}));var _i;(function(e){e.Debit="debit",e.Credit="credit"})(_i||(_i={}));var Ii;(function(e){e.Transfer="transfer",e.Swap="swap",e.PerpsFunding="perps_funding",e.Refund="refund",e.KycUpdate="kyc_update",e.AccountUpdate="account_update",e.Microdeposit="microdeposit",e.UserCardLock="user_card_lock",e.UserCardUnlock="user_card_unlock",e.PhantomCardLock="phantom_card_lock",e.PhantomCardUnlock="phantom_card_unlock",e.CardTransaction="card_transaction",e.CardPinUpdated="card_pin_updated",e.Onramp="onramp",e.Delegation="delegation",e.Unknown="unknown"})(Ii||(Ii={}));var Fi=class extends Error{static{s(this,"CashAccountNotFoundError")}constructor(t){super(`Cash account not found for user ${t}. User is not enrolled in cash account.`),this.name="CashAccountNotFoundError"}},vi=class extends Error{static{s(this,"CashAccountValidationError")}zodError;responseData;constructor(t,r){let o=t.issues.map(n=>`${n.path.length>0?n.path.join("."):"root"}: ${n.message}`).join("; ");super(`Cash account validation failed: ${o}`),this.name="CashAccountValidationError",this.zodError=t,this.responseData=r}},Di=i.object({id:i.string(),primaryEmail:i.string().nullish().transform(B),accountStatus:i.string().nullish().transform(B),addressDetails:i.object({address:i.string()}),features:i.array(i.string()).transform(e=>e.filter(hC)),limits:i.object({dailyFiatTransfer:i.string().nullish().transform(B),monthlyFiatTransfer:i.string().nullish().transform(B)}).nullish().transform(B),waitlistDetails:i.object({waitlist:i.boolean(),priorityWaitlist:i.boolean()}).nullish().transform(B),isRegionLocked:i.boolean().nullish().transform(B),linkDetails:i.object({cryptoCustomerId:i.string().nullish().transform(B),authIntentId:i.string().nullish().transform(B),linkEmail:i.string().nullish().transform(B)}).nullish().transform(B)});var kQ=i.object({sourceCurrency:i.string().nullish().transform(B),destinationCurrency:i.string().nullish().transform(B),destinationBlockchain:i.string().nullish().transform(B),destinationAddress:i.string().nullish().transform(B),accountNumber:i.string().nullish().transform(B),routingNumber:i.string().nullish().transform(B),accountType:i.string().nullish().transform(B),bankName:i.string().nullish().transform(B),bankAddress:i.string().nullish().transform(B),bankBeneficiaryName:i.string().transform(ay).nullish().transform(B),bankBeneficiaryAddress:i.string().nullish().transform(B)}),yC=i.object({price:i.number(),priceChange24h:i.number(),lastUpdatedAt:i.string().transform(e=>new Date(e))}),wC=i.object({account:i.string(),quantity:i.number(),quantityString:i.string()}),SC=i.object({address:i.string(),quantity:i.number(),quantityString:i.string(),lastTransferredDate:i.string().nullish().transform(B),subaccounts:i.array(wC).nullish().transform(B)}),bC=i.object({isMutable:i.boolean().nullish().transform(B),creators:i.array(i.string()).nullish().transform(B),tokenProgram:i.string().nullish().transform(B),extensions:i.array(i.any()).nullish().transform(B),compression:i.record(i.any()).nullish().transform(B)}),TC=i.object({caip19:i.string(),name:i.string(),symbol:i.string(),decimals:i.number(),spamStatus:i.string().nullish().default(""),logoUri:i.string().nullish().default(""),totalQuantity:i.number(),totalQuantityString:i.string(),price:yC.nullish().transform(B),queriedWalletBalances:i.array(SC),extraMetadata:bC}),AC=i.object({email:i.string().email(),cashAccountAddress:i.string(),idempotencyKey:i.string()}),xC=i.object({enrollmentDetails:i.object({kycStatus:i.nativeEnum(ki),kycUrl:i.string(),tosStatus:i.nativeEnum(Ei),tosUrl:i.string()})}),Pi;(function(e){e.TRANSFER_TO_BANK="transfer_to_bank",e.TRANSFER_TO_USERNAME="transfer_to_username",e.TRANSFER_TO_WALLET="transfer_to_wallet",e.WITHDRAWAL_TO_WALLET="withdrawal_to_wallet",e.SELL_TOKENS="sell_tokens",e.CARD_BANK_DEPOSIT="card_bank_deposit",e.VIRTUAL_ACCOUNT_DEPOSIT="virtual_account_deposit",e.DELEGATE_WALLET_ACCOUNT="delegate_wallet_account"})(Pi||(Pi={}));var EC=i.object({account:i.string(),quantity:i.number(),quantityString:i.string()}),kC=i.object({address:i.string(),quantity:i.number(),quantityString:i.string(),lastTransferredDate:i.string().nullish().transform(B),subaccounts:i.array(EC).nullish().transform(B)}),CC=i.object({isMutable:i.boolean().nullish().default(null),creators:i.array(i.unknown()).nullish().transform(B),tokenProgram:i.string().nullish().transform(B),extensions:i.array(i.unknown()).nullish().transform(B)}),uy=i.object({caip19:i.string(),name:i.string(),symbol:i.string(),decimals:i.number(),logoUri:i.string(),spamStatus:i.string(),totalQuantity:i.number(),totalQuantityString:i.string(),queriedWalletBalances:i.array(kC),extraMetadata:CC.nullish().transform(B),price:i.object({price:i.number(),priceChange24h:i.number().nullish().transform(B),lastUpdatedAt:i.coerce.date(),marketCap:i.number().nullish().transform(B)}).nullish()}),CQ=i.object({stablecoins:i.array(uy),otherTokens:i.array(uy),totalStablecoinsValueUsd:i.string().nullish().transform(B),totalOtherTokensValueUsd:i.string().nullish().transform(B)}),Ri;(function(e){e.UNVERIFIED="unverified",e.VERIFIED="verified"})(Ri||(Ri={}));var op;(function(e){e.AlreadyExists="already_exists",e.InProgress="in_progress",e.Pending="pending",e.Completed="completed"})(op||(op={}));var _C=i.object({targetState:i.nativeEnum(Ri),data:i.object({email:i.string().email().optional(),cashAccountAddress:i.string().optional()}),idempotencyKey:i.string().optional()}),IC=rp.extend({account:Di}),FC=i.object({requirementType:i.nativeEnum(Or),evidence:i.object({authIntentId:i.string(),providerCustomerId:i.string(),dataSharing:i.object({consented:i.boolean()})})}),vC=rp.extend({account:Di}),Qr;(function(e){e.BankAccountId="bank_account_id",e.Bank="bank",e.Crypto="crypto",e.PhantomUsername="phantom_username",e.Merchant="merchant"})(Qr||(Qr={}));var PC=i.nativeEnum(Qr),RC=i.object({type:i.literal("fiat"),currency:i.string(),value:i.string()}),DC=i.object({type:i.literal("token"),token:i.string(),symbol:i.string(),value:i.string(),decimals:i.number()}),dy=i.discriminatedUnion("type",[RC,DC]),ly;(function(e){e.Fiat="fiat",e.Token="token"})(ly||(ly={}));var NC=i.record(i.string(),dy),my=i.object({accountHolderName:i.string().nullish().transform(B),accountNumber:i.string().nullish().transform(B),accountType:i.string().nullish().transform(B),bankName:i.string().nullish().transform(B),nickname:i.string().nullish().transform(B)}),Bs=i.object({type:PC,currency:i.string(),name:i.string().nullish().transform(B),phantomUsername:i.string().nullish().transform(B)}),BC=Bs.extend({type:i.literal(Qr.BankAccountId),bankDetails:my.nullish().transform(B)}),LC=Bs.extend({type:i.literal(Qr.Bank),bankDetails:my.nullish().transform(B)}),UC=Bs.extend({type:i.literal(Qr.Crypto),address:i.string().nullish().transform(B),phantomUsername:i.string().nullish().transform(B)}),MC=i.object({merchantName:i.string().nullish().transform(B),merchantCategoryCode:i.string().nullish().transform(B)}),OC=i.object({name:i.string().nullish().transform(B),categoryPrimary:i.string().nullish().transform(B),categoryDetailed:i.string().nullish().transform(B),icon:i.string().nullish().transform(B),website:i.string().nullish().transform(B),location:i.any().nullish().transform(B)}),QC=Bs.extend({type:i.literal(Qr.Merchant),merchantDetails:MC.nullish().transform(B),enrichedMerchantDetails:OC.nullish().transform(B),category:i.string().nullish().transform(B),icon:i.string().nullish().transform(B),website:i.string().nullish().transform(B)}),np;(function(e){e.Following="following"})(np||(np={}));var qC=Bs.extend({type:i.literal(Qr.PhantomUsername),phantomUsername:i.string().nullish().transform(B),icon:i.string().nullish().transform(B),relationship:i.nativeEnum(np).nullish().transform(B)}),zC=i.union([BC,LC,UC,qC,QC]),py=i.object({amount:i.string(),decimals:i.number(),logoUri:i.string().nullish().transform(B),mint:i.string(),name:i.string().nullish().transform(B),owner:i.string(),symbol:i.string().nullish().transform(B)}),Fo;(function(e){e.CashOut="cash_out",e.Swap="swap"})(Fo||(Fo={}));var GC=i.object({input:py,output:py,quoteId:i.string().nullish().transform(B),quoteSource:i.string().nullish().transform(B),type:i.nativeEnum(Fo).nullish().transform(B)}),_Q=i.object({type:i.nativeEnum(Ii),id:i.string(),state:i.nativeEnum(Me),occurredAt:i.string(),counterparty:zC,direction:i.nativeEnum(_i),amount:dy,feeBreakdown:NC.nullish().default(null),metadata:i.object({swapInfo:GC.nullish().default(null),merchant:i.any().nullish().default(null),enrichment:i.object({lastEnrichedAt:i.string().nullish().transform(B),source:i.string().nullish().transform(B)}).nullish().transform(B)}).nullish().default(null),onchainTxId:i.string().nullish().transform(B)});var Ls=s(e=>{let{data:t}=yr(),{userID:r}=t??{},o=Ke("enable-cash"),{canUseCash:n}=ff(),a=o&&n,{data:c}=df(),p=!!c?.username,m=!!(r&&e?.enabled!==!1&&a&&p);return ae({...e,queryKey:no.account(r,a),enabled:m,queryFn:s(async()=>{if(!r)throw new Error("useCashAccount: userID is required");let d=r;try{let f=await K.api().bearer(!0).get(`/cash/v1/users/${d}/cash-account`),h=Di.safeParse(f.data);if(!h.success)throw new vi(h.error,f.data);return h.data}catch(f){switch(f?.response?.status||f?.response?.data?.statusCode){case 204:case 404:case 403:throw new Fi(d);default:break}throw P.captureError(f,M.Cash),f}},"queryFn")})},"useCashAccount");u();l();var KC=D(L());var VC=s((e,t,r)=>{let o=s(c=>{if(c.caip19!==t)return c;let m=new _(c.totalQuantity).plus(r),d=m.isLessThan(0)?new _(0):m;return{...c,totalQuantity:d.toNumber(),totalQuantityString:d.toString(),queriedWalletBalances:c.queriedWalletBalances}},"updateTokenBalance"),n=e.stablecoins.some(c=>c.caip19===t),a=e.otherTokens.some(c=>c.caip19===t);return!n&&!a?e:{...e,stablecoins:n?e.stablecoins.map(o):e.stablecoins,otherTokens:a?e.otherTokens.map(o):e.otherTokens}},"transformGroupedBalances");function sp(e,t,r){e.getQueriesData({queryKey:Ns,exact:!1}).forEach(([n,a])=>{if(a){let c=VC(a,t,r);e.setQueryData(n,c)}})}s(sp,"updateGroupedBalances");u();l();u();l();function ap(e,t,r){if(rn("kill-cash-balance-optimistic-update")||!r)return;let n=no.balance(r,!0);e.setQueryData(n,a=>{if(!a)return a;let p=new _(a.totalQuantity).plus(t);return{...a,totalQuantity:p.toNumber(),totalQuantityString:p.toString()}}),bi(e,r)}s(ap,"updateCashBalance");var jC=z({seconds:3}),ip=s(async({queryClient:e,storage:t,authRepository:r,sellCaip19:o,sellAddress:n,sellAmountBN:a,buyCaip19:c,buyAddress:p,buyAmountBN:m,cashAccountAddress:d})=>{let h=(await r.getUser())?.userID??"";$C({queryClient:e,sellCaip19:o,sellAmountBN:a,sellAddress:n,buyCaip19:c,buyAmountBN:m,buyAddress:p,cashAccountAddress:d,userId:h}),await sy(e,t),await new Promise(w=>setTimeout(w,jC)),await HC(e,h)},"invalidateCashSwap"),HC=s(async(e,t)=>Promise.all([oy(e),bi(e,t),ny(e)]),"invalidateCashSwapQueries"),$C=s(({queryClient:e,sellCaip19:t,sellAmountBN:r,sellAddress:o,buyCaip19:n,buyAmountBN:a,buyAddress:c,cashAccountAddress:p,userId:m})=>{if(!m)return;let d=O(t),f=O(n);p&&o===p?ap(e,r.negated(),m):sp(e,d,r.negated()),p&&c===p?ap(e,a,m):sp(e,f,a),WC({sellCaip19:t,sellAmountBN:r,sellAddress:o,buyCaip19:n,buyAmountBN:a,buyAddress:c,cashAccountAddress:p})},"optimisticUpdate"),WC=s(({sellCaip19:e,sellAmountBN:t,sellAddress:r,buyCaip19:o,buyAmountBN:n,buyAddress:a,cashAccountAddress:c})=>{let p=rn("kill-cash-balance-optimistic-update");r===c?P.addBreadcrumb(M.Cash,`[optimisticUpdate] buying ${n.toString()} ${o} w/ ${t.toString()} cash, isKillSwitchEnabled: ${p}`,Y.Debug):a===c?P.addBreadcrumb(M.Cash,`[optimisticUpdate] buying ${n.toString()} (cash) w/ ${t.toString()} ${e}, isKillSwitchEnabled: ${p}`,Y.Debug,{amount:n.toString()}):P.addBreadcrumb(M.Cash,`[optimisticUpdate] [non-cash] buying ${n.toString()} ${o} w/ ${t.toString()} ${e}`,Y.Debug)},"logOptimisticUpdate");var gy=D(L());u();l();var fy=s(e=>{let t=e?.addressDetails?.address;return t?{[we.Solana.Mainnet]:t}:{}},"createSwapperCashAddresses");var Ni=s(()=>{let{data:e}=Ls();return(0,gy.useMemo)(()=>fy(e),[e])},"useSwapperCashAddresses");u();l();u();l();u();l();var ZC=["SwapperNoQuotes","UnsupportedCountry","UnknownError"],hy=s((e,t,r,o)=>{e instanceof Ve&&ZC.includes(e.code)||(!t||t>=400&&t<500)&&P.addBreadcrumb(r,JSON.stringify(o),Y.Info)},"captureClientError");u();l();var yy=s(async(e,t,r=void 0)=>{if(le(e))return Promise.resolve();let o;try{o=e.data}catch{throw new Ve({key:r})}let n=gi.safeParse(o);throw n.success?(P.addBreadcrumb(t,JSON.stringify(n.data),Y.Info),new Ve({key:n.data.name})):new Ve({key:r})},"handleBadResponse");u();l();var wy=s(e=>{let t=new Ve({key:"SwapperNoQuotes"});if(Ds.safeParse(e?.type).success===!1)throw P.captureError(new Error("Failed to parse a valid quote type."),M.Swapper),new Error("Invalid input");let r=wi.safeParse(e);if(!r.success)throw P.captureError(new Error("Failed to parse a valid swap quotes response."),M.Swapper),t;if(r.data.quotes.length===0)throw t;return r.data},"parseSwapQuotesResponse");var Sy="swap-quotes";async function Bi({sellTokenCaip19:e,buyTokenCaip19:t,taker:r,takerDestination:o,exactOut:n,sellAmount:a,sellAmountUsd:c,slippageTolerance:p,signal:m,enableAutoSlippage:d,priorityFee:f,tipAmount:h,phantomCashAccount:w}){let y;try{xs(r)&&(r.address=r.address.toLowerCase()),o&&xs(o)&&(o.address=o.address.toLowerCase()),xs(t)&&(t.address=t.address.toLowerCase()),xs(e)&&(e.address=e.address.toLowerCase());let S="/swap/v2/quotes",T={sellToken:e,buyToken:t,taker:r,takerDestination:o,exactOut:n,sellAmount:a,sellAmountUsd:c,slippageTolerance:p,autoSlippage:d,priorityFee:f,tipAmount:h,phantomCashAccount:w},b=await K.api().post(S,T,{signal:m});return y=b.status,await yy(b,Sy,"SwapperNoQuotes"),wy(b.data)}catch(S){let T=S instanceof Ve?S:new Ve;throw hy(T,y,Sy,{sellToken:e,buyToken:t,sellAmount:a,sellAmountUsd:c,slippageTolerance:p}),T}}s(Bi,"getSwapQuotes");var Li=class{static{s(this,"WalletSwapApiClient")}getQuotes(t){return Bi({sellTokenCaip19:t.sell,buyTokenCaip19:t.buy,taker:t.taker,takerDestination:t.takerDestination,sellAmount:t.amount,sellAmountUsd:t.amountUsd,slippageTolerance:t.slippageTolerance,signal:t.signal,exactOut:t.exactOutEnabled,priorityFee:t.priorityFee,tipAmount:t.tipAmount,enableAutoSlippage:t.autoSlippageEnabled,phantomCashAccount:t.phantomCashAccount})}};u();l();u();l();var Ui=class{static{s(this,"BridgeTrackingSwapCommand")}inner;bridgeStatusManager;executingQuote;takerAddress;networkId;quote;executionId;constructor(t,r,o){this.inner=t,this.bridgeStatusManager=r,this.executingQuote=o,this.takerAddress=t.takerAddress,this.networkId=t.networkId,this.quote=t.quote,this.executionId=t.executionId}createTransaction(){return this.inner.createTransaction()}swap(t,r,o,n,a){return this.inner.swap(t,r,o,n,a)}async waitForConfirmation(t){await this.bridgeStatusManager.track({executionId:this.executionId,executingQuote:this.executingQuote,transactionHash:t.id}),await this.inner.waitForConfirmation(t)}};u();l();u();l();u();l();var Ft="swapper",tt;(function(e){e.quotes="quotes",e.transactions="transactions",e.slippageTolerance="slippageTolerance",e.priorityFee="priorityFee",e.tipAmount="tipAmount",e.presence="presence",e.lastSubmittedPairs="lastSubmittedPairsV2",e.lastSelectedTokens="lastSelectedTokens",e.slippageSettings="slippageSettings",e.priorityFeeSettings="priorityFeeSettings",e.tipSettings="tipSettings",e.hasViewedAutoSlippageOptIn="hasViewedAutoSlippageOptIn",e.optimisticUpdates="optimisticUpdates",e.autoSlippageMigrationVersion="autoSlippageMigrationVersion"})(tt||(tt={}));var by=[Ft,tt.quotes],ye={quotesScope:s(()=>by,"quotesScope"),quotes:s(({sellTokenCaip19:e,buyTokenCaip19:t,taker:r,amountValue:o,amountType:n,slippageTolerance:a,priorityFee:c,tipAmount:p,takerDestination:m,enableAutoSlippage:d,preferredProvider:f,phantomCashAccount:h})=>[...by,{sellToken:e,buyToken:t,taker:r,takerDestination:m,amountValue:o,amountType:n,slippageTolerance:a,priorityFee:c,tipAmount:p,enableAutoSlippage:d,preferredProvider:f,phantomCashAccount:h}],"quotes"),transactions:s(e=>[Ft,tt.transactions,e],"transactions"),presence:s(e=>[Ft,tt.presence,e],"presence"),slippageTolerance:s(()=>[Ft,tt.slippageTolerance],"slippageTolerance"),priorityFee:s(()=>[Ft,tt.priorityFee],"priorityFee"),tipAmount:s(()=>[Ft,tt.tipAmount],"tipAmount"),lastSubmittedPairs:s(()=>[Ft,tt.lastSubmittedPairs],"lastSubmittedPairs"),lastSelectedTokens:s(()=>[Ft,tt.lastSelectedTokens],"lastSelectedTokens"),slippageSettings:s(()=>[Ft,tt.slippageSettings],"slippageSettings"),priorityFeeSettings:s(()=>[Ft,tt.priorityFeeSettings],"priorityFeeSettings"),tipSettings:s(()=>[Ft,tt.tipSettings],"tipSettings"),hasViewedAutoSlippageOptIn:s(()=>[Ft,tt.hasViewedAutoSlippageOptIn],"hasViewedAutoSlippageOptIn"),optimisticUpdates:s(()=>[Ft,tt.optimisticUpdates],"optimisticUpdates"),autoSlippageMigrationVersion:s(()=>[Ft,tt.autoSlippageMigrationVersion],"autoSlippageMigrationVersion")};u();l();var Mi;(function(e){e[e.Always=1/0]="Always",e[e.Short=z({days:1})]="Short",e[e.Medium=z({days:3})]="Medium",e[e.Long=z({days:7})]="Long"})(Mi||(Mi={}));var Oi;(function(e){e[e.Immediate=0]="Immediate",e[e.Short=z({minutes:1})]="Short",e[e.Medium=z({minutes:2.5})]="Medium",e[e.Long=z({minutes:60})]="Long",e[e.Never=1/0]="Never"})(Oi||(Oi={}));var Sn;(function(e){e[e.Short=z({seconds:20})]="Short",e[e.Medium=z({minutes:2.5})]="Medium",e[e.Long=z({minutes:5})]="Long"})(Sn||(Sn={}));var Ty=s(async({callerAddress:e,contractAddress:t,networkId:r,sellAmount:o,allowanceTarget:n,approvalExactAmount:a,exchangeAddress:c,value:p,transactionData:m,type:d})=>{let f=[],h=[];if(t&&(await Of({callerAddress:e,spender:n,networkId:r,contractAddress:t})).lt(a??o.toString())){let S=await Qf({callerAddress:e,spender:n,networkId:r,contractAddress:t,exactAmount:a});f.push(S),h.push(`${d}-approval`)}let w=Zo.parse({type:Im.eip1559,from:e,data:m,chainId:x.getEVMNetworkIDValue(r),to:c,...p==="0"?{}:{value:`0x${new U(p).toString(16)}`}});return f.push(w),h.push(d),{transactions:f,transactionTypes:h}},"createEVMTransactions"),Us=s(async({networkId:e,callerAddress:t,quote:r})=>{let{sellAmount:o,steps:n}=r,a=[],c=[],p=[];for(let m of n){let{allowanceTarget:d,exchangeAddress:f,value:h,transactionData:w,sellToken:y,buyToken:S,approvalMetadata:T}=m,b=y.resourceType===ee.address?y.address:null,A=x.compareNetworkID(y.chainId,S.chainId)===0?"swap":"bridge";if(!d||!f||!w||!h)throw new Error("Missing bridge step data for EVM bridge quote.");let E=await Ty({callerAddress:t,contractAddress:b,networkId:e,sellAmount:o,allowanceTarget:d,approvalExactAmount:m.approvalExactAmount,exchangeAddress:f,value:h,transactionData:w,type:A});a.push(...E.transactions),c.push(...E.transactionTypes),p.push({sellToken:y,buyToken:S,approvalMetadata:T}),E.transactionTypes.length==2&&E.transactionTypes.find(C=>C.includes("approval"))&&p.push({sellToken:y,buyToken:S,approvalMetadata:T})}return{type:"evm",transactions:a,transactionTypes:c,transactionPairs:p}},"processEVMBridgeQuote"),Ms=s(async({quote:e,connection:t})=>{let r=[],o=[],n=[];for(let a of e.steps){let{transactionData:c,sellToken:p,buyToken:m}=a,d=x.compareNetworkID(p.chainId,m.chainId)===0?"swap":"bridge",f=await Ay(c,t);r.push(tl.serialize(f).transaction),o.push(d),n.push({sellToken:p,buyToken:m})}return{type:"solana",transactions:r,transactionTypes:o,transactionPairs:n}},"processSolanaBridgeQuote"),Os=s(async({networkId:e,callerAddress:t,quote:r,sellFungible:o})=>{let n=o.type===oe.ERC20&&o?.data.tokenAddress?o.data.tokenAddress:null,{allowanceTarget:a,exchangeAddress:c,sellAmount:p,value:m}=r;return{type:"evm",...await Ty({callerAddress:t,contractAddress:n,networkId:e,sellAmount:p,allowanceTarget:a,exchangeAddress:c,value:m,transactionData:r.transactionData,type:"swap"})}},"processEVMSwapQuote"),Qs=s(async({quote:e})=>{let t=[],r=[],o=[];for(let n of e.steps){let{transactionData:a,sellToken:c,buyToken:p}=n,m=x.compareNetworkID(c.chainId,p.chainId)===0?"swap":"bridge";t.push(a),r.push(m),o.push({sellToken:c,buyToken:p})}return{type:"sui",transactions:t,transactionTypes:r,transactionPairs:o}},"processSuiBridgeQuote"),Qi=s(async({quote:e})=>{let t=[],r=[],o=[];for(let n of e.steps){let{transactionData:a,sellToken:c,buyToken:p}=n;t.push(a),r.push("bridge"),o.push({sellToken:c,buyToken:p})}return{type:"bitcoin",transactions:t,transactionTypes:r,transactionPairs:o}},"processBitcoinBridgeQuote"),Ay=s(async(e,t)=>{let r=xt(e,"bs58");return await Df(r,{connection:t,transactionType:an.Swap})},"addPriorityFeeToEncodedTx"),bn=s(async({quote:e,connection:t})=>{let r=e.transactionData.map(c=>Ay(c,t)),n=(await Promise.all(r)).map(c=>tl.serialize(c).transaction);return{type:"solana",transactionTypes:n.map(()=>"swap"),transactions:n}},"processSolanaSwapQuote"),xy=s(async({quote:e,connection:t})=>bn({quote:e,connection:t}),"processCashSwapQuote"),qs=s(async({quote:e})=>({type:"sui",transactionTypes:Array(e.transactionData.length).fill("swap"),transactions:e.transactionData}),"processSuiSwapQuote"),Ey=s(({callerAddress:e,sellFungible:t,quote:r})=>{let{connection:o}=dn(),n=ye.transactions(r);return ae({queryKey:n,enabled:!!r&&!!t,gcTime:0,staleTime:0,refetchInterval:Sn.Short,async queryFn(){try{if(!r)throw new Error("Missing quote");if(!t)throw new Error("Missing sell token");let a=t.data.chain.id;if(Ar(r)){if(x.isEVMNetworkID(a)&&cr(r))return await Os({networkId:a,callerAddress:e,quote:r,sellFungible:t});if(x.isSolanaNetworkID(a)&&It(r))return bn({quote:r,connection:o});if(x.isSuiNetworkID(a)&&Mr(r))return qs({quote:r});throw new Error(`Single network swap quote not supported for network ID ${a}`)}if(se(r)){if(x.isEVMNetworkID(a))return await Us({networkId:a,callerAddress:e,quote:r});if(x.isSolanaNetworkID(a))return await Ms({quote:r,connection:o});if(x.isSuiNetworkID(a))return await Qs({quote:r});throw new Error(`Bridge quote not supported for network ID ${a}`)}throw new Error("Swap quote type not supported")}catch(a){throw a instanceof Error&&P.captureError(a,M.Swapper),a}}})},"useSwapTransactions");u();l();var so=D(Om());u();l();var Fy=D(L());u();l();var ky=D(L());u();l();function Re(e){let t=e.reduce((r,o)=>r.add(o.name),new Set);return Array.from(t).join(" + ")}s(Re,"parseSwapSources");function qi(e){return(0,ky.useMemo)(()=>Re(e),[e])}s(qi,"useProvider");u();l();var _y=D(L());u();l();var zs=D(L());var Cy=s(()=>{let[e,t]=(0,zs.useState)(!1),r=V(m=>m.selectedProviderIndex),o=V(m=>m.selectedBaseProvider),n=V(m=>m.quoteResponse),a=(0,zs.useMemo)(()=>n?n.quotes:[],[n]),c=(0,zs.useMemo)(()=>{if(xo){if(!n||n.quotes.length===0)return 0;let m=YC(n,o);return m===-1?(t(o!==ir),0):(t(!1),m)}return r},[n,o,r]),p=a.length>0?a[c]:void 0;return{selectedQuoteIndex:c,selectedBaseProvider:xo?o:"",currentQuote:p,hasDefaultedToBestQuote:e}},"useSelectedQuote"),YC=s((e,t)=>e.quotes.findIndex(r=>r.baseProvider.id===t),"getQuoteIndexByProvider");function rt(){let e=V(d=>d.quoteResponse),t=V(d=>d.hasNoRoutes),r=V(d=>d.isFetchingQuote),o=(0,_y.useMemo)(()=>e?e.quotes:[],[e]),n=o[0]?.buyAmount??"",{selectedQuoteIndex:a,selectedBaseProvider:c,currentQuote:p,hasDefaultedToBestQuote:m}=Cy();return{bestBuyAmount:n,currentQuote:p,hasNoRoutes:t,quoteResponse:e,quotes:o,selectedProviderIndex:a,selectedBaseProvider:c,isFetchingQuote:r,hasDefaultedToBestQuote:m}}s(rt,"useQuote");u();l();u();l();var Tn=s(e=>e.steps.map(t=>t.tool),"getBridgeTools");var Oe=s(e=>e?se(e)?Tn(e):e?.sources??[]:[],"getSwapQuoteSources");function F9({sender:e}){let{t}=Ie(),{currentQuote:r}=rt(),o=V(h=>h.buyFungible),n=V(h=>h.sellFungible),a=qi(Oe(r)),{data:c}=Ey({callerAddress:e,quote:r,sellFungible:n}),p=c?.transactionPairs?.flatMap(h=>[...ko(h.sellToken)??[],...ko(h.buyToken)??[]])??[],m=[...new Set(p)],{fungibles:d}=mn({keys:m});return{pendingActivityRows:(0,Fy.useMemo)(()=>ur({swapTransactions:c,sellFungible:n,buyFungible:o,fungibles:d,t,currentQuote:r,provider:a}),[c,n,o,d,t,r,a])}}s(F9,"usePendingActivity");function ur({swapTransactions:e,sellFungible:t,buyFungible:r,fungibles:o,currentQuote:n,provider:a,t:c}){let p={pendingSwapActivityRows:[],pendingApprovalActivityRows:[]};return e?e.type==="evm"?e.transactionTypes.reduce((m,d,f)=>{let h=t,w=r,y,S=e.transactionPairs;if(S&&S[f]){let T=S[f];h=zi(T.sellToken,o)??t,w=zi(T.buyToken,o)??r,y=T.approvalMetadata}if(d.includes("approval")){let T=h?.data.symbol??"";m.pendingApprovalActivityRows.push({topLeft:y?{text:`${c("transactionsPendingApproving")} ${y.symbol}`}:{text:`${c("transactionsPendingApproving")} ${T}`}})}else h&&w&&m.pendingSwapActivityRows.push(Iy({sellFungible:h,buyFungible:w,sellAmount:n?.sellAmount,buyAmount:n?.buyAmount,provider:a,isBridge:d.includes("bridge"),t:c}));return m},p):e.transactionTypes.reduce((m,d,f)=>{let h=t,w=r,y=e.transactionPairs;if(y&&y[f]){let S=y[f];h=zi(S.sellToken,o)??t,w=zi(S.buyToken,o)??r}return h&&w&&m.pendingSwapActivityRows.push(Iy({sellFungible:h,buyFungible:w,sellAmount:n?.sellAmount,buyAmount:n?.buyAmount,provider:a,isBridge:d.includes("bridge"),t:c})),m},p):p}s(ur,"getPendingActivityRows");var Iy=s(({sellFungible:e,buyFungible:t,sellAmount:r,buyAmount:o,provider:n,isBridge:a,t:c})=>{let p=e.data.symbol,m=t.data.symbol,d=Ee(r??0,e.data.decimals??0),f=Ee(o??0,t.data.decimals??0);return{topLeft:{text:`${c(a?"transactionsPendingBridging":"transactionsPendingSwapping")} on ${n}`},topRight:{text:`${f} ${m}`,color:"spotPositive"},bottomLeft:{text:`${p} \u2192 ${m}`},bottomRight:{text:`${d} ${p}`}}},"getPendingSwapActivityRows"),zi=s((e,t)=>t.find(r=>(ko(e)??[]).includes(r.data.key)),"getFungibleFromFungibleCaip19");var Gi=class{static{s(this,"BitcoinSwapCommand")}executingQuote;takerAddress;networkId;quote;executionId;constructor(t,r,o,n,a){this.executingQuote=t,this.takerAddress=r,this.networkId=o,this.quote=n,this.executionId=a}async createTransaction(){return Qi({quote:this.quote})}async swap(t,r,o,n,a){let c=r.transactions[0];if(!c)throw new Error("No transaction found");let p=so.Psbt.fromHex(c),m=this.analyzePsbtInputs(p,this.takerAddress),d=await Uf({accountSigner:n,storage:a,accountIdentifier:t,pendingTransactionInput:this.parsePendingTransactionInput(this.executingQuote,r,p),psbt:p,psbtChain:void 0,inputsToSign:m,utxoManager:Lf(new Bf(a))});return{networkID:this.networkId,id:d}}async waitForConfirmation(t){await Mf(this.networkId,t.id)}analyzePsbtInputs(t,r){let o=[];if(t.data.inputs.forEach((n,a)=>{let c;if(n.witnessUtxo?c=n.witnessUtxo.script:n.nonWitnessUtxo&&(c=so.Transaction.fromBuffer(n.nonWitnessUtxo).outs[t.txInputs[a].index].script),c)try{so.address.fromOutputScript(c,so.networks.bitcoin)===r&&o.push(a)}catch(p){console.warn(`Could not decode script for input ${a}:`,p)}}),o.length===0)throw new Error(`No inputs found for user address ${r}`);return[{address:r,signingIndexes:o}]}parsePendingTransactionInput(t,r,o){let n=Re(Oe(t.quote)),c=ur({swapTransactions:r,sellFungible:t.sell,buyFungible:t.buy,fungibles:[],currentQuote:t.quote,provider:n,t:v.t}).pendingSwapActivityRows[0];return{ownerAddress:this.takerAddress,networkID:this.networkId,data:{txID:"",psbtHex:o.toHex()},type:kt.Swap,display:{summary:{topLeft:c.topLeft,topRight:c.topRight,bottomLeft:c.bottomLeft,bottomRight:c.bottomRight}}}}};var Ki=class{static{s(this,"BtcBridgeSwapCommand")}executingQuote;takerAddress;networkId;quote;executionId;bitcoinSwapCommand;constructor(t,r,o,n,a){this.executingQuote=t,this.takerAddress=r,this.networkId=o,this.quote=n,this.executionId=a,this.bitcoinSwapCommand=new Gi(t,r,o,n,a)}async createTransaction(){return Qi({quote:this.quote})}async swap(t,r,o,n,a){return this.bitcoinSwapCommand.swap(t,r,o,n,a)}async waitForConfirmation(t){return this.bitcoinSwapCommand.waitForConfirmation(t)}};u();l();u();l();u();l();u();l();u();l();function XC(e){if(e.length>=255)throw new TypeError("Alphabet too long");let t=new Uint8Array(256);for(let d=0;d<t.length;d++)t[d]=255;for(let d=0;d<e.length;d++){let f=e.charAt(d),h=f.charCodeAt(0);if(t[h]!==255)throw new TypeError(f+" is ambiguous");t[h]=d}let r=e.length,o=e.charAt(0),n=Math.log(r)/Math.log(256),a=Math.log(256)/Math.log(r);function c(d){if(d instanceof Uint8Array||(ArrayBuffer.isView(d)?d=new Uint8Array(d.buffer,d.byteOffset,d.byteLength):Array.isArray(d)&&(d=Uint8Array.from(d))),!(d instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(d.length===0)return"";let f=0,h=0,w=0,y=d.length;for(;w!==y&&d[w]===0;)w++,f++;let S=(y-w)*a+1>>>0,T=new Uint8Array(S);for(;w!==y;){let E=d[w],C=0;for(let I=S-1;(E!==0||C<h)&&I!==-1;I--,C++)E+=256*T[I]>>>0,T[I]=E%r>>>0,E=E/r>>>0;if(E!==0)throw new Error("Non-zero carry");h=C,w++}let b=S-h;for(;b!==S&&T[b]===0;)b++;let A=o.repeat(f);for(;b<S;++b)A+=e.charAt(T[b]);return A}s(c,"encode");function p(d){if(typeof d!="string")throw new TypeError("Expected String");if(d.length===0)return new Uint8Array;let f=0,h=0,w=0;for(;d[f]===o;)h++,f++;let y=(d.length-f)*n+1>>>0,S=new Uint8Array(y);for(;d[f];){let E=t[d.charCodeAt(f)];if(E===255)return;let C=0;for(let I=y-1;(E!==0||C<w)&&I!==-1;I--,C++)E+=r*S[I]>>>0,S[I]=E%256>>>0,E=E/256>>>0;if(E!==0)throw new Error("Non-zero carry");w=C,f++}let T=y-w;for(;T!==y&&S[T]===0;)T++;let b=new Uint8Array(h+(y-T)),A=h;for(;T!==y;)b[A++]=S[T++];return b}s(p,"decodeUnsafe");function m(d){let f=p(d);if(f)return f;throw new Error("Non-base"+r+" character")}return s(m,"decode"),{encode:c,decodeUnsafe:p,decode:m}}s(XC,"base");var vy=XC;var JC="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz",Vi=vy(JC);u();l();var e0=i.object({id:i.string(),state:i.nativeEnum(Me)}).passthrough(),cp=class extends Error{static{s(this,"CashActivityError")}activityId;userId;constructor(t,r,o){super(t),this.activityId=r,this.userId=o,this.name="CashActivityError"}},Gs=class extends Error{static{s(this,"CashActivityNotFoundError")}constructor(t,r){super(`Cash activity ${t} not found for user ${r}`),this.name="CashActivityNotFoundError"}},Py=s(async({userID:e,activityId:t,accessToken:r})=>{let o=await K.api().bearer(r).get(`/cash/v1/users/${e}/cash-activity/${t}`);if(o.status===404)throw new Gs(t,e);let n=e0.safeParse(o.data);if(!n.success)throw new cp(`Failed to parse cash activity response: ${n.error.message}`,t,e);return n.data},"fetchCashActivity");u();l();var up;(function(e){e.Base58="base58",e.Base64="base64"})(up||(up={}));var t0=i.object({activityId:i.string(),transactionId:i.string()}),r0=3,o0=1e3,Ry=s(({accessToken:e,userID:t,idempotencyKey:r,signedTransaction:o,skipActivityRecording:n,skipNotification:a,swapInfo:c,perpsInfo:p,skipPreflight:m,awaitConfirmation:d})=>{if(!e)throw new Error("Access token is required");if(!t)throw new Error("User ID is required");return za(async()=>{let f=await K.api().bearer(e).post(`/cash/v1/users/${t}/cash-account/send`,{idempotencyKey:r,chainId:Yo.Mainnet,signedTransaction:Vi.encode(vm(o)?o.serialize():o.serialize({requireAllSignatures:!1,verifySignatures:!1})),encoding:up.Base58,skipActivityRecording:n,skipNotification:a,...c&&{swapInfo:c},...p&&{perpsInfo:p},...m!==void 0&&{skipPreflight:m},...d!==void 0&&{awaitConfirmation:d}}),h=t0.safeParse(f.data);if(!h.success)throw new Error("Failed to parse transaction response");return h.data},()=>!0,r0,o0)},"broadcastTransaction");var n0=8,s0=z({seconds:1.5}),a0=s(e=>{switch(e){case Me.Failed:case Me.Canceled:case Me.Completed:case Me.Processing:case Me.Refunded:return!0;case Me.Pending:case Me.Unknown:return!1}},"isTerminalState"),i0=s(e=>{switch(e){case Me.Completed:case Me.Processing:case Me.Refunded:return!0;case Me.Failed:case Me.Canceled:case Me.Pending:case Me.Unknown:return!1}},"isSuccessTerminalState");var lp=s(async({unsignedTransaction:e,vaultProxy:t,accountIdentifier:r,signerAddress:o,idempotencyKey:n,isCash:a=!0,accessToken:c,userID:p,skipActivityRecording:m,skipNotification:d,swapInfo:f,perpsInfo:h,skipPreflight:w,awaitConfirmation:y,forceLegacySigning:S})=>{let T;typeof e=="string"?T=xt(e,"bs58"):T=e;let b=S?!1:await c0(t,o);P.addBreadcrumb(M.Cash,"Signing transaction ...",Y.Info),P.addBreadcrumb(M.Cash,`Using vault proxy signing (isCash: ${a}, isCashKMS: ${b})`,Y.Info);let A;a&&b?A={isCash:a,isCashKMS:b,data:{chainType:he.Solana,signingType:"transaction",message:new Uint8Array(Ua(T))}}:a?A={isCash:a,data:{chainType:he.Solana,signingType:"transaction",message:new Uint8Array(Ua(T))}}:A={chainType:he.Solana,signingType:"transaction",message:new Uint8Array(Ua(T))};let E=await t.sign(r,A);if(E.status==="error")throw new Error(E.message);let{signature:C}=E;if(!C)throw new Error("Failed to sign transaction: No signature returned");T.addSignature(new ve.PublicKey(o),Vi.decode(C));let I=T;P.addBreadcrumb(M.Cash,"Signed transaction",Y.Info),P.addBreadcrumb(M.Cash,"Broadcasting transaction ...",Y.Info);let{activityId:N,transactionId:Q}=await Ry({accessToken:c,userID:p,idempotencyKey:n,signedTransaction:I,skipActivityRecording:m,skipNotification:d,swapInfo:f,perpsInfo:h,skipPreflight:w,awaitConfirmation:y});P.addBreadcrumb(M.Cash,"Polling for cash activity...",Y.Info);try{await za(async()=>{let R=await Py({userID:p,activityId:N,accessToken:c});if(a0(R.state)){if(i0(R.state))return P.addBreadcrumb(M.Cash,`Activity reached success terminal state: ${R.state}`,Y.Info),R;{let H=`Activity reached failed terminal state: ${R.state}.`;throw P.addBreadcrumb(M.Cash,H,Y.Info),new Error(H)}}else throw new Error(`Activity state is ${R.state}, waiting for a terminal state.`)},R=>R instanceof Gs||!!(R instanceof Error&&R.message.includes("waiting for")),n0,s0,!0)}catch(R){throw P.addBreadcrumb(M.Cash,`Failed to poll for cash activity: ${R}`,Y.Error),new Error(`Transaction broadcast succeeded but activity confirmation failed: ${R}`)}return P.addBreadcrumb(M.Cash,"Broadcasted transaction",Y.Info),Q},"signAndBroadcastTransaction");async function c0(e,t){try{let o=(await e.getCashKMSAccount()).account.address;return t===o}catch{return P.addBreadcrumb(M.Cash,"Unable to get Cash-KMS account.",Y.Error),!1}}s(c0,"isCashKMSEnabled");u();l();var u0=i.object({activityId:i.string()}),pp=s(async({accessToken:e,userID:t,idempotencyKey:r,swapInfo:o,chainId:n,signedTransaction:a,encoding:c,onchainTxId:p,failureReason:m,skipActivityRecording:d,skipNotification:f,occurredAt:h})=>{if(rn("kill-cash-swap-listener"))return;if(!e)throw new Error("Access token is required");if(!t)throw new Error("User ID is required");let y=await K.api().bearer(e).post(`/cash/v1/users/${t}/cash-account/transaction/failed`,{idempotencyKey:r,swapInfo:o,...n&&{chainId:n},...a&&{signedTransaction:a},...c&&{encoding:c},...p&&{onchainTxId:p},...m&&{failureReason:m},...d!==void 0&&{skipActivityRecording:d},...f!==void 0&&{skipNotification:f},...h&&{occurredAt:h}}),S=u0.safeParse(y.data);if(!S.success)throw new Error("Failed to parse record failed swap response");return S.data},"recordFailedCashSwap");u();l();var vo=s((e,t)=>!e||!t?{}:{sellAmount:t.sellAmount,buyAmount:t.buyAmount,sellToken:e.sell.data.symbol||"unknown",buyToken:e.buy.data.symbol||"unknown"},"swapTelemetryMetadata"),ji=class{static{s(this,"CashSwapCommand")}executingQuote;takerAddress;networkId;quote;executionId;connection;authRepository;cashAccount;constructor(t,r,o,n,a,c,p,m){this.executingQuote=t,this.takerAddress=r,this.networkId=o,this.quote=n,this.executionId=a,this.connection=c,this.authRepository=p,this.cashAccount=m}async createTransaction(){P.addBreadcrumb(M.Cash,"Creating cash swap transaction",Y.Info,vo(this.executingQuote,this.quote));try{return await xy({quote:this.quote,connection:this.connection})}catch(t){throw P.addBreadcrumb(M.Cash,"Failed to create cash swap transaction",Y.Error,vo(this.executingQuote,this.quote)),t}}async swap(t,r,o,n,a){P.addBreadcrumb(M.Cash,"Starting cash swap",Y.Info,vo(this.executingQuote,this.quote));let c=r.transactions[0],p=xt(c,"bs58"),m=Rm(p),d=p.message.header.numRequiredSignatures,f=m.slice(0,d),h=this.cashAccount?.addressDetails.address;if(!h)throw new Error("Cash account address not found");let w=f[0]?.toBase58(),y=w===this.takerAddress?"taker address":w===h?"cash account address":null;y&&P.addBreadcrumb(M.Cash,`Fee payer is ${y}`,Y.Info,vo(this.executingQuote,this.quote));let S=f.some(I=>I.toBase58()===h),T=S?h:this.takerAddress,b=await this.authRepository?.getUser();if(!b)throw new Error("User not found for swap");let{accessToken:A,userID:E}=b,C=this.getSwapInfo(this.executingQuote,this.quote);try{return{id:await lp({unsignedTransaction:c,vaultProxy:n,accountIdentifier:t,signerAddress:T,idempotencyKey:this.executionId,isCash:S,accessToken:A,userID:E,skipActivityRecording:!1,skipNotification:!0,swapInfo:C,waitForActivityState:Me.Completed}),networkID:this.networkId}}catch(I){throw P.addBreadcrumb(M.Cash,"Swap failed",Y.Error,vo(this.executingQuote,this.quote)),I}}async waitForConfirmation(t){P.addBreadcrumb(M.Cash,"Waiting for cash swap confirmation",Y.Info,vo(this.executingQuote,this.quote));try{let r=Ya(t.networkID);await un({connection:r,signature:t.id}),P.addBreadcrumb(M.Cash,"Cash swap confirmed",Y.Info)}catch(r){throw P.addBreadcrumb(M.Cash,"Cash swap confirmation failed",Y.Error,vo(this.executingQuote,this.quote)),r}}parsePendingActivity(t,r){let o=Re(Oe(t.quote));return ur({swapTransactions:r,sellFungible:t.sell,buyFungible:t.buy,fungibles:[],currentQuote:t.quote,provider:o,t:v.t})}getSwapInfo(t,r){let o=t.sell,n=t.buy,a=t.quoteInput,c=o.data.walletAddress,p=n.data.walletAddress;if(!c&&a?.taker){let m=et(a?.taker);m.resourceType===ee.address&&(c=m.address)}if(!p&&a?.takerDestination){let m=et(a?.takerDestination);m.resourceType===ee.address&&(p=m.address)}return{type:Fo.Swap,input:{owner:c,mint:o.data.tokenAddress??"",amount:r.sellAmount,symbol:o.data.symbol??void 0,name:o.data.name??void 0,decimals:o.data.decimals,logoUri:o.data.logoUri??void 0},output:{owner:p,mint:n.data.tokenAddress??"",amount:r.buyAmount,symbol:n.data.symbol??void 0,name:n.data.name??void 0,decimals:n.data.decimals,logoUri:n.data.logoUri??void 0},quoteId:r.rfqProps?.quoteId,quoteSource:Oe(r).map(m=>m.name).join(",")}}};u();l();var Hi=class{static{s(this,"EvmBridgeSwapCommand")}executingQuote;takerAddress;networkId;quote;executionId;evmSwapCommand;constructor(t,r,o,n,a,c){this.executingQuote=t,this.takerAddress=r,this.networkId=o,this.quote=n,this.executionId=a,this.evmSwapCommand=c}createTransaction(){return Us({networkId:this.networkId,callerAddress:this.takerAddress,quote:this.quote})}async swap(t,r,o,n,a){return this.evmSwapCommand.swap(t,r,o,n,a)}async waitForConfirmation(t){return this.evmSwapCommand.waitForConfirmation(t)}};u();l();u();l();var l0=1.3,p0=s(e=>{switch(e){case we.Ethereum.Mainnet:case we.Ethereum.Sepolia:return 8e5;case we.Polygon.Mainnet:case we.Polygon.Amoy:return 5e5;case we.Base.Mainnet:case we.Base.Sepolia:return 5e5;case we.Arbitrum.Mainnet:case we.Arbitrum.Sepolia:return 5e5;case we.Hyperevm.Mainnet:case we.Hyperevm.Testnet:return 5e5;default:return 0}},"getDefaultBridgeGasLimit"),d0=s(e=>{switch(e){case we.Ethereum.Mainnet:case we.Ethereum.Sepolia:return 6e4;case we.Polygon.Mainnet:case we.Polygon.Amoy:return 6e4;case we.Base.Mainnet:case we.Base.Sepolia:return 6e4;case we.Arbitrum.Mainnet:case we.Arbitrum.Sepolia:return 6e4;case we.Hyperevm.Mainnet:case we.Hyperevm.Testnet:return 6e4;default:return 0}},"getDefaultApprovalGasLimit"),m0=s((e,t)=>e.steps.flatMap(o=>o.gasCosts??[p0(t)]),"getBridgeGasLimit"),f0=s((e,t,r)=>{let o=cr(t)?[t.gas]:m0(t,r);return e?e.transactionTypes.map(n=>n.includes("approval")?d0(r):o.shift()??0):o},"getQuoteGasLimit"),An={estimateGas:s(({swapTransactions:e,evmGasEstimation:t,currentQuote:r,scanResult:o,networkID:n,includeGasBuffer:a,gasBuffer:c})=>{let{maxFeePerGas:p,maxPriorityFeePerGas:m}=t,d=f0(e,r,n),f=o?.advancedDetails?.gas;return o?.advancedDetails?.gasLimit>0&&(d=f),d.map(w=>({maxFeePerGas:p,maxPriorityFeePerGas:m,networkID:n,gasLimit:new _(w).multipliedBy(a?c??l0:1).integerValue(_.ROUND_CEIL)}))},"estimateGas")};u();l();var g0=s(({networkID:e,unsignedTransaction:t,pendingActivityRows:r,accountIdentifier:o,accountSigner:n,storage:a,includeCallPayload:c})=>({accountSigner:n,accountIdentifier:o,networkID:e,unsignedTransaction:t,...c&&{callPayload:{from:t.from,to:t.to,data:t.data,value:t.value}},pendingTransactionInput:{ownerAddress:t.from,networkID:e,data:{nonce:"",unsignedTransaction:t,hash:""},type:kt.Swap,display:{summary:r}},storage:a}),"buildArgs"),$i=s(async({transactions:e,transactionTypes:t,networkID:r,gasEstimation:o,pendingApprovalActivityRows:n,pendingSwapActivityRows:a,accountIdentifier:c,accountSigner:p,storage:m})=>{let d=!0,f="";for(let[h,w]of e.entries()){let y=o[h],S={gas:`0x${y.gasLimit.toString(16)}`,maxFeePerGas:`0x${y.maxFeePerGas.toString(16)}`,maxPriorityFeePerGas:`0x${y.maxPriorityFeePerGas.toString(16)}`},T=Zo.parse({...w,...S}),A=t[h].includes("approval")?n:a,E=g0({networkID:r,accountIdentifier:c,pendingActivityRows:A.shift(),accountSigner:p,storage:m,unsignedTransaction:T,includeCallPayload:d});try{f="",f=await qf(E)}catch(C){return{signature:f,error:C instanceof Error?C:new Error("Failed to process EVM swap transaction")}}d&&(d=!1)}return{signature:f}},"swapTransactionEvm");var Dy=br.standard,Wi=class{static{s(this,"EvmSwapCommand")}executingQuote;takerAddress;networkId;quote;executionId;gasEstimation;constructor(t,r,o,n,a,c){this.executingQuote=t,this.takerAddress=r,this.networkId=o,this.quote=n,this.executionId=a,this.gasEstimation=c}createTransaction(){return Os({quote:this.quote,callerAddress:this.takerAddress,networkId:this.networkId,sellFungible:this.executingQuote.sell})}async swap(t,r,o,n,a){let c=this.gasEstimation??await this.estimateGas(this.quote,this.executingQuote.response,Dy,r,o);if(!c)throw new Error(`No gas estimation found for ${Dy}`);let p=this.parsePendingActivity(this.executingQuote,r),{signature:m,error:d}=await P.startSpan("Process EVM Swap Txns",()=>$i({transactions:r.transactions,transactionTypes:r.transactionTypes,networkID:this.networkId,gasEstimation:c,pendingSwapActivityRows:p.pendingSwapActivityRows,pendingApprovalActivityRows:p.pendingApprovalActivityRows,accountIdentifier:t,accountSigner:n,storage:a}));if(d)throw d;return{networkID:this.networkId,id:m}}async waitForConfirmation(t){await kf(t.networkID,t.id)}async estimateGas(t,r,o,n,a){let c=await cn(this.networkId,!0);if(!c)return;let p=c[o];if(!p)return;let m={networkID:this.networkId,gasLimit:new U(1),maxFeePerGas:p.maxFeePerGas,maxPriorityFeePerGas:p.maxPriorityFeePerGas};return An.estimateGas({swapTransactions:n,evmGasEstimation:m,currentQuote:t,scanResult:a??void 0,includeGasBuffer:!0,networkID:this.networkId,gasBuffer:r.gasBuffer})}parsePendingActivity(t,r){let o=Re(Oe(t.quote));return ur({swapTransactions:r,sellFungible:t.sell,buyFungible:t.buy,fungibles:[],currentQuote:t.quote,provider:o,t:v.t})}};u();l();var Ny=D(_m());u();l();u();l();var h0=s(({networkID:e,transaction:t,feePayer:r,connection:o,pendingActivityRows:n,accountIdentifier:a,accountSigner:c,storage:p})=>({accountSigner:c,accountIdentifier:a,transaction:t,feePayer:r,connection:o,opts:{skipPreflight:!0},pendingTransactionInput:{ownerAddress:r.toBase58(),networkID:e,data:{signature:""},type:kt.Swap,display:{summary:n}},storage:p}),"buildArgs"),Zi=s(async({callerAddress:e,connection:t,networkID:r,transactions:o,pendingSwapActivityRows:n,accountIdentifier:a,accountSigner:c,storage:p})=>{let m=new ve.PublicKey(e),d="";for(let[f,h]of o.entries()){let w=xt(h,"bs58"),y=h0({networkID:r,transaction:w,feePayer:m,connection:t,pendingActivityRows:n[f],accountIdentifier:a,accountSigner:c,storage:p});try{d="",d=await Vf(y),f!==o.length-1&&await un({connection:t,signature:d})}catch(S){return{signature:d??"",error:S instanceof Error?S:new Error("Failed to process solana swap transaction")}}}return{signature:d??""}},"swapTransactionSolana");var xr=class{static{s(this,"SolanaSwapCommand")}executingQuote;takerAddress;networkId;quote;executionId;connection;constructor(t,r,o,n,a,c){this.executingQuote=t,this.takerAddress=r,this.networkId=o,this.quote=n,this.executionId=a,this.connection=c}async createTransaction(){return bn({quote:this.quote,connection:this.connection})}async swap(t,r,o,n,a){let c=this.parsePendingActivity(this.executingQuote,r),{signature:p,error:m}=await Zi({callerAddress:this.takerAddress,connection:this.connection,networkID:this.networkId,transactions:r.transactions,pendingSwapActivityRows:c.pendingSwapActivityRows,accountIdentifier:t,accountSigner:n,storage:a});if(m)throw m;return{networkID:this.networkId,id:p}}async waitForConfirmation(t){let r=Ya(t.networkID);await un({connection:r,signature:t.id})}parsePendingActivity(t,r){let o=Re(Oe(t.quote));return ur({swapTransactions:r,sellFungible:t.sell,buyFungible:t.buy,fungibles:[],currentQuote:t.quote,provider:o,t:v.t})}};var y0=i.object({signature:i.string()}),Yi=class extends xr{static{s(this,"GaslessSolanaSwapCommand")}executingQuote;takerAddress;networkId;quote;executionId;connection;gaslessSignature;constructor(t,r,o,n,a,c,p){super(t,r,o,n,a,c),this.executingQuote=t,this.takerAddress=r,this.networkId=o,this.quote=n,this.executionId=a,this.connection=c,this.gaslessSignature=p}async swap(t,r,o,n,a){let c=this.quote.transactionData[0];if(!c)throw new Error("No transaction data found in quote");let p=new ve.PublicKey(this.takerAddress),d=this.parsePendingActivity(this.executingQuote,r).pendingSwapActivityRows[0];if(!d)throw new Error("Unable to create pending activity for gasless");let f=await ti({accountIdentifier:t,feePayer:p,connection:this.connection,accountSigner:n,transaction:xt(c,"bs58"),pendingTransactionInput:{ownerAddress:p.toBase58(),networkID:this.networkId,data:{signature:this.gaslessSignature},type:kt.Swap,display:{summary:d}},storage:a,opts:{}});return{id:(await this.submitGaslessSwap(this.gaslessSignature,f)).signature,networkID:this.networkId}}async submitGaslessSwap(t,r){let o=await K.api().post("/gasless-swap/v1/submit",{quoteSignature:t,encoding:"bs58",chainId:this.networkId,transaction:Ny.default.encode(r.serialize())}),n=y0.safeParse(o.data);if(!n.success)throw new Error("Failed to submit gasless swap");return n.data}};u();l();var w0=i.object({quoteId:i.string(),transactionId:i.string()}),Xi=class extends xr{static{s(this,"RFQSolanaSwapCommand")}executingQuote;takerAddress;networkId;quote;executionId;connection;constructor(t,r,o,n,a,c){super(t,r,o,n,a,c),this.executingQuote=t,this.takerAddress=r,this.networkId=o,this.quote=n,this.executionId=a,this.connection=c}async swap(t,r,o,n,a){let c=this.quote.transactionData[0];if(!c)throw new Error("No transaction data found in quote");let p=new ve.PublicKey(this.takerAddress),d=this.parsePendingActivity(this.executingQuote,r).pendingSwapActivityRows[0];if(!d)throw new Error("Unable to create pending activity for rfq");let f=await ti({accountIdentifier:t,feePayer:p,connection:this.connection,accountSigner:n,transaction:xt(c,"bs58"),pendingTransactionInput:{ownerAddress:p.toBase58(),networkID:this.networkId,data:{signature:""},type:kt.Swap,display:{summary:d}},storage:a,opts:{}});return{id:(await this.submitRFQSwap(f)).transactionId,networkID:this.networkId}}async submitRFQSwap(t){let r=Buffer.from(t.serialize()).toString("base64"),o=await K.api().post("/v0/rfq/swap",{chainId:this.networkId,quoteId:this.quote.rfqProps?.quoteId,signedPayload:r},{headers:{"X-Request-Id":this.executionId}}),n=w0.safeParse(o.data);if(!n.success)throw new Error("Failed to submit rfq swap");return n.data}};u();l();var Ji=class{static{s(this,"SolanaBridgeSwapCommand")}executingQuote;takerAddress;networkId;quote;executionId;connection;solanaSwapCommand;constructor(t,r,o,n,a,c){this.executingQuote=t,this.takerAddress=r,this.networkId=o,this.quote=n,this.executionId=a,this.connection=c,this.solanaSwapCommand=new xr(t,r,o,t.quote,a,c)}createTransaction(){return Ms({quote:this.quote,connection:this.connection})}async swap(t,r,o,n,a){return this.solanaSwapCommand.swap(t,r,o,n,a)}async waitForConfirmation(t){return this.solanaSwapCommand.waitForConfirmation(t)}};u();l();u();l();u();l();var S0=s(({networkID:e,transaction:t,feePayer:r,pendingActivityRows:o,accountIdentifier:n,accountSigner:a,storage:c})=>({accountSigner:a,accountIdentifier:n,transaction:t,pendingTransactionInput:{ownerAddress:r,networkID:e,data:{digest:""},type:kt.Swap,display:{summary:o}},storage:c}),"buildArgs"),ec=s(async({callerAddress:e,networkID:t,transactions:r,pendingSwapActivityRows:o,accountIdentifier:n,accountSigner:a,storage:c})=>{let p="";for(let[m,d]of r.entries()){let f=S0({networkID:t,transaction:Ja.deserializeTransactionString(d),feePayer:e,pendingActivityRows:o[m],accountIdentifier:n,accountSigner:a,storage:c});try{p=(await Gf(f)).digest,m!==r.length-1&&await ei(t,p)}catch(h){return{signature:p??"",error:h instanceof Error?h:new Error("Failed to process sui swap transaction")}}}return{signature:p??""}},"swapTransactionSui");var xn=class{static{s(this,"SuiSwapCommand")}executingQuote;takerAddress;networkId;quote;executionId;constructor(t,r,o,n,a){this.executingQuote=t,this.takerAddress=r,this.networkId=o,this.quote=n,this.executionId=a}async createTransaction(){return qs({quote:this.quote})}async swap(t,r,o,n,a){let c=this.parsePendingActivity(this.executingQuote,r),{signature:p,error:m}=await ec({callerAddress:this.takerAddress,networkID:this.networkId,transactions:r.transactions,pendingSwapActivityRows:c.pendingSwapActivityRows,accountIdentifier:t,accountSigner:n,storage:a});if(m)throw m;return{networkID:this.networkId,id:p}}async waitForConfirmation(t){await ei(this.networkId,t.id)}parsePendingActivity(t,r){let o=Re(Oe(t.quote));return ur({swapTransactions:r,sellFungible:t.sell,buyFungible:t.buy,fungibles:[],currentQuote:t.quote,provider:o,t:v.t})}};var tc=class{static{s(this,"SuiBridgeSwapCommand")}executingQuote;takerAddress;networkId;quote;executionId;suiSwapCommand;constructor(t,r,o,n,a){this.executingQuote=t,this.takerAddress=r,this.networkId=o,this.quote=n,this.executionId=a,this.suiSwapCommand=new xn(t,r,o,t.quote,a)}async createTransaction(){return Qs({quote:this.quote})}async swap(t,r,o,n,a){return this.suiSwapCommand.swap(t,r,o,n,a)}async waitForConfirmation(t){return this.suiSwapCommand.waitForConfirmation(t)}};var rc=class{static{s(this,"WalletSwapCommandFactory")}bridgeStatusManager;constructor(t){this.bridgeStatusManager=t}create(t,r,o,n,a,c,p){if(ty(t.quote)&&(je(t.buy)||je(t.sell)))return new ji(t,r,o,t.quote,$e(),n,a,c);if(x.isSolanaNetworkID(o)&&It(t.quote)){let m=new xr(t,r,o,t.quote,$e(),n);return t.quote.rfqProps?new Xi(t,r,o,t.quote,$e(),n):t.quote.gaslessSignature?new Yi(t,r,o,t.quote,$e(),n,t.quote.gaslessSignature):m}else{if(x.isEVMNetworkID(o)&&cr(t.quote))return this.createEvmSwapCommand(t,r,o,p);if(x.isSuiNetworkID(o)&&Mr(t.quote))return new xn(t,r,o,t.quote,$e());if(se(t.quote)){if(x.isSolanaNetworkID(o))return this.wrapBridgeTrackingCommand(new Ji(t,r,o,t.quote,$e(),n),t);if(x.isEVMNetworkID(o)){let m=this.createEvmSwapCommand(t,r,o,p);return this.wrapBridgeTrackingCommand(new Hi(t,r,o,t.quote,$e(),m),t)}else{if(x.isSuiNetworkID(o))return this.wrapBridgeTrackingCommand(new tc(t,r,o,t.quote,$e()),t);if(x.isBitcoinNetworkID(o))return this.wrapBridgeTrackingCommand(new Ki(t,r,o,t.quote,$e()),t)}}}throw new Error("Unsupported SwapQuote}")}createEvmSwapCommand(t,r,o,n){let a=n?n.filter(Za):void 0;return a&&a.length===0&&(a=void 0),new Wi(t,r,o,t.quote,$e(),a)}wrapBridgeTrackingCommand(t,r){return!this.bridgeStatusManager||!se(r.quote)?t:new Ui(t,this.bridgeStatusManager,r)}};u();l();u();l();var Ks={name:"SwapperNoQuotes",message:"No quotes found"},En=class extends ng{static{s(this,"SwapperQuoteStreamEventProducer")}createStreamUrl({amount:t,amountUsd:r,buy:o,sell:n,taker:a,takerDestination:c,slippageTolerance:p,exactOut:m,autoSlippage:d,priorityFee:f,tipAmount:h,isLedger:w,phantomCashAccount:y}){let S=new URLSearchParams({taker:a,takerDestination:c,buyToken:O(X(o)),sellToken:O(X(n)),sellAmount:t,sellAmountUsd:r??"",exactOut:m?"true":"false",autoSlippage:d?"true":"false",clientEnableGaslessSwap:"true",phantomCashAccount:y?"true":"false"});return p&&S.set("slippageTolerance",String(p)),f&&S.set("priorityFee",String(f)),h&&S.set("tipAmount",String(h)),w!==void 0&&S.set("isLedger",String(w)),`${this.getApiEnvironment()}/swap/v2/stream/quotes?${S.toString()}`}handleNewQuoteResponse(t,r){let o=this.safeJsonParse(t);if(!o.success||!o.data){r({type:"error",errorResponse:Ks});return}try{let n=this.parseSwapQuotesResponse(o.data);r({type:"newQuoteResponse",quoteResponse:n})}catch{r({type:"error",errorResponse:Ks})}}handleErrorQuoteResponse(t,r){let o=this.safeJsonParse(t);if(!o.success||!o.data){r({type:"error",errorResponse:Ks});return}try{let n=gi.safeParse(o.data);r({type:"error",errorResponse:n.success?n.data:Ks})}catch{r({type:"error",errorResponse:Ks})}}parseSwapQuotesResponse(t){let r=new Ve({key:"SwapperNoQuotes"});if(Ds.safeParse(t?.type).success===!1)throw P.captureError(new Error("Failed to parse a valid quote type."),M.Swapper),new Error("Invalid input");let o=wi.safeParse(t);if(!o.success)throw P.captureError(new Error("Failed to parse a valid swap quotes response."),M.Swapper),r;if(o.data.includesAllProviders&&o.data.quotes.length===0)throw r;return o.data}};var oc=class extends En{static{s(this,"EventStreamQuoteStreamProducer")}eventSource;open(t,r){this.close();let o=this.createStreamUrl(t);this.eventSource=new ai(o,this.getOptionsWithAuth(o));let n=s(a=>{switch(a.type){case"new-quote-response":this.handleNewQuoteResponse(a.data,r);break;case"error-quote-response":this.handleErrorQuoteResponse(a.data,r);break;case"open":r({type:"open"});break;case"error":r({type:"error",errorResponse:{name:"UnknownError",message:a.message}});break;case"close":r({type:"close"});break}},"eventSourceListener");this.eventSource.addEventListener("new-quote-response",n),this.eventSource.addEventListener("error-quote-response",n),this.eventSource.addEventListener("open",n),this.eventSource.addEventListener("error",n),this.eventSource.addEventListener("close",n)}close(){this.eventSource&&(this.eventSource.removeAllEventListeners(),this.eventSource.close())}};u();l();var nc=class extends En{static{s(this,"NativeEventStreamQuoteStreamProducer")}eventSource;open(t,r){this.close();let o=this.createStreamUrl(t);this.eventSource=new ai(o,this.getOptionsWithAuth(o));let n=s(a=>{switch(a.type){case"new-quote-response":this.handleNewQuoteResponse(a.data,r);break;case"error-quote-response":this.handleErrorQuoteResponse(a.data,r);break;case"open":r({type:"open"});break;case"error":r({type:"error",errorResponse:{name:"UnknownError",message:a.message}});break;case"close":r({type:"close"});break}},"eventSourceListener");this.eventSource.addEventListener("new-quote-response",n),this.eventSource.addEventListener("error-quote-response",n),this.eventSource.addEventListener("open",n),this.eventSource.addEventListener("error",n),this.eventSource.addEventListener("close",n)}close(){this.eventSource&&(this.eventSource.removeAllEventListeners(),this.eventSource.close())}};u();l();var sc=class{static{s(this,"QuoteStreamer")}producer;listeners=new Set;constructor(t){this.producer=t}openStream(t){this.listeners.forEach(r=>r.onEvent({type:"openRequested"})),this.producer.close(),this.producer.open(t,r=>{this.listeners.forEach(o=>o.onEvent(r)),r.type==="error"&&this.closeStream()})}closeStream(){this.producer.close()}subscribe(t){this.listeners.add(t)}unsubscribe(t){this.listeners.delete(t)}};u();l();u();l();function By(e){return e<3e5?1e4:e<6e5?15e3:3e4}s(By,"getBridgeStatusPollInterval");function b0(e){let t="pending";switch(e.status){case"DONE":t="completed";break;case"FAILED":t="failed";break;case"PENDING":case"NOT_FOUND":default:t="pending";break}return{state:t,rawStatus:e.status,updatedAt:Date.now(),fromAddress:e.fromAddress,toAddress:e.toAddress}}s(b0,"normalizeSwapperStatus");var dp=class{static{s(this,"BridgeStatusPoller")}args;timeoutId=null;isActive=!1;client;constructor(t){this.args=t,this.client=t.client}start(){this.isActive||(this.isActive=!0,this.scheduleNext(0))}stop(){this.isActive=!1,this.timeoutId&&(clearTimeout(this.timeoutId),this.timeoutId=null)}scheduleNext(t){this.isActive&&(this.timeoutId=setTimeout(()=>{this.poll()},t))}async poll(){if(this.isActive)try{let t=await this.client.fetchStatus(this.args.record.transactionHash),r=b0(t),o;switch(r.state){case"completed":o={type:"completed",status:r},this.stop();break;case"failed":o={type:"failed",status:r},this.stop();break;case"pending":default:{o={type:"pending",status:r};let n=Date.now()-this.args.record.startedAt;this.scheduleNext(By(n));break}}this.args.onEvent(o)}catch(t){this.args.onEvent({type:"error",error:t});let r=Date.now()-this.args.record.startedAt;this.scheduleNext(By(r))}}};function Ly(e){return new dp(e)}s(Ly,"createBridgeStatusPoller");u();l();var T0=i.object({status:i.string(),sending:i.object({txHash:i.string().optional()}).optional(),receiving:i.object({txHash:i.string().optional()}).optional(),fromAddress:i.string().optional(),toAddress:i.string().optional()}).passthrough(),ac=class{static{s(this,"SwapperStatusClient")}async fetchStatus(t){let r=await K.api().get("/swap/v2/status/lifi",{params:{txHash:t}}),o=r?.data??r,n=T0.safeParse(o);if(!n.success)throw new Error("Unable to parse bridge status response");return n.data}};u();l();var mp="sdk.bridgeStatus.pending";var fp=class{static{s(this,"BridgeStatusManager")}storage;client;createPoller;records=new Map;pollers=new Map;listeners=new Set;hydratePromise;constructor(t,r={}){this.storage=t,this.client=r.client??new ac,this.createPoller=r.createPoller??Ly}async initialize(){this.hydratePromise||(this.hydratePromise=this.hydrate()),await this.hydratePromise}destroy(){this.pollers.forEach(t=>t.stop()),this.pollers.clear(),this.records.clear()}addListener(t){this.listeners.add(t)}removeListener(t){this.listeners.delete(t)}getPendingRecords(){return Array.from(this.records.values())}getPendingActivityRows(t,r){return this.getPendingBridgeActivities(t,r).map(o=>o.row)}getPendingBridgeActivities(t,r){return this.filterRecordsByAddresses(r?.addresses).map(n=>({record:n,row:Qy(n,t)}))}getPendingBridgeTransactions(t,r){return this.filterRecordsByAddresses(r?.addresses).map(n=>Uy(n,t))}getPendingBridgeTransactionById(t,r){let o=this.records.get(t);if(o)return Uy(o,r)}isPendingBridgeTransaction(t){return this.records.has(t)}async track(t){if(await this.initialize(),!this.shouldTrackQuote(t.executingQuote))return;let r=A0(t.executingQuote),o=this.records.get(t.executionId),n={executionId:t.executionId,transactionHash:t.transactionHash,startedAt:o?.startedAt??Date.now(),quote:r,status:o?.status};this.records.set(t.executionId,n),this.restartPoller(n),await this.persistRecords()}async hydrate(){try{let t=await this.storage.get(mp)??"[]",r=JSON.parse(t);for(let o of r){let n=this.normalizePersistedRecord(o);n&&(this.records.set(n.executionId,n),this.startPoller(n))}}catch(t){console.error("Failed to hydrate bridge status records",t)}}shouldTrackQuote(t){if(!se(t.quote))return!1;let r=t.sell?.data?.chain?.id,o=t.buy?.data?.chain?.id;return o&&x.isBitcoinNetworkID(o)||r&&x.isBitcoinNetworkID(r)||!1}startPoller(t){let r=this.createPoller({record:t,client:this.client,onEvent:s(o=>this.handlePollerEvent(t.executionId,o),"onEvent")});this.pollers.set(t.executionId,r),r.start()}restartPoller(t){this.stopPoller(t.executionId),this.startPoller(t)}stopPoller(t){let r=this.pollers.get(t);r&&(r.stop(),this.pollers.delete(t))}async persistRecords(){try{let t=Array.from(this.records.values()).map(r=>({executionId:r.executionId,transactionHash:r.transactionHash,startedAt:r.startedAt,quote:r.quote,status:r.status}));await this.storage.set(mp,JSON.stringify(t))}catch(t){console.error("Failed to persist bridge status records",t)}}removeRecord(t){this.records.delete(t),this.stopPoller(t),this.persistRecords()}normalizePersistedRecord(t){return"quote"in t&&x0(t.quote)?t:null}handlePollerEvent(t,r){let o=this.records.get(t);if(o)switch(r.type){case"pending":o.status=r.status,this.notifyListeners({type:"pending",record:o,status:r.status}),this.persistRecords();break;case"completed":o.status=r.status,this.notifyListeners({type:"completed",record:o,status:r.status}),this.removeRecord(t);break;case"failed":o.status=r.status,this.notifyListeners({type:"failed",record:o,status:r.status}),this.removeRecord(t);break;case"error":this.notifyListeners({type:"error",record:o,error:r.error});break}}notifyListeners(t){this.listeners.forEach(r=>{try{r.onBridgeStatusChange(t)}catch(o){console.error("BridgeStatusListener error",o)}})}filterRecordsByAddresses(t){if(!t?.length)return this.getPendingRecords();let r=E0(t);return this.getPendingRecords().filter(o=>o.quote.accountAddresses.some(n=>r.has(Oy(n))))}};function A0(e){if(!se(e.quote))throw new Error("Non-bridge quotes cannot be tracked");return{sell:e.sell,buy:e.buy,quote:e.quote,amount:e.amount,accountAddresses:e.account.addresses}}s(A0,"createQuoteSnapshot");function x0(e){return!!(e&&se(e.quote))}s(x0,"isValidSnapshot");function E0(e){return new Set(e.map(Oy))}s(E0,"createAddressLookup");function Oy(e){return`${e.networkID}:${k0(e.address,e.networkID)}`}s(Oy,"createAddressKey");function k0(e,t){return x.isEVMNetworkID(t)?e.toLowerCase():e}s(k0,"normalizeAddress");function Qy(e,t){let r=e.quote.quote,o=e.quote.sell,n=e.quote.buy,a=Ee(r.sellAmount,o?.data.decimals??0),c=Ee(r.buyAmount,n?.data.decimals??0),p=o?.data.symbol??"",m=n?.data.symbol??"",d=e.startedAt+z({minutes:20}),f=Date.now(),h=d-f,w=Math.max(0,Math.ceil(h/(60*1e3))),y=w>0?`Est. ${w}m`:"Est. <1m";return{topLeft:{text:t("transactionsPendingSwapping")},topRight:{text:`${c} ${m}`,color:"spotPositive"},bottomLeft:{text:y},bottomRight:{text:`${a} ${p}`}}}s(Qy,"createPendingBridgeActivityRow");function C0(e,t){if(x.isEVMNetworkID(e))return{nonce:0,transactions:[{hash:t.transactionHash,timestamp:t.startedAt,unsignedTransaction:{},confirmations:0}]};if(x.isBitcoinNetworkID(e))return{txID:t.transactionHash,psbtHex:"",confirmations:0};if(x.isSolanaNetworkID(e))return{signature:t.transactionHash};if(x.isSuiNetworkID(e))return{digest:t.transactionHash};throw new Error(`Unsupported network for bridge transaction: ${e}`)}s(C0,"createBridgePendingTransactionData");function Uy(e,t){let r=e.quote.sell,o=e.quote.buy,n=r?.data.chain?.id;if(!n)throw new Error("Cannot create pending transaction: missing network ID");let a=Qy(e,t),c=e.quote.accountAddresses.find(y=>y.networkID===n)?.address??"",p=o?.data.chain?.id,m=p?e.quote.accountAddresses.find(y=>y.networkID===p)?.address:void 0,d=m?nn(m,4):"",f=Ee(e.quote.quote.buyAmount,o?.data.decimals??0),h=o?.data.symbol??"",w=`${f} ${h}`;return{id:e.executionId,timestamp:e.startedAt,ownerAddress:c,networkID:n,type:kt.Swap,display:{summary:{topLeft:a.topLeft,topRight:a.topRight,bottomLeft:a.bottomLeft,bottomRight:a.bottomRight},detail:{header:w,assetSymbol:h,uiRecipient:d}},data:C0(n,e)}}s(Uy,"createPendingTransactionFromBridgeRecord");var ic=null,My=null;function qy(e){return ic||(ic=new fp(e)),My||(My=ic.initialize()),ic}s(qy,"getBridgeStatusManager");u();l();u();l();var $t=s((e,t)=>!!e&&!!t&&x.compareNetworkID(e,t)!==0,"isBridgeSwap");u();l();var uc=D(Om()),zy=D(GE()),lc=D(zE());u();l();u();l();function Qt(e,t,r){if(t.lte(0))return null;let o=O({chainId:e,resourceType:ee.nativeToken,slip44:x.getSlip44(e)}),n=x.getTokenDecimals(e),a=x.getTokenSymbol(e);if(!o||!n||!a)return null;let c=t.div(Wa(n)),p=r[o];return p?.usd?c.times(p.usd).toNumber():null}s(Qt,"getFeeInUsd");var _0={"Allbridge's fee":"destinationNetwork","Allbridge Liquidity Fee":"liquidityProvider"};function I0(e,t){return{type:e,amountUsd:new _(t.amountUSD??0),amount:new _(t.amount??0)}}s(I0,"bridgeFeeToFee");function ao(e){return e.steps.flatMap(r=>r.includedFeeCosts).reduce((r,o)=>{if(!o)return r;let n=_0[o.name];return n&&new _(o.amount).gt(0)&&r.push(I0(n,o)),r},[])}s(ao,"getIncludedBridgeFees");function io(e,t,r){let o=e.steps.reduce((n,a)=>n.plus(a.nonIncludedNonGasFees),new _(0));return o.isZero()?[]:[{type:"nonIncludedNonGas",amountUsd:new _(Qt(t,o,r)??0),amount:o}]}s(io,"getNonIncludedBridgeFees");var cc=class{static{s(this,"BtcProcessBridgeQuoteCommand")}networkID;priceClient;constructor(t,r){this.networkID=t,this.priceClient=r}getNativeTokenCaip19(){return O({chainId:this.networkID,resourceType:ee.nativeToken,slip44:x.getSlip44(this.networkID)})}async processQuote(t,r){let o=await this.createSwapTransactions(t),n=await this.priceClient.getPrice(this.getNativeTokenCaip19());if(!n.usd)throw new Error("Price data not found");let a=await this.calculateNetworkFee(t,n),c=this.appendBridgeFees([a],t,n),p=this.appendPhantomFee(c,t);return{quote:t,fees:{totalFees:this.sumFees(p),fees:p},swapTransactions:o}}createSwapTransactions(t){let r=[],o=[],n=[];for(let a of t.steps){let{transactionData:c,sellToken:p,buyToken:m}=a;r.push(c),o.push("bridge"),n.push({sellToken:p,buyToken:m})}return Promise.resolve({type:"bitcoin",transactions:r,transactionTypes:o,transactionPairs:n})}appendPhantomFee(t,r){let o=r.steps.flatMap(n=>n.feeCosts).find(n=>n.name==="phantom");return o?[...t,{type:"phantom",percentage:new _(o.percentage),amountUsd:new _(0),amount:new _(0)}]:t}appendBridgeFees(t,r,o){let n={[this.getNativeTokenCaip19()]:o},a=io(r,this.networkID,n),c=ao(r);return[...t,...c,...a]}async calculateNetworkFee(t,r){if(!r.usd)throw new Error("Price data not found");let o=t.steps.flatMap(n=>n.gasCosts??[]);if(o.length>0){let n=o.reduce((p,m)=>p+m,0);return{type:"bitcoinNetwork",amountUsd:new _(n).shiftedBy(-8).times(r.usd),amount:new _(n)}}try{let n=t.steps[0];if(!n?.transactionData)throw new Error("No transaction data available for fee estimation");let a=uc.Psbt.fromHex(n.transactionData),c=F0(a),m=(await ig(this.networkID))[br.standard]?.btcPerKilobyte;if(!m)throw new Error("Failed to get standard fee rate");let f=_f(m).times(c).integerValue(_.ROUND_UP);return{type:"bitcoinNetwork",amountUsd:f.shiftedBy(-8).times(r.usd),amount:f}}catch{let a=new _(1e4);return{type:"bitcoinNetwork",amountUsd:a.shiftedBy(-8).times(r.usd),amount:a}}}sumFees(t){return t.reduce((r,o)=>r.plus(o.amountUsd),new _(0))}};function F0(e){let{header:t,perInput:r}=$a[If(e)],{inputs:o}=e.data,n=new _(t),a=new _(o.length).times(r),c=e.txOutputs.reduce((p,m)=>{let d=lc.decompile(m.script);if(d&&d[0]===lc.OPS.OP_RETURN)return p;let f;if(m.address)f=m.address;else try{f=(0,zy.fromOutputScript)(m.script,uc.networks.bitcoin)}catch{return p.plus($a[he.BitcoinNativeSegwit].perOutput)}let h=Gm(we.Bitcoin.Mainnet,f);return p.plus($a[h].perOutput)},new _(0));return n.plus(a).plus(c)}s(F0,"calculateVirtualBytes");u();l();u();l();var Gy=D(L());u();l();var Ce;(function(e){e.SlippageTolerance="slippageTolerance",e.PriorityFee="priorityFee",e.TipAmount="tipAmount",e.LastSubmittedPairs="lastSubmittedPairsV2",e.LastSelectedTokens="lastSelectedTokens",e.SlippageSettings="slippageSettings",e.HasViewedAutoSlippageOptIn="hasViewedAutoSlippageOptIn",e.PriorityFeeSettings="priorityFeeSettings",e.TipSettings="tipSettings"})(Ce||(Ce={}));function vt({key:e,queryKey:t,defaultValue:r=null}){let o=wt();return ae({enabled:!0,queryKey:t,gcTime:Mi.Long,staleTime:Oi.Never,async queryFn(){try{return await o.get(e)}catch(n){return n instanceof Error&&P.captureError(n,M.Swapper),r}}})}s(vt,"useSwapStorageValue");function Pt({key:e,queryKey:t}){let r=wt(),o=ze();return Eo({async mutationFn(n){try{return await r.set(e,n)}catch(a){a instanceof Error&&P.captureError(a,M.Swapper);return}},async onMutate(n){await o.cancelQueries({queryKey:t});let a=o.getQueryData(t);return o.setQueryData(t,n),{previousValue:a}},onError(n,a,c){o.setQueryData(t,c?.previousValue)}})}s(Pt,"useSetSwapStorageValue");var ce;(function(e){e.Auto="auto",e.Fixed="fixed"})(ce||(ce={}));var v0={type:ce.Auto},co=s(()=>{let{slippageSetting:e,isFetched:t,save:r}=P0();return{isFetched:t,selectedSetting:e??v0,setSlippageSetting:r}},"useSlippageSettings"),P0=s(()=>{let{data:e,isFetched:t}=vt({key:Ce.SlippageSettings,queryKey:ye.slippageSettings()}),{mutateAsync:r}=Pt({key:Ce.SlippageSettings,queryKey:ye.slippageSettings()}),o=(0,Gy.useCallback)(async n=>{await r(n)},[r]);return{isFetched:t,slippageSetting:e,save:o}},"useSlippageSettingsStore");u();l();async function kn({transactions:e,locale:t,url:r,deviceId:o,takerAddress:n,networkId:a,slippageType:c,quote:p,quoteResponse:m,isSimulationKilled:d}){try{return d?{status:"skipped"}:x.isHyperevmNetworkID(a)?{status:"skipped"}:{status:"success",result:await bl(t,o,{type:"transaction",userAccount:n,params:R0(e),url:r,networkID:a,context:se(p)?"bridge":ry(p)?"gaslessSwap":"swap",provider:D0(p),slippageType:c,metadata:{swapper:{quoteOutputAmount:p.buyAmount,quoteOutputToken:O(m.buyToken),quoteInputAmount:p.sellAmount,quoteInputToken:O(m.sellToken)}}})}}catch(f){return{status:"error",error:f}}}s(kn,"simulateSwap");var R0=s(e=>{switch(e.type){case"evm":return{transactions:e.transactions};case"solana":return{transactions:e.transactions,method:"signAndSendTransaction",simulatorConfig:{decodeAccounts:!1}};case"sui":case"bitcoin":return{transactions:e.transactions,method:"signAndSendTransaction"}}},"getScannedTransactionParams"),D0=s(e=>{let t=se(e)?Tn(e):e?.sources??[];return Re(t)},"getProvider");var pc=class{static{s(this,"EVMProcessBridgeQuoteCommand")}networkID;account;priceClient;quoteInput;quoteResponse;constructor(t,r,o,n,a){this.networkID=t,this.account=r,this.priceClient=o,this.quoteInput=n,this.quoteResponse=a}getNativeTokenCaip19(){return O({chainId:this.networkID,resourceType:ee.nativeToken,slip44:x.getSlip44(this.networkID)})}async processQuote(t,r){let o=await this.createSwapTransactions(t),n=await this.priceClient.getPrice(this.getNativeTokenCaip19());if(!n.usd)throw new Error("Price data not found");let a=await this.calculateNetworkFee(o,t,n,r),c=this.appendBridgeFees([a],t,n),p=this.appendPhantomFee(c,t);return{quote:t,fees:{totalFees:this.sumFees(p),fees:p},swapTransactions:o}}createSwapTransactions(t){return Us({networkId:this.networkID,callerAddress:this.checkChainAddress().address,quote:t})}appendPhantomFee(t,r){let o=r.steps.flatMap(n=>n.feeCosts).find(n=>n.name==="phantom");return o?[...t,{type:"phantom",percentage:new _(o.percentage),amountUsd:new _(0),amount:new _(0)}]:t}appendBridgeFees(t,r,o){let n={[this.getNativeTokenCaip19()]:o},a=io(r,this.networkID,n),c=ao(r);return[...t,...c,...a]}async calculateNetworkFee(t,r,o,n){let a=await this.estimateGas(r,t,n);if(!a)throw new Error("Unable to estimate gas");if(!o.usd)throw new Error("Price data not found");let c=a[0],p=x.getTokenDecimals(this.networkID),m=c.gasLimit.times(c.maxFeePerGas);return{type:"evmGas",amountUsd:new _(m).shiftedBy(-p).times(o.usd),amount:m}}async estimateGas(t,r,o){let n=await cn(this.networkID,!0);if(!n)return;let a=n[br.standard];if(!a)return;let c={networkID:this.networkID,gasLimit:new _(1),maxFeePerGas:a.maxFeePerGas,maxPriorityFeePerGas:a.maxPriorityFeePerGas},p=await kn({transactions:r,locale:"en-us",url:"https://phantom.app",deviceId:"123",takerAddress:this.checkChainAddress().address,networkId:this.networkID,slippageType:this.quoteInput.autoSlippage?ce.Auto:ce.Fixed,quote:t,quoteResponse:this.quoteResponse,isSimulationKilled:o});return An.estimateGas({swapTransactions:r,evmGasEstimation:c,currentQuote:t,scanResult:p.status==="success"?p.result:void 0,includeGasBuffer:!0,networkID:this.networkID,gasBuffer:this.quoteResponse.gasBuffer})}checkChainAddress(){let t=this.account.addresses.find(o=>o.networkID===this.networkID);if(!t)throw new Error(`No address found for chain ${this.networkID}`);let r={...t};return fr(r)&&(r.address=r.address.toLowerCase()),r}sumFees(t){return t.reduce((r,o)=>r.plus(o.amountUsd),new _(0))}};u();l();var dc=class{static{s(this,"EVMProcessQuoteCommand")}networkID;account;priceClient;quoteInput;quoteResponse;constructor(t,r,o,n,a){this.networkID=t,this.account=r,this.priceClient=o,this.quoteInput=n,this.quoteResponse=a}getNativeTokenCaip19(){return O({chainId:this.networkID,resourceType:ee.nativeToken,slip44:x.getSlip44(this.networkID)})}async processQuote(t,r){let o=await this.createSwapTransactions(t),n=await this.calculateNetworkFee(o,t,r),a=this.appendPhantomFee([n],t);return{quote:t,fees:{totalFees:this.sumFees(a),fees:a},swapTransactions:o}}createSwapTransactions(t){return Os({networkId:this.networkID,callerAddress:this.checkChainAddress().address,quote:t,sellFungible:this.quoteInput.sell})}appendPhantomFee(t,r){let o=r.fees.find(n=>n.type==="phantom");return o?[...t,{type:"phantom",percentage:new _(o.percentage),amountUsd:new _(0),amount:new _(0)}]:t}async calculateNetworkFee(t,r,o){let n=await this.estimateGas(r,t,o);if(!n)throw new Error("Unable to estimate gas");let a=await this.priceClient.getPrice(this.getNativeTokenCaip19());if(!a.usd)throw new Error("Price data not found");let c=n[0],p=x.getTokenDecimals(this.networkID),m=c.gasLimit.times(c.maxFeePerGas);return{type:"evmGas",amountUsd:new _(m).shiftedBy(-p).times(a.usd),amount:m}}async estimateGas(t,r,o){let n=await cn(this.networkID,!0);if(!n)return;let a=n[br.standard];if(!a)return;let c={networkID:this.networkID,gasLimit:new _(1),maxFeePerGas:a.maxFeePerGas,maxPriorityFeePerGas:a.maxPriorityFeePerGas},p=await kn({transactions:r,locale:"en-us",url:"https://phantom.app",deviceId:"123",takerAddress:this.checkChainAddress().address,networkId:this.networkID,slippageType:this.quoteInput.autoSlippage?ce.Auto:ce.Fixed,quote:t,quoteResponse:this.quoteResponse,isSimulationKilled:o});return An.estimateGas({swapTransactions:r,evmGasEstimation:c,currentQuote:t,scanResult:p.status==="success"?p.result:void 0,includeGasBuffer:!0,networkID:this.networkID,gasBuffer:this.quoteResponse.gasBuffer})}checkChainAddress(){let t=this.account.addresses.find(o=>o.networkID===this.networkID);if(!t)throw new Error(`No address found for chain ${this.networkID}`);let r={...t};return fr(r)&&(r.address=r.address.toLowerCase()),r}sumFees(t){return t.reduce((r,o)=>r.plus(o.amountUsd),new _(0))}};u();l();var mc=class{static{s(this,"SolanaProcessBridgeQuoteCommand")}networkID;priceClient;connection;constructor(t,r,o){this.networkID=t,this.priceClient=r,this.connection=o}getNativeTokenCaip19(){return O({chainId:this.networkID,resourceType:ee.nativeToken,slip44:x.getSlip44(this.networkID)})}async processQuote(t,r){let o=await this.createSwapTransactions(t),n=await this.priceClient.getPrice(this.getNativeTokenCaip19());if(!n.usd)throw new Error("Price data not found");let a=await this.calculateNetworkFee(o,n),c=this.appendBridgeFees([a],t,n),p=this.appendPhantomFee(c,t);return{quote:t,fees:{totalFees:this.sumFees(p),fees:p},swapTransactions:o}}createSwapTransactions(t){return Ms({quote:t,connection:this.connection})}appendPhantomFee(t,r){let o=r.steps.flatMap(n=>n.feeCosts).find(n=>n.name==="phantom");return o?[...t,{type:"phantom",percentage:new _(o.percentage),amountUsd:new _(0),amount:new _(0)}]:t}appendBridgeFees(t,r,o){let n={[this.getNativeTokenCaip19()]:o},a=io(r,this.networkID,n),c=ao(r);return[...t,...c,...a]}async calculateNetworkFee(t,r){if(!r.usd)throw new Error("Price data not found");let o=t.transactions.map(d=>this.processEncodedTx(d,this.networkID,this.connection)),a=(await Promise.all(o)).map(d=>d.networkFeeEstimation.value),c=new _(a[0]);return{type:"solanaNetwork",amountUsd:c.div(new _(ve.LAMPORTS_PER_SOL)).times(r.usd),amount:c}}async processEncodedTx(t,r,o){let n=xt(t,"bs58");return await Pm(n,o),{networkFeeEstimation:await Kf(r,[n.message])}}sumFees(t){return t.reduce((r,o)=>r.plus(o.amountUsd),new _(0))}};u();l();u();l();function Ky(e,t){return N0(e.fees,r=>{switch(r.type){case"gasless":return{type:"gasless",amountUsd:new _(0),amount:new _(0),percentage:new _(r.percentage)};case"phantom":return{type:"phantom",percentage:new _(r.percentage),amountUsd:new _(0),amount:new _(0)};case"ata":return new _(r.amount).isZero()?void 0:{type:"ata",amountUsd:new _(r.amount),amount:new _(0)};case"gasless_network":return{type:"solanaGaslessNetwork",amountUsd:new _(r.amount),amount:new _(0)};case"network":{let{amountUsd:o,amount:n}=gp(r,t);return{type:"solanaNetwork",amountUsd:o,amount:n}}case"tips":{let{amountUsd:o,amount:n}=gp(r,t);return{type:"tips",amountUsd:o,amount:n}}case"priority_fee":{let{amountUsd:o,amount:n}=gp(r,t);return{type:"priorityFee",amountUsd:o,amount:n}}default:return}})}s(Ky,"parseFees");function gp(e,t){let r=new _(e.amount);return{amountUsd:r.div(new _(ve.LAMPORTS_PER_SOL)).times(t),amount:r}}s(gp,"getAmountsFromNativeAmount");function N0(e,t){return e.reduce((r,o,n)=>{let a=t(o,n,e);return a!=null&&r.push(a),r},[])}s(N0,"compactMap");var Vy=["solanaNetwork","tips","priorityFee"],fc=class{static{s(this,"SolanaProcessQuoteCommand")}networkID;priceClient;connection;constructor(t,r,o){this.networkID=t,this.priceClient=r,this.connection=o}getNativeTokenCaip19(){return O({chainId:this.networkID,resourceType:ee.nativeToken,slip44:x.getSlip44(this.networkID)})}async processQuote(t,r){let n=(await this.priceClient.getPrice(this.getNativeTokenCaip19())).usd;if(!n)throw new Error(`Price data not found for native token ${this.getNativeTokenCaip19()}`);let a=await this.createSwapTransactions(t),c=Ky(t,n),p=await this.processParsedFees(c,n);return{quote:t,fees:{totalFees:this.sumFees(p),fees:p},swapTransactions:a}}async processParsedFees(t,r){if(t.find(m=>m.type==="solanaGaslessNetwork"))return t;let o=t.filter(m=>!Vy.includes(m.type)),n=t.filter(m=>Vy.includes(m.type)),a=t.find(m=>m.type==="priorityFee"),c=await this.calculateNetworkFee(a,r),p=this.sumNetworkFees(c,n);return[...o,p]}sumNetworkFees(t,r){return r.reduce((o,n)=>({...o,amount:o.amount.plus(n.amount),amountUsd:o.amountUsd.plus(n.amountUsd)}),t)}createSwapTransactions(t){return bn({quote:t,connection:this.connection})}getAmountsFromNativeAmount(t,r){let o=new _(t.amount);return{amountUsd:o.div(new _(ve.LAMPORTS_PER_SOL)).times(r),amount:o}}async calculateNetworkFee(t,r){let o=new _(t?.amount??0);return{type:"solanaNetwork",amountUsd:o.div(new _(ve.LAMPORTS_PER_SOL)).times(r),amount:o}}sumFees(t){return t.reduce((r,o)=>r.plus(o.amountUsd),new _(0))}};u();l();u();l();var Cn=class{static{s(this,"SuiProcessQuoteCommand")}networkID;priceClient;constructor(t,r){this.networkID=t,this.priceClient=r}getNativeTokenCaip19(){return O({chainId:this.networkID,resourceType:ee.nativeToken,slip44:x.getSlip44(this.networkID)})}async processQuote(t,r){let o=await this.createSwapTransactions(t),n=await this.calculateNetworkFee(o),a=this.appendPhantomFee([n],t);return{quote:t,fees:{totalFees:this.sumFees(a),fees:a},swapTransactions:o}}createSwapTransactions(t){return qs({quote:t})}appendPhantomFee(t,r){let o=r.fees.find(n=>n.type==="phantom");return o?[...t,{type:"phantom",percentage:new _(o.percentage),amountUsd:new _(0),amount:new _(0)}]:t}async calculateNetworkFee(t){let r=await this.priceClient.getPrice(this.getNativeTokenCaip19());if(!r.usd)throw new Error("Price data not found");let o=new _(0),n=new _(0);try{let a=await Promise.all(t.transactions.map(c=>zf({networkID:this.networkID,transaction:Ja.deserializeTransactionString(c)})));n=new _(a.reduce((c,p)=>c+p.gasBudget.toNumber(),0)),o=n.dividedBy(1e9).multipliedBy(r.usd)}catch{return{type:"suiNetwork",amountUsd:new _(0),amount:new _(0)}}return{type:"suiNetwork",amountUsd:o,amount:n}}sumFees(t){return t.reduce((r,o)=>r.plus(o.amountUsd),new _(0))}};var gc=class{static{s(this,"SuiBridgeProcessQuoteCommand")}networkID;priceClient;suiProcessQuoteCommand;constructor(t,r){this.networkID=t,this.priceClient=r,this.suiProcessQuoteCommand=new Cn(t,r)}getNativeTokenCaip19(){return this.suiProcessQuoteCommand.getNativeTokenCaip19()}async processQuote(t,r){let o=await this.createSwapTransactions(t),n=await this.priceClient.getPrice(this.getNativeTokenCaip19());if(!n.usd)throw new Error("Price data not found");let a=await this.suiProcessQuoteCommand.calculateNetworkFee(o),c=this.appendBridgeFees([a],t,n),p=this.appendPhantomFee(c,t);return{quote:t,fees:{totalFees:this.sumFees(p),fees:p},swapTransactions:o}}appendBridgeFees(t,r,o){let n={[this.getNativeTokenCaip19()]:o},a=io(r,this.networkID,n),c=ao(r);return[...t,...c,...a]}appendPhantomFee(t,r){let o=r.steps.flatMap(n=>n.feeCosts).find(n=>n.name==="phantom");return o?[...t,{type:"phantom",percentage:new _(o.percentage),amountUsd:new _(0),amount:new _(0)}]:t}createSwapTransactions(t){return Qs({quote:t})}sumFees(t){return t.reduce((r,o)=>r.plus(o.amountUsd),new _(0))}};var hc=class{static{s(this,"ProcessQuoteCommandFactoryImpl")}create(t,r,o,n){let a=r.sell.data.chain.id,c=r.buy.data.chain.id,p=$t(a,c);if(x.isSolanaNetworkID(a)){let m=ug(t).connection;return p?new mc(a,this.priceClient,m):new fc(a,this.priceClient,m)}else{if(x.isEVMNetworkID(a))return p?new pc(a,t,this.priceClient,r,o):new dc(a,t,this.priceClient,r,o);if(x.isSuiNetworkID(a))return p?new gc(a,this.priceClient):new Cn(a,this.priceClient);if(x.isBitcoinNetworkID(a)&&p)return new cc(a,this.priceClient)}throw new Error(`Unsupported network ID: ${a}`)}priceClient={getPrice:s(async t=>(await si({tokens:[et(t)]}))[t],"getPrice")};isSupportedNetwork(t){return x.isSolanaNetworkID(t)||x.isEVMNetworkID(t)}},yc=class{static{s(this,"NoOpProcessQuoteCommandFactory")}create(t,r,o,n){return{processQuote:s(async(a,c)=>({quote:a,fees:{totalFees:new _(0),fees:[]}}),"processQuote")}}};u();l();u();l();u();l();var jy="CASH";u();l();var Hy=s(e=>e.reduce((t,r)=>{if(!r||r.type!==oe.SPL)return t;let o;return r.type===oe.SPL&&(o=B0(r)),o?{fees:[...t.fees,o],totalPercentFees:t.totalPercentFees+o.percentFee}:t},{fees:[],totalPercentFees:0}),"getSwapTransferFees"),B0=s(e=>{if(e.type!==oe.SPL)return;let r=(e.data.mintExtensions??[]).find(o=>o.extension===oi.transferFeeConfig);if(r)return{caip19:O(X(e)),fungibleKey:e.data.key,symbol:e.data.symbol??"",name:e.data.name??"",percentFee:r.state.newerTransferFee.transferFeeBasisPoints/100}},"getSplTransferFee");u();l();var L0=s(e=>e.isGreaterThanOrEqualTo(1)?"0,0.[00]":"0,0.[00000]","getFormatString"),_n=s(e=>{let t=_(e);return hg(e,L0(t))},"formatTokenAmountGreaterThan1");var U0=.05,M0=5,O0=.5;function hp(e,t,r,o){let{priceImpact:n,quoteSlippageTolerance:a}=Q0(e),c=t.autoSlippage?a??r.slippageTolerance:r.slippageTolerance,p={type:"slippage",slippage:c,slippageType:t.autoSlippage?ce.Auto:ce.Fixed,alert:c&&c>=M0?"highSlippage":void 0},m={type:"priceImpact",priceImpactPercentage:n.gt(0)?Sg(n.toNumber()):"-",alert:n&&n.gte(U0)?"highPriceImpact":void 0,warning:n&&n.gte(O0)?"veryHighPriceImpact":void 0},f=[yp(e,t.buy,t.sell),p,m],h=Hy([t.sell,t.buy]);return h.fees.length>0&&f.push({type:"transferFees",transferFees:h.totalPercentFees,transferTokenSymbol:t.sell.data.symbol??"",alert:"transferFees"}),o&&f.push({type:"fees",quoteFees:o}),f}s(hp,"entriesForQuote");function Q0(e){return It(e)?{priceImpact:e.priceImpact?_(e.priceImpact):_(0),quoteSlippageTolerance:e.slippageTolerance}:cr(e)?{priceImpact:e.priceImpact?_(e.priceImpact):_(0),quoteSlippageTolerance:e.slippageTolerance}:Mr(e)?{priceImpact:e.priceImpact?_(e.priceImpact):_(0),quoteSlippageTolerance:e.slippageTolerance}:{priceImpact:_(0),quoteSlippageTolerance:void 0}}s(Q0,"extractQuoteInfo");function yp(e,t,r){let{buyAmount:o,sellAmount:n}=e,a=new _(o).shiftedBy(-t.data.decimals).dividedBy(new _(n).shiftedBy(-r.data.decimals));return{type:"pricing",ratio:a,exchangeRate:`1 ${wc(r)} \u2248 ${_n(a)} ${wc(t)}`,exchangeRateFlipped:`1 ${wc(t)} \u2248 ${_n(_(1).dividedBy(a))} ${wc(r)}`}}s(yp,"parsePricing");function wc(e){return ni(e)?jy:e.data.symbol??""}s(wc,"cashDeobfuscatedSymbol");u();l();var Sc=class{static{s(this,"AsyncQueue")}queue=[];processing=!1;enqueue(t){this.queue.push(t),this.processNext()}clearQueue(){this.queue=[],this.processing=!1}async processNext(){if(this.processing||this.queue.length===0)return;this.processing=!0;let t=this.queue.shift();if(t)try{await t()}catch(r){console.error("Error processing task:",r)}this.processing=!1,this.processNext()}};u();l();var Vs=class{static{s(this,"QuoteDetails")}entries;alerts=[];warnings=[];constructor(t){this.entries=t;for(let r of t)r.alert&&this.alerts.push(r.alert),r.warning&&this.warnings.push(r.warning)}};u();l();var wp;(function(e){e.SwapperNoQuotes="SwapperNoQuotes",e.InsufficientSellAmount="InsufficientSellAmount",e.CrossChainUnavailable="CrossChainUnavailable",e.TokenNotTradable="TokenNotTradable",e.NotEnoughSuiObjects="NotEnoughSuiObjects",e.FromTokenIsHoneyPotToken="FromTokenIsHoneyPotToken",e.ToTokenIsHoneyPotToken="ToTokenIsHoneyPotToken",e.InsufficientLiquidity="InsufficientLiquidity",e.SwapInitializationFailed="SwapInitializationFailed",e.pSolHighImpactError="pSolHighImpactError"})(wp||(wp={}));var bc=class e extends Error{static{s(this,"QuoteError")}name;type;constructor(t,r,o){super(r),this.name=t,this.type=o}static fromErrorResponse(t,r){return s(n=>Object.values(wp).includes(n),"isValidType")(t)?new e(t,r,t):new e(t,r)}};var q0="swap-quotes",Tc=class{static{s(this,"QuoteProcessor")}quoteStreamer;commandFactory;state={type:"idle"};listeners=[];swapTransactionQueue=new Sc;constructor(t,r){this.quoteStreamer=t,this.commandFactory=r}start(t,r){this.setState({type:"starting",input:t,account:r}),this.quoteStreamer.subscribe(this.quoteStreamListener),this.quoteStreamer.openStream(t)}stop(){this.swapTransactionQueue.clearQueue(),this.setState({type:"idle"}),this.quoteStreamer.closeStream(),this.quoteStreamer.unsubscribe(this.quoteStreamListener)}setQuoteStreamer(t){this.stop(),this.quoteStreamer=t}quoteStreamListener={onEvent:s(t=>{switch(t.type){case"newQuoteResponse":switch(this.state.type){case"starting":let n=this.findPreferredQuote(this.state.input,t.quoteResponse);this.setState({type:"firstQuoteReceived",input:this.state.input,quote:n,response:t.quoteResponse,account:this.state.account,quoteDetails:new Vs(hp(n,this.state.input,t.quoteResponse))}),this.enqueueQuoteToProcess(this.state.input,t.quoteResponse,this.state.account);break;case"quoteProcessed":this.enqueueQuoteToProcess(this.state.input,t.quoteResponse,this.state.account,this.state.prevProcessedQuote);break}break;case"error":let r=bc.fromErrorResponse(t.errorResponse.name,t.errorResponse.message),o=new Ve({key:r.name});switch(P.addBreadcrumb(q0,JSON.stringify(r.name),Y.Info),this.state.type){case"starting":case"firstQuoteReceived":case"quoteProcessed":case"error":this.setState({type:"error",error:o,quoteError:r,account:this.state.account,input:this.state.input});break}break;case"openRequested":break;case"close":this.setState({type:"idle"});break}},"onEvent")};enqueueQuoteToProcess(t,r,o,n){this.swapTransactionQueue.enqueue(()=>this.processQuote(r,t,o,n))}async processQuote(t,r,o,n){try{let a=this.findPreferredQuote(r,t),p=await this.commandFactory.create(o,r,t,r.isSimulationKilled).processQuote(a,r.isSimulationKilled);switch(this.state.type){case"firstQuoteReceived":case"quoteProcessed":case"error":this.setState({type:"quoteProcessed",input:r,response:t,quote:a,prevProcessedQuote:n,nextProcessedQuote:p,account:o,quoteDetails:new Vs(hp(a,r,t,p.fees))});break}return p}catch(a){throw P.captureError(a,M.Swapper),a}}subscribe(t){this.listeners.push(t)}unsubscribe(t){this.listeners=this.listeners.filter(r=>r!==t)}getState(){return this.state}findPreferredQuote(t,r){let o=t.preferredProvider;return o&&r.quotes.find(n=>n.baseProvider.id===o)||r.quotes[0]}setState(t){let r=this.state;this.state=t,this.listeners.forEach(o=>o.onStateChange(r,t))}};u();l();u();l();u();l();u();l();function Dn(e){let t=e.length;for(;--t>=0;)e[t]=0}s(Dn,"zero$1");var z0=0,Rw=1,G0=2,K0=3,V0=258,zp=29,aa=256,Xs=aa+1+zp,vn=30,Gp=19,Dw=2*Xs+1,Po=15,Sp=16,j0=7,Kp=256,Nw=16,Bw=17,Lw=18,Dp=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),_c=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),H0=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),Uw=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),$0=512,zr=new Array((Xs+2)*2);Dn(zr);var Ws=new Array(vn*2);Dn(Ws);var Js=new Array($0);Dn(Js);var ea=new Array(V0-K0+1);Dn(ea);var Vp=new Array(zp);Dn(Vp);var Ic=new Array(vn);Dn(Ic);function bp(e,t,r,o,n){this.static_tree=e,this.extra_bits=t,this.extra_base=r,this.elems=o,this.max_length=n,this.has_stree=e&&e.length}s(bp,"StaticTreeDesc");var Mw,Ow,Qw;function Tp(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}s(Tp,"TreeDesc");var qw=s(e=>e<256?Js[e]:Js[256+(e>>>7)],"d_code"),ta=s((e,t)=>{e.pending_buf[e.pending++]=t&255,e.pending_buf[e.pending++]=t>>>8&255},"put_short"),Rt=s((e,t,r)=>{e.bi_valid>Sp-r?(e.bi_buf|=t<<e.bi_valid&65535,ta(e,e.bi_buf),e.bi_buf=t>>Sp-e.bi_valid,e.bi_valid+=r-Sp):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=r)},"send_bits"),kr=s((e,t,r)=>{Rt(e,r[t*2],r[t*2+1])},"send_code"),zw=s((e,t)=>{let r=0;do r|=e&1,e>>>=1,r<<=1;while(--t>0);return r>>>1},"bi_reverse"),W0=s(e=>{e.bi_valid===16?(ta(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=e.bi_buf&255,e.bi_buf>>=8,e.bi_valid-=8)},"bi_flush"),Z0=s((e,t)=>{let r=t.dyn_tree,o=t.max_code,n=t.stat_desc.static_tree,a=t.stat_desc.has_stree,c=t.stat_desc.extra_bits,p=t.stat_desc.extra_base,m=t.stat_desc.max_length,d,f,h,w,y,S,T=0;for(w=0;w<=Po;w++)e.bl_count[w]=0;for(r[e.heap[e.heap_max]*2+1]=0,d=e.heap_max+1;d<Dw;d++)f=e.heap[d],w=r[r[f*2+1]*2+1]+1,w>m&&(w=m,T++),r[f*2+1]=w,!(f>o)&&(e.bl_count[w]++,y=0,f>=p&&(y=c[f-p]),S=r[f*2],e.opt_len+=S*(w+y),a&&(e.static_len+=S*(n[f*2+1]+y)));if(T!==0){do{for(w=m-1;e.bl_count[w]===0;)w--;e.bl_count[w]--,e.bl_count[w+1]+=2,e.bl_count[m]--,T-=2}while(T>0);for(w=m;w!==0;w--)for(f=e.bl_count[w];f!==0;)h=e.heap[--d],!(h>o)&&(r[h*2+1]!==w&&(e.opt_len+=(w-r[h*2+1])*r[h*2],r[h*2+1]=w),f--)}},"gen_bitlen"),Gw=s((e,t,r)=>{let o=new Array(Po+1),n=0,a,c;for(a=1;a<=Po;a++)n=n+r[a-1]<<1,o[a]=n;for(c=0;c<=t;c++){let p=e[c*2+1];p!==0&&(e[c*2]=zw(o[p]++,p))}},"gen_codes"),Y0=s(()=>{let e,t,r,o,n,a=new Array(Po+1);for(r=0,o=0;o<zp-1;o++)for(Vp[o]=r,e=0;e<1<<Dp[o];e++)ea[r++]=o;for(ea[r-1]=o,n=0,o=0;o<16;o++)for(Ic[o]=n,e=0;e<1<<_c[o];e++)Js[n++]=o;for(n>>=7;o<vn;o++)for(Ic[o]=n<<7,e=0;e<1<<_c[o]-7;e++)Js[256+n++]=o;for(t=0;t<=Po;t++)a[t]=0;for(e=0;e<=143;)zr[e*2+1]=8,e++,a[8]++;for(;e<=255;)zr[e*2+1]=9,e++,a[9]++;for(;e<=279;)zr[e*2+1]=7,e++,a[7]++;for(;e<=287;)zr[e*2+1]=8,e++,a[8]++;for(Gw(zr,Xs+1,a),e=0;e<vn;e++)Ws[e*2+1]=5,Ws[e*2]=zw(e,5);Mw=new bp(zr,Dp,aa+1,Xs,Po),Ow=new bp(Ws,_c,0,vn,Po),Qw=new bp(new Array(0),H0,0,Gp,j0)},"tr_static_init"),Kw=s(e=>{let t;for(t=0;t<Xs;t++)e.dyn_ltree[t*2]=0;for(t=0;t<vn;t++)e.dyn_dtree[t*2]=0;for(t=0;t<Gp;t++)e.bl_tree[t*2]=0;e.dyn_ltree[Kp*2]=1,e.opt_len=e.static_len=0,e.sym_next=e.matches=0},"init_block"),Vw=s(e=>{e.bi_valid>8?ta(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0},"bi_windup"),$y=s((e,t,r,o)=>{let n=t*2,a=r*2;return e[n]<e[a]||e[n]===e[a]&&o[t]<=o[r]},"smaller"),Ap=s((e,t,r)=>{let o=e.heap[r],n=r<<1;for(;n<=e.heap_len&&(n<e.heap_len&&$y(t,e.heap[n+1],e.heap[n],e.depth)&&n++,!$y(t,o,e.heap[n],e.depth));)e.heap[r]=e.heap[n],r=n,n<<=1;e.heap[r]=o},"pqdownheap"),Wy=s((e,t,r)=>{let o,n,a=0,c,p;if(e.sym_next!==0)do o=e.pending_buf[e.sym_buf+a++]&255,o+=(e.pending_buf[e.sym_buf+a++]&255)<<8,n=e.pending_buf[e.sym_buf+a++],o===0?kr(e,n,t):(c=ea[n],kr(e,c+aa+1,t),p=Dp[c],p!==0&&(n-=Vp[c],Rt(e,n,p)),o--,c=qw(o),kr(e,c,r),p=_c[c],p!==0&&(o-=Ic[c],Rt(e,o,p)));while(a<e.sym_next);kr(e,Kp,t)},"compress_block"),Np=s((e,t)=>{let r=t.dyn_tree,o=t.stat_desc.static_tree,n=t.stat_desc.has_stree,a=t.stat_desc.elems,c,p,m=-1,d;for(e.heap_len=0,e.heap_max=Dw,c=0;c<a;c++)r[c*2]!==0?(e.heap[++e.heap_len]=m=c,e.depth[c]=0):r[c*2+1]=0;for(;e.heap_len<2;)d=e.heap[++e.heap_len]=m<2?++m:0,r[d*2]=1,e.depth[d]=0,e.opt_len--,n&&(e.static_len-=o[d*2+1]);for(t.max_code=m,c=e.heap_len>>1;c>=1;c--)Ap(e,r,c);d=a;do c=e.heap[1],e.heap[1]=e.heap[e.heap_len--],Ap(e,r,1),p=e.heap[1],e.heap[--e.heap_max]=c,e.heap[--e.heap_max]=p,r[d*2]=r[c*2]+r[p*2],e.depth[d]=(e.depth[c]>=e.depth[p]?e.depth[c]:e.depth[p])+1,r[c*2+1]=r[p*2+1]=d,e.heap[1]=d++,Ap(e,r,1);while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],Z0(e,t),Gw(r,m,e.bl_count)},"build_tree"),Zy=s((e,t,r)=>{let o,n=-1,a,c=t[0*2+1],p=0,m=7,d=4;for(c===0&&(m=138,d=3),t[(r+1)*2+1]=65535,o=0;o<=r;o++)a=c,c=t[(o+1)*2+1],!(++p<m&&a===c)&&(p<d?e.bl_tree[a*2]+=p:a!==0?(a!==n&&e.bl_tree[a*2]++,e.bl_tree[Nw*2]++):p<=10?e.bl_tree[Bw*2]++:e.bl_tree[Lw*2]++,p=0,n=a,c===0?(m=138,d=3):a===c?(m=6,d=3):(m=7,d=4))},"scan_tree"),Yy=s((e,t,r)=>{let o,n=-1,a,c=t[0*2+1],p=0,m=7,d=4;for(c===0&&(m=138,d=3),o=0;o<=r;o++)if(a=c,c=t[(o+1)*2+1],!(++p<m&&a===c)){if(p<d)do kr(e,a,e.bl_tree);while(--p!==0);else a!==0?(a!==n&&(kr(e,a,e.bl_tree),p--),kr(e,Nw,e.bl_tree),Rt(e,p-3,2)):p<=10?(kr(e,Bw,e.bl_tree),Rt(e,p-3,3)):(kr(e,Lw,e.bl_tree),Rt(e,p-11,7));p=0,n=a,c===0?(m=138,d=3):a===c?(m=6,d=3):(m=7,d=4)}},"send_tree"),X0=s(e=>{let t;for(Zy(e,e.dyn_ltree,e.l_desc.max_code),Zy(e,e.dyn_dtree,e.d_desc.max_code),Np(e,e.bl_desc),t=Gp-1;t>=3&&e.bl_tree[Uw[t]*2+1]===0;t--);return e.opt_len+=3*(t+1)+5+5+4,t},"build_bl_tree"),J0=s((e,t,r,o)=>{let n;for(Rt(e,t-257,5),Rt(e,r-1,5),Rt(e,o-4,4),n=0;n<o;n++)Rt(e,e.bl_tree[Uw[n]*2+1],3);Yy(e,e.dyn_ltree,t-1),Yy(e,e.dyn_dtree,r-1)},"send_all_trees"),e_=s(e=>{let t=4093624447,r;for(r=0;r<=31;r++,t>>>=1)if(t&1&&e.dyn_ltree[r*2]!==0)return 0;if(e.dyn_ltree[9*2]!==0||e.dyn_ltree[10*2]!==0||e.dyn_ltree[13*2]!==0)return 1;for(r=32;r<aa;r++)if(e.dyn_ltree[r*2]!==0)return 1;return 0},"detect_data_type"),Xy=!1,t_=s(e=>{Xy||(Y0(),Xy=!0),e.l_desc=new Tp(e.dyn_ltree,Mw),e.d_desc=new Tp(e.dyn_dtree,Ow),e.bl_desc=new Tp(e.bl_tree,Qw),e.bi_buf=0,e.bi_valid=0,Kw(e)},"_tr_init$1"),jw=s((e,t,r,o)=>{Rt(e,(z0<<1)+(o?1:0),3),Vw(e),ta(e,r),ta(e,~r),r&&e.pending_buf.set(e.window.subarray(t,t+r),e.pending),e.pending+=r},"_tr_stored_block$1"),r_=s(e=>{Rt(e,Rw<<1,3),kr(e,Kp,zr),W0(e)},"_tr_align$1"),o_=s((e,t,r,o)=>{let n,a,c=0;e.level>0?(e.strm.data_type===2&&(e.strm.data_type=e_(e)),Np(e,e.l_desc),Np(e,e.d_desc),c=X0(e),n=e.opt_len+3+7>>>3,a=e.static_len+3+7>>>3,a<=n&&(n=a)):n=a=r+5,r+4<=n&&t!==-1?jw(e,t,r,o):e.strategy===4||a===n?(Rt(e,(Rw<<1)+(o?1:0),3),Wy(e,zr,Ws)):(Rt(e,(G0<<1)+(o?1:0),3),J0(e,e.l_desc.max_code+1,e.d_desc.max_code+1,c+1),Wy(e,e.dyn_ltree,e.dyn_dtree)),Kw(e),o&&Vw(e)},"_tr_flush_block$1"),n_=s((e,t,r)=>(e.pending_buf[e.sym_buf+e.sym_next++]=t,e.pending_buf[e.sym_buf+e.sym_next++]=t>>8,e.pending_buf[e.sym_buf+e.sym_next++]=r,t===0?e.dyn_ltree[r*2]++:(e.matches++,t--,e.dyn_ltree[(ea[r]+aa+1)*2]++,e.dyn_dtree[qw(t)*2]++),e.sym_next===e.sym_end),"_tr_tally$1"),s_=t_,a_=jw,i_=o_,c_=n_,u_=r_,l_={_tr_init:s_,_tr_stored_block:a_,_tr_flush_block:i_,_tr_tally:c_,_tr_align:u_},p_=s((e,t,r,o)=>{let n=e&65535|0,a=e>>>16&65535|0,c=0;for(;r!==0;){c=r>2e3?2e3:r,r-=c;do n=n+t[o++]|0,a=a+n|0;while(--c);n%=65521,a%=65521}return n|a<<16|0},"adler32"),ra=p_,d_=s(()=>{let e,t=[];for(var r=0;r<256;r++){e=r;for(var o=0;o<8;o++)e=e&1?3988292384^e>>>1:e>>>1;t[r]=e}return t},"makeTable"),m_=new Uint32Array(d_()),f_=s((e,t,r,o)=>{let n=m_,a=o+r;e^=-1;for(let c=o;c<a;c++)e=e>>>8^n[(e^t[c])&255];return e^-1},"crc32"),it=f_,No={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},Uo={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8},{_tr_init:g_,_tr_stored_block:Bp,_tr_flush_block:h_,_tr_tally:po,_tr_align:y_}=l_,{Z_NO_FLUSH:mo,Z_PARTIAL_FLUSH:w_,Z_FULL_FLUSH:S_,Z_FINISH:Wt,Z_BLOCK:Jy,Z_OK:ct,Z_STREAM_END:ew,Z_STREAM_ERROR:Cr,Z_DATA_ERROR:b_,Z_BUF_ERROR:xp,Z_DEFAULT_COMPRESSION:T_,Z_FILTERED:A_,Z_HUFFMAN_ONLY:Ac,Z_RLE:x_,Z_FIXED:E_,Z_DEFAULT_STRATEGY:k_,Z_UNKNOWN:C_,Z_DEFLATED:Pc}=Uo,__=9,I_=15,F_=8,v_=29,P_=256,Lp=P_+1+v_,R_=30,D_=19,N_=2*Lp+1,B_=15,ge=3,lo=258,_r=lo+ge+1,L_=32,Pn=42,jp=57,Up=69,Mp=73,Op=91,Qp=103,Ro=113,Hs=666,Tt=1,Nn=2,Bo=3,Bn=4,U_=3,Do=s((e,t)=>(e.msg=No[t],t),"err"),tw=s(e=>e*2-(e>4?9:0),"rank"),uo=s(e=>{let t=e.length;for(;--t>=0;)e[t]=0},"zero"),M_=s(e=>{let t,r,o,n=e.w_size;t=e.hash_size,o=t;do r=e.head[--o],e.head[o]=r>=n?r-n:0;while(--t);t=n,o=t;do r=e.prev[--o],e.prev[o]=r>=n?r-n:0;while(--t)},"slide_hash"),O_=s((e,t,r)=>(t<<e.hash_shift^r)&e.hash_mask,"HASH_ZLIB"),fo=O_,qt=s(e=>{let t=e.state,r=t.pending;r>e.avail_out&&(r=e.avail_out),r!==0&&(e.output.set(t.pending_buf.subarray(t.pending_out,t.pending_out+r),e.next_out),e.next_out+=r,t.pending_out+=r,e.total_out+=r,e.avail_out-=r,t.pending-=r,t.pending===0&&(t.pending_out=0))},"flush_pending"),zt=s((e,t)=>{h_(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,qt(e.strm)},"flush_block_only"),Ae=s((e,t)=>{e.pending_buf[e.pending++]=t},"put_byte"),js=s((e,t)=>{e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=t&255},"putShortMSB"),qp=s((e,t,r,o)=>{let n=e.avail_in;return n>o&&(n=o),n===0?0:(e.avail_in-=n,t.set(e.input.subarray(e.next_in,e.next_in+n),r),e.state.wrap===1?e.adler=ra(e.adler,t,n,r):e.state.wrap===2&&(e.adler=it(e.adler,t,n,r)),e.next_in+=n,e.total_in+=n,n)},"read_buf"),Hw=s((e,t)=>{let r=e.max_chain_length,o=e.strstart,n,a,c=e.prev_length,p=e.nice_match,m=e.strstart>e.w_size-_r?e.strstart-(e.w_size-_r):0,d=e.window,f=e.w_mask,h=e.prev,w=e.strstart+lo,y=d[o+c-1],S=d[o+c];e.prev_length>=e.good_match&&(r>>=2),p>e.lookahead&&(p=e.lookahead);do if(n=t,!(d[n+c]!==S||d[n+c-1]!==y||d[n]!==d[o]||d[++n]!==d[o+1])){o+=2,n++;do;while(d[++o]===d[++n]&&d[++o]===d[++n]&&d[++o]===d[++n]&&d[++o]===d[++n]&&d[++o]===d[++n]&&d[++o]===d[++n]&&d[++o]===d[++n]&&d[++o]===d[++n]&&o<w);if(a=lo-(w-o),o=w-lo,a>c){if(e.match_start=t,c=a,a>=p)break;y=d[o+c-1],S=d[o+c]}}while((t=h[t&f])>m&&--r!==0);return c<=e.lookahead?c:e.lookahead},"longest_match"),Rn=s(e=>{let t=e.w_size,r,o,n;do{if(o=e.window_size-e.lookahead-e.strstart,e.strstart>=t+(t-_r)&&(e.window.set(e.window.subarray(t,t+t-o),0),e.match_start-=t,e.strstart-=t,e.block_start-=t,e.insert>e.strstart&&(e.insert=e.strstart),M_(e),o+=t),e.strm.avail_in===0)break;if(r=qp(e.strm,e.window,e.strstart+e.lookahead,o),e.lookahead+=r,e.lookahead+e.insert>=ge)for(n=e.strstart-e.insert,e.ins_h=e.window[n],e.ins_h=fo(e,e.ins_h,e.window[n+1]);e.insert&&(e.ins_h=fo(e,e.ins_h,e.window[n+ge-1]),e.prev[n&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=n,n++,e.insert--,!(e.lookahead+e.insert<ge)););}while(e.lookahead<_r&&e.strm.avail_in!==0)},"fill_window"),$w=s((e,t)=>{let r=e.pending_buf_size-5>e.w_size?e.w_size:e.pending_buf_size-5,o,n,a,c=0,p=e.strm.avail_in;do{if(o=65535,a=e.bi_valid+42>>3,e.strm.avail_out<a||(a=e.strm.avail_out-a,n=e.strstart-e.block_start,o>n+e.strm.avail_in&&(o=n+e.strm.avail_in),o>a&&(o=a),o<r&&(o===0&&t!==Wt||t===mo||o!==n+e.strm.avail_in)))break;c=t===Wt&&o===n+e.strm.avail_in?1:0,Bp(e,0,0,c),e.pending_buf[e.pending-4]=o,e.pending_buf[e.pending-3]=o>>8,e.pending_buf[e.pending-2]=~o,e.pending_buf[e.pending-1]=~o>>8,qt(e.strm),n&&(n>o&&(n=o),e.strm.output.set(e.window.subarray(e.block_start,e.block_start+n),e.strm.next_out),e.strm.next_out+=n,e.strm.avail_out-=n,e.strm.total_out+=n,e.block_start+=n,o-=n),o&&(qp(e.strm,e.strm.output,e.strm.next_out,o),e.strm.next_out+=o,e.strm.avail_out-=o,e.strm.total_out+=o)}while(c===0);return p-=e.strm.avail_in,p&&(p>=e.w_size?(e.matches=2,e.window.set(e.strm.input.subarray(e.strm.next_in-e.w_size,e.strm.next_in),0),e.strstart=e.w_size,e.insert=e.strstart):(e.window_size-e.strstart<=p&&(e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,e.insert>e.strstart&&(e.insert=e.strstart)),e.window.set(e.strm.input.subarray(e.strm.next_in-p,e.strm.next_in),e.strstart),e.strstart+=p,e.insert+=p>e.w_size-e.insert?e.w_size-e.insert:p),e.block_start=e.strstart),e.high_water<e.strstart&&(e.high_water=e.strstart),c?Bn:t!==mo&&t!==Wt&&e.strm.avail_in===0&&e.strstart===e.block_start?Nn:(a=e.window_size-e.strstart,e.strm.avail_in>a&&e.block_start>=e.w_size&&(e.block_start-=e.w_size,e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,a+=e.w_size,e.insert>e.strstart&&(e.insert=e.strstart)),a>e.strm.avail_in&&(a=e.strm.avail_in),a&&(qp(e.strm,e.window,e.strstart,a),e.strstart+=a,e.insert+=a>e.w_size-e.insert?e.w_size-e.insert:a),e.high_water<e.strstart&&(e.high_water=e.strstart),a=e.bi_valid+42>>3,a=e.pending_buf_size-a>65535?65535:e.pending_buf_size-a,r=a>e.w_size?e.w_size:a,n=e.strstart-e.block_start,(n>=r||(n||t===Wt)&&t!==mo&&e.strm.avail_in===0&&n<=a)&&(o=n>a?a:n,c=t===Wt&&e.strm.avail_in===0&&o===n?1:0,Bp(e,e.block_start,o,c),e.block_start+=o,qt(e.strm)),c?Bo:Tt)},"deflate_stored"),Ep=s((e,t)=>{let r,o;for(;;){if(e.lookahead<_r){if(Rn(e),e.lookahead<_r&&t===mo)return Tt;if(e.lookahead===0)break}if(r=0,e.lookahead>=ge&&(e.ins_h=fo(e,e.ins_h,e.window[e.strstart+ge-1]),r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),r!==0&&e.strstart-r<=e.w_size-_r&&(e.match_length=Hw(e,r)),e.match_length>=ge)if(o=po(e,e.strstart-e.match_start,e.match_length-ge),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=ge){e.match_length--;do e.strstart++,e.ins_h=fo(e,e.ins_h,e.window[e.strstart+ge-1]),r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart;while(--e.match_length!==0);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=fo(e,e.ins_h,e.window[e.strstart+1]);else o=po(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(o&&(zt(e,!1),e.strm.avail_out===0))return Tt}return e.insert=e.strstart<ge-1?e.strstart:ge-1,t===Wt?(zt(e,!0),e.strm.avail_out===0?Bo:Bn):e.sym_next&&(zt(e,!1),e.strm.avail_out===0)?Tt:Nn},"deflate_fast"),In=s((e,t)=>{let r,o,n;for(;;){if(e.lookahead<_r){if(Rn(e),e.lookahead<_r&&t===mo)return Tt;if(e.lookahead===0)break}if(r=0,e.lookahead>=ge&&(e.ins_h=fo(e,e.ins_h,e.window[e.strstart+ge-1]),r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=ge-1,r!==0&&e.prev_length<e.max_lazy_match&&e.strstart-r<=e.w_size-_r&&(e.match_length=Hw(e,r),e.match_length<=5&&(e.strategy===A_||e.match_length===ge&&e.strstart-e.match_start>4096)&&(e.match_length=ge-1)),e.prev_length>=ge&&e.match_length<=e.prev_length){n=e.strstart+e.lookahead-ge,o=po(e,e.strstart-1-e.prev_match,e.prev_length-ge),e.lookahead-=e.prev_length-1,e.prev_length-=2;do++e.strstart<=n&&(e.ins_h=fo(e,e.ins_h,e.window[e.strstart+ge-1]),r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart);while(--e.prev_length!==0);if(e.match_available=0,e.match_length=ge-1,e.strstart++,o&&(zt(e,!1),e.strm.avail_out===0))return Tt}else if(e.match_available){if(o=po(e,0,e.window[e.strstart-1]),o&&zt(e,!1),e.strstart++,e.lookahead--,e.strm.avail_out===0)return Tt}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(o=po(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<ge-1?e.strstart:ge-1,t===Wt?(zt(e,!0),e.strm.avail_out===0?Bo:Bn):e.sym_next&&(zt(e,!1),e.strm.avail_out===0)?Tt:Nn},"deflate_slow"),Q_=s((e,t)=>{let r,o,n,a,c=e.window;for(;;){if(e.lookahead<=lo){if(Rn(e),e.lookahead<=lo&&t===mo)return Tt;if(e.lookahead===0)break}if(e.match_length=0,e.lookahead>=ge&&e.strstart>0&&(n=e.strstart-1,o=c[n],o===c[++n]&&o===c[++n]&&o===c[++n])){a=e.strstart+lo;do;while(o===c[++n]&&o===c[++n]&&o===c[++n]&&o===c[++n]&&o===c[++n]&&o===c[++n]&&o===c[++n]&&o===c[++n]&&n<a);e.match_length=lo-(a-n),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=ge?(r=po(e,1,e.match_length-ge),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(r=po(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),r&&(zt(e,!1),e.strm.avail_out===0))return Tt}return e.insert=0,t===Wt?(zt(e,!0),e.strm.avail_out===0?Bo:Bn):e.sym_next&&(zt(e,!1),e.strm.avail_out===0)?Tt:Nn},"deflate_rle"),q_=s((e,t)=>{let r;for(;;){if(e.lookahead===0&&(Rn(e),e.lookahead===0)){if(t===mo)return Tt;break}if(e.match_length=0,r=po(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,r&&(zt(e,!1),e.strm.avail_out===0))return Tt}return e.insert=0,t===Wt?(zt(e,!0),e.strm.avail_out===0?Bo:Bn):e.sym_next&&(zt(e,!1),e.strm.avail_out===0)?Tt:Nn},"deflate_huff");function Er(e,t,r,o,n){this.good_length=e,this.max_lazy=t,this.nice_length=r,this.max_chain=o,this.func=n}s(Er,"Config");var $s=[new Er(0,0,0,0,$w),new Er(4,4,8,4,Ep),new Er(4,5,16,8,Ep),new Er(4,6,32,32,Ep),new Er(4,4,16,16,In),new Er(8,16,32,32,In),new Er(8,16,128,128,In),new Er(8,32,128,256,In),new Er(32,128,258,1024,In),new Er(32,258,258,4096,In)],z_=s(e=>{e.window_size=2*e.w_size,uo(e.head),e.max_lazy_match=$s[e.level].max_lazy,e.good_match=$s[e.level].good_length,e.nice_match=$s[e.level].nice_length,e.max_chain_length=$s[e.level].max_chain,e.strstart=0,e.block_start=0,e.lookahead=0,e.insert=0,e.match_length=e.prev_length=ge-1,e.match_available=0,e.ins_h=0},"lm_init");function G_(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=Pc,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(N_*2),this.dyn_dtree=new Uint16Array((2*R_+1)*2),this.bl_tree=new Uint16Array((2*D_+1)*2),uo(this.dyn_ltree),uo(this.dyn_dtree),uo(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(B_+1),this.heap=new Uint16Array(2*Lp+1),uo(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(2*Lp+1),uo(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}s(G_,"DeflateState");var ia=s(e=>{if(!e)return 1;let t=e.state;return!t||t.strm!==e||t.status!==Pn&&t.status!==jp&&t.status!==Up&&t.status!==Mp&&t.status!==Op&&t.status!==Qp&&t.status!==Ro&&t.status!==Hs?1:0},"deflateStateCheck"),Ww=s(e=>{if(ia(e))return Do(e,Cr);e.total_in=e.total_out=0,e.data_type=C_;let t=e.state;return t.pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap===2?jp:t.wrap?Pn:Ro,e.adler=t.wrap===2?0:1,t.last_flush=-2,g_(t),ct},"deflateResetKeep"),Zw=s(e=>{let t=Ww(e);return t===ct&&z_(e.state),t},"deflateReset"),K_=s((e,t)=>ia(e)||e.state.wrap!==2?Cr:(e.state.gzhead=t,ct),"deflateSetHeader"),Yw=s((e,t,r,o,n,a)=>{if(!e)return Cr;let c=1;if(t===T_&&(t=6),o<0?(c=0,o=-o):o>15&&(c=2,o-=16),n<1||n>__||r!==Pc||o<8||o>15||t<0||t>9||a<0||a>E_||o===8&&c!==1)return Do(e,Cr);o===8&&(o=9);let p=new G_;return e.state=p,p.strm=e,p.status=Pn,p.wrap=c,p.gzhead=null,p.w_bits=o,p.w_size=1<<p.w_bits,p.w_mask=p.w_size-1,p.hash_bits=n+7,p.hash_size=1<<p.hash_bits,p.hash_mask=p.hash_size-1,p.hash_shift=~~((p.hash_bits+ge-1)/ge),p.window=new Uint8Array(p.w_size*2),p.head=new Uint16Array(p.hash_size),p.prev=new Uint16Array(p.w_size),p.lit_bufsize=1<<n+6,p.pending_buf_size=p.lit_bufsize*4,p.pending_buf=new Uint8Array(p.pending_buf_size),p.sym_buf=p.lit_bufsize,p.sym_end=(p.lit_bufsize-1)*3,p.level=t,p.strategy=a,p.method=r,Zw(e)},"deflateInit2"),V_=s((e,t)=>Yw(e,t,Pc,I_,F_,k_),"deflateInit"),j_=s((e,t)=>{if(ia(e)||t>Jy||t<0)return e?Do(e,Cr):Cr;let r=e.state;if(!e.output||e.avail_in!==0&&!e.input||r.status===Hs&&t!==Wt)return Do(e,e.avail_out===0?xp:Cr);let o=r.last_flush;if(r.last_flush=t,r.pending!==0){if(qt(e),e.avail_out===0)return r.last_flush=-1,ct}else if(e.avail_in===0&&tw(t)<=tw(o)&&t!==Wt)return Do(e,xp);if(r.status===Hs&&e.avail_in!==0)return Do(e,xp);if(r.status===Pn&&r.wrap===0&&(r.status=Ro),r.status===Pn){let n=Pc+(r.w_bits-8<<4)<<8,a=-1;if(r.strategy>=Ac||r.level<2?a=0:r.level<6?a=1:r.level===6?a=2:a=3,n|=a<<6,r.strstart!==0&&(n|=L_),n+=31-n%31,js(r,n),r.strstart!==0&&(js(r,e.adler>>>16),js(r,e.adler&65535)),e.adler=1,r.status=Ro,qt(e),r.pending!==0)return r.last_flush=-1,ct}if(r.status===jp){if(e.adler=0,Ae(r,31),Ae(r,139),Ae(r,8),r.gzhead)Ae(r,(r.gzhead.text?1:0)+(r.gzhead.hcrc?2:0)+(r.gzhead.extra?4:0)+(r.gzhead.name?8:0)+(r.gzhead.comment?16:0)),Ae(r,r.gzhead.time&255),Ae(r,r.gzhead.time>>8&255),Ae(r,r.gzhead.time>>16&255),Ae(r,r.gzhead.time>>24&255),Ae(r,r.level===9?2:r.strategy>=Ac||r.level<2?4:0),Ae(r,r.gzhead.os&255),r.gzhead.extra&&r.gzhead.extra.length&&(Ae(r,r.gzhead.extra.length&255),Ae(r,r.gzhead.extra.length>>8&255)),r.gzhead.hcrc&&(e.adler=it(e.adler,r.pending_buf,r.pending,0)),r.gzindex=0,r.status=Up;else if(Ae(r,0),Ae(r,0),Ae(r,0),Ae(r,0),Ae(r,0),Ae(r,r.level===9?2:r.strategy>=Ac||r.level<2?4:0),Ae(r,U_),r.status=Ro,qt(e),r.pending!==0)return r.last_flush=-1,ct}if(r.status===Up){if(r.gzhead.extra){let n=r.pending,a=(r.gzhead.extra.length&65535)-r.gzindex;for(;r.pending+a>r.pending_buf_size;){let p=r.pending_buf_size-r.pending;if(r.pending_buf.set(r.gzhead.extra.subarray(r.gzindex,r.gzindex+p),r.pending),r.pending=r.pending_buf_size,r.gzhead.hcrc&&r.pending>n&&(e.adler=it(e.adler,r.pending_buf,r.pending-n,n)),r.gzindex+=p,qt(e),r.pending!==0)return r.last_flush=-1,ct;n=0,a-=p}let c=new Uint8Array(r.gzhead.extra);r.pending_buf.set(c.subarray(r.gzindex,r.gzindex+a),r.pending),r.pending+=a,r.gzhead.hcrc&&r.pending>n&&(e.adler=it(e.adler,r.pending_buf,r.pending-n,n)),r.gzindex=0}r.status=Mp}if(r.status===Mp){if(r.gzhead.name){let n=r.pending,a;do{if(r.pending===r.pending_buf_size){if(r.gzhead.hcrc&&r.pending>n&&(e.adler=it(e.adler,r.pending_buf,r.pending-n,n)),qt(e),r.pending!==0)return r.last_flush=-1,ct;n=0}r.gzindex<r.gzhead.name.length?a=r.gzhead.name.charCodeAt(r.gzindex++)&255:a=0,Ae(r,a)}while(a!==0);r.gzhead.hcrc&&r.pending>n&&(e.adler=it(e.adler,r.pending_buf,r.pending-n,n)),r.gzindex=0}r.status=Op}if(r.status===Op){if(r.gzhead.comment){let n=r.pending,a;do{if(r.pending===r.pending_buf_size){if(r.gzhead.hcrc&&r.pending>n&&(e.adler=it(e.adler,r.pending_buf,r.pending-n,n)),qt(e),r.pending!==0)return r.last_flush=-1,ct;n=0}r.gzindex<r.gzhead.comment.length?a=r.gzhead.comment.charCodeAt(r.gzindex++)&255:a=0,Ae(r,a)}while(a!==0);r.gzhead.hcrc&&r.pending>n&&(e.adler=it(e.adler,r.pending_buf,r.pending-n,n))}r.status=Qp}if(r.status===Qp){if(r.gzhead.hcrc){if(r.pending+2>r.pending_buf_size&&(qt(e),r.pending!==0))return r.last_flush=-1,ct;Ae(r,e.adler&255),Ae(r,e.adler>>8&255),e.adler=0}if(r.status=Ro,qt(e),r.pending!==0)return r.last_flush=-1,ct}if(e.avail_in!==0||r.lookahead!==0||t!==mo&&r.status!==Hs){let n=r.level===0?$w(r,t):r.strategy===Ac?q_(r,t):r.strategy===x_?Q_(r,t):$s[r.level].func(r,t);if((n===Bo||n===Bn)&&(r.status=Hs),n===Tt||n===Bo)return e.avail_out===0&&(r.last_flush=-1),ct;if(n===Nn&&(t===w_?y_(r):t!==Jy&&(Bp(r,0,0,!1),t===S_&&(uo(r.head),r.lookahead===0&&(r.strstart=0,r.block_start=0,r.insert=0))),qt(e),e.avail_out===0))return r.last_flush=-1,ct}return t!==Wt?ct:r.wrap<=0?ew:(r.wrap===2?(Ae(r,e.adler&255),Ae(r,e.adler>>8&255),Ae(r,e.adler>>16&255),Ae(r,e.adler>>24&255),Ae(r,e.total_in&255),Ae(r,e.total_in>>8&255),Ae(r,e.total_in>>16&255),Ae(r,e.total_in>>24&255)):(js(r,e.adler>>>16),js(r,e.adler&65535)),qt(e),r.wrap>0&&(r.wrap=-r.wrap),r.pending!==0?ct:ew)},"deflate$2"),H_=s(e=>{if(ia(e))return Cr;let t=e.state.status;return e.state=null,t===Ro?Do(e,b_):ct},"deflateEnd"),$_=s((e,t)=>{let r=t.length;if(ia(e))return Cr;let o=e.state,n=o.wrap;if(n===2||n===1&&o.status!==Pn||o.lookahead)return Cr;if(n===1&&(e.adler=ra(e.adler,t,r,0)),o.wrap=0,r>=o.w_size){n===0&&(uo(o.head),o.strstart=0,o.block_start=0,o.insert=0);let m=new Uint8Array(o.w_size);m.set(t.subarray(r-o.w_size,r),0),t=m,r=o.w_size}let a=e.avail_in,c=e.next_in,p=e.input;for(e.avail_in=r,e.next_in=0,e.input=t,Rn(o);o.lookahead>=ge;){let m=o.strstart,d=o.lookahead-(ge-1);do o.ins_h=fo(o,o.ins_h,o.window[m+ge-1]),o.prev[m&o.w_mask]=o.head[o.ins_h],o.head[o.ins_h]=m,m++;while(--d);o.strstart=m,o.lookahead=ge-1,Rn(o)}return o.strstart+=o.lookahead,o.block_start=o.strstart,o.insert=o.lookahead,o.lookahead=0,o.match_length=o.prev_length=ge-1,o.match_available=0,e.next_in=c,e.input=p,e.avail_in=a,o.wrap=n,ct},"deflateSetDictionary"),W_=V_,Z_=Yw,Y_=Zw,X_=Ww,J_=K_,eI=j_,tI=H_,rI=$_,oI="pako deflate (from Nodeca project)",Zs={deflateInit:W_,deflateInit2:Z_,deflateReset:Y_,deflateResetKeep:X_,deflateSetHeader:J_,deflate:eI,deflateEnd:tI,deflateSetDictionary:rI,deflateInfo:oI},nI=s((e,t)=>Object.prototype.hasOwnProperty.call(e,t),"_has"),sI=s(function(e){let t=Array.prototype.slice.call(arguments,1);for(;t.length;){let r=t.shift();if(r){if(typeof r!="object")throw new TypeError(r+"must be non-object");for(let o in r)nI(r,o)&&(e[o]=r[o])}}return e},"assign"),aI=s(e=>{let t=0;for(let o=0,n=e.length;o<n;o++)t+=e[o].length;let r=new Uint8Array(t);for(let o=0,n=0,a=e.length;o<a;o++){let c=e[o];r.set(c,n),n+=c.length}return r},"flattenChunks"),Rc={assign:sI,flattenChunks:aI},Xw=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{Xw=!1}var oa=new Uint8Array(256);for(let e=0;e<256;e++)oa[e]=e>=252?6:e>=248?5:e>=240?4:e>=224?3:e>=192?2:1;oa[254]=oa[254]=1;var iI=s(e=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(e);let t,r,o,n,a,c=e.length,p=0;for(n=0;n<c;n++)r=e.charCodeAt(n),(r&64512)===55296&&n+1<c&&(o=e.charCodeAt(n+1),(o&64512)===56320&&(r=65536+(r-55296<<10)+(o-56320),n++)),p+=r<128?1:r<2048?2:r<65536?3:4;for(t=new Uint8Array(p),a=0,n=0;a<p;n++)r=e.charCodeAt(n),(r&64512)===55296&&n+1<c&&(o=e.charCodeAt(n+1),(o&64512)===56320&&(r=65536+(r-55296<<10)+(o-56320),n++)),r<128?t[a++]=r:r<2048?(t[a++]=192|r>>>6,t[a++]=128|r&63):r<65536?(t[a++]=224|r>>>12,t[a++]=128|r>>>6&63,t[a++]=128|r&63):(t[a++]=240|r>>>18,t[a++]=128|r>>>12&63,t[a++]=128|r>>>6&63,t[a++]=128|r&63);return t},"string2buf"),cI=s((e,t)=>{if(t<65534&&e.subarray&&Xw)return String.fromCharCode.apply(null,e.length===t?e:e.subarray(0,t));let r="";for(let o=0;o<t;o++)r+=String.fromCharCode(e[o]);return r},"buf2binstring"),uI=s((e,t)=>{let r=t||e.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(e.subarray(0,t));let o,n,a=new Array(r*2);for(n=0,o=0;o<r;){let c=e[o++];if(c<128){a[n++]=c;continue}let p=oa[c];if(p>4){a[n++]=65533,o+=p-1;continue}for(c&=p===2?31:p===3?15:7;p>1&&o<r;)c=c<<6|e[o++]&63,p--;if(p>1){a[n++]=65533;continue}c<65536?a[n++]=c:(c-=65536,a[n++]=55296|c>>10&1023,a[n++]=56320|c&1023)}return cI(a,n)},"buf2string"),lI=s((e,t)=>{t=t||e.length,t>e.length&&(t=e.length);let r=t-1;for(;r>=0&&(e[r]&192)===128;)r--;return r<0||r===0?t:r+oa[e[r]]>t?r:t},"utf8border"),na={string2buf:iI,buf2string:uI,utf8border:lI};function pI(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}s(pI,"ZStream");var Jw=pI,eS=Object.prototype.toString,{Z_NO_FLUSH:dI,Z_SYNC_FLUSH:mI,Z_FULL_FLUSH:fI,Z_FINISH:gI,Z_OK:Fc,Z_STREAM_END:hI,Z_DEFAULT_COMPRESSION:yI,Z_DEFAULT_STRATEGY:wI,Z_DEFLATED:SI}=Uo;function ca(e){this.options=Rc.assign({level:yI,method:SI,chunkSize:16384,windowBits:15,memLevel:8,strategy:wI},e||{});let t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Jw,this.strm.avail_out=0;let r=Zs.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(r!==Fc)throw new Error(No[r]);if(t.header&&Zs.deflateSetHeader(this.strm,t.header),t.dictionary){let o;if(typeof t.dictionary=="string"?o=na.string2buf(t.dictionary):eS.call(t.dictionary)==="[object ArrayBuffer]"?o=new Uint8Array(t.dictionary):o=t.dictionary,r=Zs.deflateSetDictionary(this.strm,o),r!==Fc)throw new Error(No[r]);this._dict_set=!0}}s(ca,"Deflate$1");ca.prototype.push=function(e,t){let r=this.strm,o=this.options.chunkSize,n,a;if(this.ended)return!1;for(t===~~t?a=t:a=t===!0?gI:dI,typeof e=="string"?r.input=na.string2buf(e):eS.call(e)==="[object ArrayBuffer]"?r.input=new Uint8Array(e):r.input=e,r.next_in=0,r.avail_in=r.input.length;;){if(r.avail_out===0&&(r.output=new Uint8Array(o),r.next_out=0,r.avail_out=o),(a===mI||a===fI)&&r.avail_out<=6){this.onData(r.output.subarray(0,r.next_out)),r.avail_out=0;continue}if(n=Zs.deflate(r,a),n===hI)return r.next_out>0&&this.onData(r.output.subarray(0,r.next_out)),n=Zs.deflateEnd(this.strm),this.onEnd(n),this.ended=!0,n===Fc;if(r.avail_out===0){this.onData(r.output);continue}if(a>0&&r.next_out>0){this.onData(r.output.subarray(0,r.next_out)),r.avail_out=0;continue}if(r.avail_in===0)break}return!0};ca.prototype.onData=function(e){this.chunks.push(e)};ca.prototype.onEnd=function(e){e===Fc&&(this.result=Rc.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};function Hp(e,t){let r=new ca(t);if(r.push(e,!0),r.err)throw r.msg||No[r.err];return r.result}s(Hp,"deflate$1");function bI(e,t){return t=t||{},t.raw=!0,Hp(e,t)}s(bI,"deflateRaw$1");function TI(e,t){return t=t||{},t.gzip=!0,Hp(e,t)}s(TI,"gzip$1");var AI=ca,xI=Hp,EI=bI,kI=TI,CI=Uo,_I={Deflate:AI,deflate:xI,deflateRaw:EI,gzip:kI,constants:CI},xc=16209,II=16191,FI=s(function(t,r){let o,n,a,c,p,m,d,f,h,w,y,S,T,b,A,E,C,I,N,Q,R,H,q,k,F=t.state;o=t.next_in,q=t.input,n=o+(t.avail_in-5),a=t.next_out,k=t.output,c=a-(r-t.avail_out),p=a+(t.avail_out-257),m=F.dmax,d=F.wsize,f=F.whave,h=F.wnext,w=F.window,y=F.hold,S=F.bits,T=F.lencode,b=F.distcode,A=(1<<F.lenbits)-1,E=(1<<F.distbits)-1;e:do{S<15&&(y+=q[o++]<<S,S+=8,y+=q[o++]<<S,S+=8),C=T[y&A];t:for(;;){if(I=C>>>24,y>>>=I,S-=I,I=C>>>16&255,I===0)k[a++]=C&65535;else if(I&16){N=C&65535,I&=15,I&&(S<I&&(y+=q[o++]<<S,S+=8),N+=y&(1<<I)-1,y>>>=I,S-=I),S<15&&(y+=q[o++]<<S,S+=8,y+=q[o++]<<S,S+=8),C=b[y&E];r:for(;;){if(I=C>>>24,y>>>=I,S-=I,I=C>>>16&255,I&16){if(Q=C&65535,I&=15,S<I&&(y+=q[o++]<<S,S+=8,S<I&&(y+=q[o++]<<S,S+=8)),Q+=y&(1<<I)-1,Q>m){t.msg="invalid distance too far back",F.mode=xc;break e}if(y>>>=I,S-=I,I=a-c,Q>I){if(I=Q-I,I>f&&F.sane){t.msg="invalid distance too far back",F.mode=xc;break e}if(R=0,H=w,h===0){if(R+=d-I,I<N){N-=I;do k[a++]=w[R++];while(--I);R=a-Q,H=k}}else if(h<I){if(R+=d+h-I,I-=h,I<N){N-=I;do k[a++]=w[R++];while(--I);if(R=0,h<N){I=h,N-=I;do k[a++]=w[R++];while(--I);R=a-Q,H=k}}}else if(R+=h-I,I<N){N-=I;do k[a++]=w[R++];while(--I);R=a-Q,H=k}for(;N>2;)k[a++]=H[R++],k[a++]=H[R++],k[a++]=H[R++],N-=3;N&&(k[a++]=H[R++],N>1&&(k[a++]=H[R++]))}else{R=a-Q;do k[a++]=k[R++],k[a++]=k[R++],k[a++]=k[R++],N-=3;while(N>2);N&&(k[a++]=k[R++],N>1&&(k[a++]=k[R++]))}}else if(I&64){t.msg="invalid distance code",F.mode=xc;break e}else{C=b[(C&65535)+(y&(1<<I)-1)];continue r}break}}else if(I&64)if(I&32){F.mode=II;break e}else{t.msg="invalid literal/length code",F.mode=xc;break e}else{C=T[(C&65535)+(y&(1<<I)-1)];continue t}break}}while(o<n&&a<p);N=S>>3,o-=N,S-=N<<3,y&=(1<<S)-1,t.next_in=o,t.next_out=a,t.avail_in=o<n?5+(n-o):5-(o-n),t.avail_out=a<p?257+(p-a):257-(a-p),F.hold=y,F.bits=S},"inflate_fast"),Fn=15,rw=852,ow=592,nw=0,kp=1,sw=2,vI=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),PI=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),RI=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),DI=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),NI=s((e,t,r,o,n,a,c,p)=>{let m=p.bits,d=0,f=0,h=0,w=0,y=0,S=0,T=0,b=0,A=0,E=0,C,I,N,Q,R,H=null,q,k=new Uint16Array(Fn+1),F=new Uint16Array(Fn+1),G=null,W,re,Z;for(d=0;d<=Fn;d++)k[d]=0;for(f=0;f<o;f++)k[t[r+f]]++;for(y=m,w=Fn;w>=1&&k[w]===0;w--);if(y>w&&(y=w),w===0)return n[a++]=1<<24|64<<16|0,n[a++]=1<<24|64<<16|0,p.bits=1,0;for(h=1;h<w&&k[h]===0;h++);for(y<h&&(y=h),b=1,d=1;d<=Fn;d++)if(b<<=1,b-=k[d],b<0)return-1;if(b>0&&(e===nw||w!==1))return-1;for(F[1]=0,d=1;d<Fn;d++)F[d+1]=F[d]+k[d];for(f=0;f<o;f++)t[r+f]!==0&&(c[F[t[r+f]]++]=f);if(e===nw?(H=G=c,q=20):e===kp?(H=vI,G=PI,q=257):(H=RI,G=DI,q=0),E=0,f=0,d=h,R=a,S=y,T=0,N=-1,A=1<<y,Q=A-1,e===kp&&A>rw||e===sw&&A>ow)return 1;for(;;){W=d-T,c[f]+1<q?(re=0,Z=c[f]):c[f]>=q?(re=G[c[f]-q],Z=H[c[f]-q]):(re=96,Z=0),C=1<<d-T,I=1<<S,h=I;do I-=C,n[R+(E>>T)+I]=W<<24|re<<16|Z|0;while(I!==0);for(C=1<<d-1;E&C;)C>>=1;if(C!==0?(E&=C-1,E+=C):E=0,f++,--k[d]===0){if(d===w)break;d=t[r+c[f]]}if(d>y&&(E&Q)!==N){for(T===0&&(T=y),R+=h,S=d-T,b=1<<S;S+T<w&&(b-=k[S+T],!(b<=0));)S++,b<<=1;if(A+=1<<S,e===kp&&A>rw||e===sw&&A>ow)return 1;N=E&Q,n[N]=y<<24|S<<16|R-a|0}}return E!==0&&(n[R+E]=d-T<<24|64<<16|0),p.bits=y,0},"inflate_table"),Ys=NI,BI=0,tS=1,rS=2,{Z_FINISH:aw,Z_BLOCK:LI,Z_TREES:Ec,Z_OK:Lo,Z_STREAM_END:UI,Z_NEED_DICT:MI,Z_STREAM_ERROR:Zt,Z_DATA_ERROR:oS,Z_MEM_ERROR:nS,Z_BUF_ERROR:OI,Z_DEFLATED:iw}=Uo,Dc=16180,cw=16181,uw=16182,lw=16183,pw=16184,dw=16185,mw=16186,fw=16187,gw=16188,hw=16189,vc=16190,qr=16191,Cp=16192,yw=16193,_p=16194,ww=16195,Sw=16196,bw=16197,Tw=16198,kc=16199,Cc=16200,Aw=16201,xw=16202,Ew=16203,kw=16204,Cw=16205,Ip=16206,_w=16207,Iw=16208,Be=16209,sS=16210,aS=16211,QI=852,qI=592,zI=15,GI=zI,Fw=s(e=>(e>>>24&255)+(e>>>8&65280)+((e&65280)<<8)+((e&255)<<24),"zswap32");function KI(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}s(KI,"InflateState");var Mo=s(e=>{if(!e)return 1;let t=e.state;return!t||t.strm!==e||t.mode<Dc||t.mode>aS?1:0},"inflateStateCheck"),iS=s(e=>{if(Mo(e))return Zt;let t=e.state;return e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=t.wrap&1),t.mode=Dc,t.last=0,t.havedict=0,t.flags=-1,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Int32Array(QI),t.distcode=t.distdyn=new Int32Array(qI),t.sane=1,t.back=-1,Lo},"inflateResetKeep"),cS=s(e=>{if(Mo(e))return Zt;let t=e.state;return t.wsize=0,t.whave=0,t.wnext=0,iS(e)},"inflateReset"),uS=s((e,t)=>{let r;if(Mo(e))return Zt;let o=e.state;return t<0?(r=0,t=-t):(r=(t>>4)+5,t<48&&(t&=15)),t&&(t<8||t>15)?Zt:(o.window!==null&&o.wbits!==t&&(o.window=null),o.wrap=r,o.wbits=t,cS(e))},"inflateReset2"),lS=s((e,t)=>{if(!e)return Zt;let r=new KI;e.state=r,r.strm=e,r.window=null,r.mode=Dc;let o=uS(e,t);return o!==Lo&&(e.state=null),o},"inflateInit2"),VI=s(e=>lS(e,GI),"inflateInit"),vw=!0,Fp,vp,jI=s(e=>{if(vw){Fp=new Int32Array(512),vp=new Int32Array(32);let t=0;for(;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(Ys(tS,e.lens,0,288,Fp,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;Ys(rS,e.lens,0,32,vp,0,e.work,{bits:5}),vw=!1}e.lencode=Fp,e.lenbits=9,e.distcode=vp,e.distbits=5},"fixedtables"),pS=s((e,t,r,o)=>{let n,a=e.state;return a.window===null&&(a.wsize=1<<a.wbits,a.wnext=0,a.whave=0,a.window=new Uint8Array(a.wsize)),o>=a.wsize?(a.window.set(t.subarray(r-a.wsize,r),0),a.wnext=0,a.whave=a.wsize):(n=a.wsize-a.wnext,n>o&&(n=o),a.window.set(t.subarray(r-o,r-o+n),a.wnext),o-=n,o?(a.window.set(t.subarray(r-o,r),0),a.wnext=o,a.whave=a.wsize):(a.wnext+=n,a.wnext===a.wsize&&(a.wnext=0),a.whave<a.wsize&&(a.whave+=n))),0},"updatewindow"),HI=s((e,t)=>{let r,o,n,a,c,p,m,d,f,h,w,y,S,T,b=0,A,E,C,I,N,Q,R,H,q=new Uint8Array(4),k,F,G=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(Mo(e)||!e.output||!e.input&&e.avail_in!==0)return Zt;r=e.state,r.mode===qr&&(r.mode=Cp),c=e.next_out,n=e.output,m=e.avail_out,a=e.next_in,o=e.input,p=e.avail_in,d=r.hold,f=r.bits,h=p,w=m,H=Lo;e:for(;;)switch(r.mode){case Dc:if(r.wrap===0){r.mode=Cp;break}for(;f<16;){if(p===0)break e;p--,d+=o[a++]<<f,f+=8}if(r.wrap&2&&d===35615){r.wbits===0&&(r.wbits=15),r.check=0,q[0]=d&255,q[1]=d>>>8&255,r.check=it(r.check,q,2,0),d=0,f=0,r.mode=cw;break}if(r.head&&(r.head.done=!1),!(r.wrap&1)||(((d&255)<<8)+(d>>8))%31){e.msg="incorrect header check",r.mode=Be;break}if((d&15)!==iw){e.msg="unknown compression method",r.mode=Be;break}if(d>>>=4,f-=4,R=(d&15)+8,r.wbits===0&&(r.wbits=R),R>15||R>r.wbits){e.msg="invalid window size",r.mode=Be;break}r.dmax=1<<r.wbits,r.flags=0,e.adler=r.check=1,r.mode=d&512?hw:qr,d=0,f=0;break;case cw:for(;f<16;){if(p===0)break e;p--,d+=o[a++]<<f,f+=8}if(r.flags=d,(r.flags&255)!==iw){e.msg="unknown compression method",r.mode=Be;break}if(r.flags&57344){e.msg="unknown header flags set",r.mode=Be;break}r.head&&(r.head.text=d>>8&1),r.flags&512&&r.wrap&4&&(q[0]=d&255,q[1]=d>>>8&255,r.check=it(r.check,q,2,0)),d=0,f=0,r.mode=uw;case uw:for(;f<32;){if(p===0)break e;p--,d+=o[a++]<<f,f+=8}r.head&&(r.head.time=d),r.flags&512&&r.wrap&4&&(q[0]=d&255,q[1]=d>>>8&255,q[2]=d>>>16&255,q[3]=d>>>24&255,r.check=it(r.check,q,4,0)),d=0,f=0,r.mode=lw;case lw:for(;f<16;){if(p===0)break e;p--,d+=o[a++]<<f,f+=8}r.head&&(r.head.xflags=d&255,r.head.os=d>>8),r.flags&512&&r.wrap&4&&(q[0]=d&255,q[1]=d>>>8&255,r.check=it(r.check,q,2,0)),d=0,f=0,r.mode=pw;case pw:if(r.flags&1024){for(;f<16;){if(p===0)break e;p--,d+=o[a++]<<f,f+=8}r.length=d,r.head&&(r.head.extra_len=d),r.flags&512&&r.wrap&4&&(q[0]=d&255,q[1]=d>>>8&255,r.check=it(r.check,q,2,0)),d=0,f=0}else r.head&&(r.head.extra=null);r.mode=dw;case dw:if(r.flags&1024&&(y=r.length,y>p&&(y=p),y&&(r.head&&(R=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Uint8Array(r.head.extra_len)),r.head.extra.set(o.subarray(a,a+y),R)),r.flags&512&&r.wrap&4&&(r.check=it(r.check,o,y,a)),p-=y,a+=y,r.length-=y),r.length))break e;r.length=0,r.mode=mw;case mw:if(r.flags&2048){if(p===0)break e;y=0;do R=o[a+y++],r.head&&R&&r.length<65536&&(r.head.name+=String.fromCharCode(R));while(R&&y<p);if(r.flags&512&&r.wrap&4&&(r.check=it(r.check,o,y,a)),p-=y,a+=y,R)break e}else r.head&&(r.head.name=null);r.length=0,r.mode=fw;case fw:if(r.flags&4096){if(p===0)break e;y=0;do R=o[a+y++],r.head&&R&&r.length<65536&&(r.head.comment+=String.fromCharCode(R));while(R&&y<p);if(r.flags&512&&r.wrap&4&&(r.check=it(r.check,o,y,a)),p-=y,a+=y,R)break e}else r.head&&(r.head.comment=null);r.mode=gw;case gw:if(r.flags&512){for(;f<16;){if(p===0)break e;p--,d+=o[a++]<<f,f+=8}if(r.wrap&4&&d!==(r.check&65535)){e.msg="header crc mismatch",r.mode=Be;break}d=0,f=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),e.adler=r.check=0,r.mode=qr;break;case hw:for(;f<32;){if(p===0)break e;p--,d+=o[a++]<<f,f+=8}e.adler=r.check=Fw(d),d=0,f=0,r.mode=vc;case vc:if(r.havedict===0)return e.next_out=c,e.avail_out=m,e.next_in=a,e.avail_in=p,r.hold=d,r.bits=f,MI;e.adler=r.check=1,r.mode=qr;case qr:if(t===LI||t===Ec)break e;case Cp:if(r.last){d>>>=f&7,f-=f&7,r.mode=Ip;break}for(;f<3;){if(p===0)break e;p--,d+=o[a++]<<f,f+=8}switch(r.last=d&1,d>>>=1,f-=1,d&3){case 0:r.mode=yw;break;case 1:if(jI(r),r.mode=kc,t===Ec){d>>>=2,f-=2;break e}break;case 2:r.mode=Sw;break;case 3:e.msg="invalid block type",r.mode=Be}d>>>=2,f-=2;break;case yw:for(d>>>=f&7,f-=f&7;f<32;){if(p===0)break e;p--,d+=o[a++]<<f,f+=8}if((d&65535)!==(d>>>16^65535)){e.msg="invalid stored block lengths",r.mode=Be;break}if(r.length=d&65535,d=0,f=0,r.mode=_p,t===Ec)break e;case _p:r.mode=ww;case ww:if(y=r.length,y){if(y>p&&(y=p),y>m&&(y=m),y===0)break e;n.set(o.subarray(a,a+y),c),p-=y,a+=y,m-=y,c+=y,r.length-=y;break}r.mode=qr;break;case Sw:for(;f<14;){if(p===0)break e;p--,d+=o[a++]<<f,f+=8}if(r.nlen=(d&31)+257,d>>>=5,f-=5,r.ndist=(d&31)+1,d>>>=5,f-=5,r.ncode=(d&15)+4,d>>>=4,f-=4,r.nlen>286||r.ndist>30){e.msg="too many length or distance symbols",r.mode=Be;break}r.have=0,r.mode=bw;case bw:for(;r.have<r.ncode;){for(;f<3;){if(p===0)break e;p--,d+=o[a++]<<f,f+=8}r.lens[G[r.have++]]=d&7,d>>>=3,f-=3}for(;r.have<19;)r.lens[G[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,k={bits:r.lenbits},H=Ys(BI,r.lens,0,19,r.lencode,0,r.work,k),r.lenbits=k.bits,H){e.msg="invalid code lengths set",r.mode=Be;break}r.have=0,r.mode=Tw;case Tw:for(;r.have<r.nlen+r.ndist;){for(;b=r.lencode[d&(1<<r.lenbits)-1],A=b>>>24,E=b>>>16&255,C=b&65535,!(A<=f);){if(p===0)break e;p--,d+=o[a++]<<f,f+=8}if(C<16)d>>>=A,f-=A,r.lens[r.have++]=C;else{if(C===16){for(F=A+2;f<F;){if(p===0)break e;p--,d+=o[a++]<<f,f+=8}if(d>>>=A,f-=A,r.have===0){e.msg="invalid bit length repeat",r.mode=Be;break}R=r.lens[r.have-1],y=3+(d&3),d>>>=2,f-=2}else if(C===17){for(F=A+3;f<F;){if(p===0)break e;p--,d+=o[a++]<<f,f+=8}d>>>=A,f-=A,R=0,y=3+(d&7),d>>>=3,f-=3}else{for(F=A+7;f<F;){if(p===0)break e;p--,d+=o[a++]<<f,f+=8}d>>>=A,f-=A,R=0,y=11+(d&127),d>>>=7,f-=7}if(r.have+y>r.nlen+r.ndist){e.msg="invalid bit length repeat",r.mode=Be;break}for(;y--;)r.lens[r.have++]=R}}if(r.mode===Be)break;if(r.lens[256]===0){e.msg="invalid code -- missing end-of-block",r.mode=Be;break}if(r.lenbits=9,k={bits:r.lenbits},H=Ys(tS,r.lens,0,r.nlen,r.lencode,0,r.work,k),r.lenbits=k.bits,H){e.msg="invalid literal/lengths set",r.mode=Be;break}if(r.distbits=6,r.distcode=r.distdyn,k={bits:r.distbits},H=Ys(rS,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,k),r.distbits=k.bits,H){e.msg="invalid distances set",r.mode=Be;break}if(r.mode=kc,t===Ec)break e;case kc:r.mode=Cc;case Cc:if(p>=6&&m>=258){e.next_out=c,e.avail_out=m,e.next_in=a,e.avail_in=p,r.hold=d,r.bits=f,FI(e,w),c=e.next_out,n=e.output,m=e.avail_out,a=e.next_in,o=e.input,p=e.avail_in,d=r.hold,f=r.bits,r.mode===qr&&(r.back=-1);break}for(r.back=0;b=r.lencode[d&(1<<r.lenbits)-1],A=b>>>24,E=b>>>16&255,C=b&65535,!(A<=f);){if(p===0)break e;p--,d+=o[a++]<<f,f+=8}if(E&&!(E&240)){for(I=A,N=E,Q=C;b=r.lencode[Q+((d&(1<<I+N)-1)>>I)],A=b>>>24,E=b>>>16&255,C=b&65535,!(I+A<=f);){if(p===0)break e;p--,d+=o[a++]<<f,f+=8}d>>>=I,f-=I,r.back+=I}if(d>>>=A,f-=A,r.back+=A,r.length=C,E===0){r.mode=Cw;break}if(E&32){r.back=-1,r.mode=qr;break}if(E&64){e.msg="invalid literal/length code",r.mode=Be;break}r.extra=E&15,r.mode=Aw;case Aw:if(r.extra){for(F=r.extra;f<F;){if(p===0)break e;p--,d+=o[a++]<<f,f+=8}r.length+=d&(1<<r.extra)-1,d>>>=r.extra,f-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=xw;case xw:for(;b=r.distcode[d&(1<<r.distbits)-1],A=b>>>24,E=b>>>16&255,C=b&65535,!(A<=f);){if(p===0)break e;p--,d+=o[a++]<<f,f+=8}if(!(E&240)){for(I=A,N=E,Q=C;b=r.distcode[Q+((d&(1<<I+N)-1)>>I)],A=b>>>24,E=b>>>16&255,C=b&65535,!(I+A<=f);){if(p===0)break e;p--,d+=o[a++]<<f,f+=8}d>>>=I,f-=I,r.back+=I}if(d>>>=A,f-=A,r.back+=A,E&64){e.msg="invalid distance code",r.mode=Be;break}r.offset=C,r.extra=E&15,r.mode=Ew;case Ew:if(r.extra){for(F=r.extra;f<F;){if(p===0)break e;p--,d+=o[a++]<<f,f+=8}r.offset+=d&(1<<r.extra)-1,d>>>=r.extra,f-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){e.msg="invalid distance too far back",r.mode=Be;break}r.mode=kw;case kw:if(m===0)break e;if(y=w-m,r.offset>y){if(y=r.offset-y,y>r.whave&&r.sane){e.msg="invalid distance too far back",r.mode=Be;break}y>r.wnext?(y-=r.wnext,S=r.wsize-y):S=r.wnext-y,y>r.length&&(y=r.length),T=r.window}else T=n,S=c-r.offset,y=r.length;y>m&&(y=m),m-=y,r.length-=y;do n[c++]=T[S++];while(--y);r.length===0&&(r.mode=Cc);break;case Cw:if(m===0)break e;n[c++]=r.length,m--,r.mode=Cc;break;case Ip:if(r.wrap){for(;f<32;){if(p===0)break e;p--,d|=o[a++]<<f,f+=8}if(w-=m,e.total_out+=w,r.total+=w,r.wrap&4&&w&&(e.adler=r.check=r.flags?it(r.check,n,w,c-w):ra(r.check,n,w,c-w)),w=m,r.wrap&4&&(r.flags?d:Fw(d))!==r.check){e.msg="incorrect data check",r.mode=Be;break}d=0,f=0}r.mode=_w;case _w:if(r.wrap&&r.flags){for(;f<32;){if(p===0)break e;p--,d+=o[a++]<<f,f+=8}if(r.wrap&4&&d!==(r.total&4294967295)){e.msg="incorrect length check",r.mode=Be;break}d=0,f=0}r.mode=Iw;case Iw:H=UI;break e;case Be:H=oS;break e;case sS:return nS;case aS:default:return Zt}return e.next_out=c,e.avail_out=m,e.next_in=a,e.avail_in=p,r.hold=d,r.bits=f,(r.wsize||w!==e.avail_out&&r.mode<Be&&(r.mode<Ip||t!==aw))&&pS(e,e.output,e.next_out,w-e.avail_out),h-=e.avail_in,w-=e.avail_out,e.total_in+=h,e.total_out+=w,r.total+=w,r.wrap&4&&w&&(e.adler=r.check=r.flags?it(r.check,n,w,e.next_out-w):ra(r.check,n,w,e.next_out-w)),e.data_type=r.bits+(r.last?64:0)+(r.mode===qr?128:0)+(r.mode===kc||r.mode===_p?256:0),(h===0&&w===0||t===aw)&&H===Lo&&(H=OI),H},"inflate$2"),$I=s(e=>{if(Mo(e))return Zt;let t=e.state;return t.window&&(t.window=null),e.state=null,Lo},"inflateEnd"),WI=s((e,t)=>{if(Mo(e))return Zt;let r=e.state;return r.wrap&2?(r.head=t,t.done=!1,Lo):Zt},"inflateGetHeader"),ZI=s((e,t)=>{let r=t.length,o,n,a;return Mo(e)||(o=e.state,o.wrap!==0&&o.mode!==vc)?Zt:o.mode===vc&&(n=1,n=ra(n,t,r,0),n!==o.check)?oS:(a=pS(e,t,r,r),a?(o.mode=sS,nS):(o.havedict=1,Lo))},"inflateSetDictionary"),YI=cS,XI=uS,JI=iS,eF=VI,tF=lS,rF=HI,oF=$I,nF=WI,sF=ZI,aF="pako inflate (from Nodeca project)",Gr={inflateReset:YI,inflateReset2:XI,inflateResetKeep:JI,inflateInit:eF,inflateInit2:tF,inflate:rF,inflateEnd:oF,inflateGetHeader:nF,inflateSetDictionary:sF,inflateInfo:aF};function iF(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}s(iF,"GZheader");var cF=iF,dS=Object.prototype.toString,{Z_NO_FLUSH:uF,Z_FINISH:lF,Z_OK:sa,Z_STREAM_END:Pp,Z_NEED_DICT:Rp,Z_STREAM_ERROR:pF,Z_DATA_ERROR:Pw,Z_MEM_ERROR:dF}=Uo;function ua(e){this.options=Rc.assign({chunkSize:1024*64,windowBits:15,to:""},e||{});let t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,t.windowBits===0&&(t.windowBits=-15)),t.windowBits>=0&&t.windowBits<16&&!(e&&e.windowBits)&&(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&(t.windowBits&15||(t.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Jw,this.strm.avail_out=0;let r=Gr.inflateInit2(this.strm,t.windowBits);if(r!==sa)throw new Error(No[r]);if(this.header=new cF,Gr.inflateGetHeader(this.strm,this.header),t.dictionary&&(typeof t.dictionary=="string"?t.dictionary=na.string2buf(t.dictionary):dS.call(t.dictionary)==="[object ArrayBuffer]"&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(r=Gr.inflateSetDictionary(this.strm,t.dictionary),r!==sa)))throw new Error(No[r])}s(ua,"Inflate$1");ua.prototype.push=function(e,t){let r=this.strm,o=this.options.chunkSize,n=this.options.dictionary,a,c,p;if(this.ended)return!1;for(t===~~t?c=t:c=t===!0?lF:uF,dS.call(e)==="[object ArrayBuffer]"?r.input=new Uint8Array(e):r.input=e,r.next_in=0,r.avail_in=r.input.length;;){for(r.avail_out===0&&(r.output=new Uint8Array(o),r.next_out=0,r.avail_out=o),a=Gr.inflate(r,c),a===Rp&&n&&(a=Gr.inflateSetDictionary(r,n),a===sa?a=Gr.inflate(r,c):a===Pw&&(a=Rp));r.avail_in>0&&a===Pp&&r.state.wrap>0&&e[r.next_in]!==0;)Gr.inflateReset(r),a=Gr.inflate(r,c);switch(a){case pF:case Pw:case Rp:case dF:return this.onEnd(a),this.ended=!0,!1}if(p=r.avail_out,r.next_out&&(r.avail_out===0||a===Pp))if(this.options.to==="string"){let m=na.utf8border(r.output,r.next_out),d=r.next_out-m,f=na.buf2string(r.output,m);r.next_out=d,r.avail_out=o-d,d&&r.output.set(r.output.subarray(m,m+d),0),this.onData(f)}else this.onData(r.output.length===r.next_out?r.output:r.output.subarray(0,r.next_out));if(!(a===sa&&p===0)){if(a===Pp)return a=Gr.inflateEnd(this.strm),this.onEnd(a),this.ended=!0,!0;if(r.avail_in===0)break}}return!0};ua.prototype.onData=function(e){this.chunks.push(e)};ua.prototype.onEnd=function(e){e===sa&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=Rc.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};function $p(e,t){let r=new ua(t);if(r.push(e),r.err)throw r.msg||No[r.err];return r.result}s($p,"inflate$1");function mF(e,t){return t=t||{},t.raw=!0,$p(e,t)}s(mF,"inflateRaw$1");var fF=ua,gF=$p,hF=mF,yF=$p,wF=Uo,SF={Inflate:fF,inflate:gF,inflateRaw:hF,ungzip:yF,constants:wF},{Deflate:bF,deflate:TF,deflateRaw:AF,gzip:xF}=_I,{Inflate:EF,inflate:kF,inflateRaw:CF,ungzip:_F}=SF,IF=bF,FF=TF,vF=AF,PF=xF,RF=EF,DF=kF,NF=CF,BF=_F,LF=Uo,Wp={Deflate:IF,deflate:FF,deflateRaw:vF,gzip:PF,Inflate:RF,inflate:DF,inflateRaw:NF,ungzip:BF,constants:LF};u();l();var Nc=class{static{s(this,"StreamedQuoteQueue")}maxSize=5;items=[];enqueue(t,r,o){let n=this.processQuoteResponse(t,r,o?.join(","));this.items.push(n),this.items.length>this.maxSize&&this.items.shift()}getItems(){return[...this.items]}size(){return this.items.length}clear(){this.items=[]}processQuoteResponse(t,r,o){return{quotes:t.quotes.map(a=>({amountIn:a.sellAmount,amountOut:a.buyAmount,tokenIn:O(t.sellToken),tokenOut:O(t.buyToken),provider:a.baseProvider.name})),timestamp:Date.now(),selectedProvider:r,alerts:o}}};var UF="Sq+",Zp=class{static{s(this,"StreamedQuoteLogger")}queue=new Nc;addQuoteResponse(t,r,o){this.queue.enqueue(t,r,o)}reset(){this.queue.clear()}getQuotes(){return this.queue.getItems()}logState(t){let r=this.getStateData(t);P.addBreadcrumb(M.Generic,`${UF}${r}`,Y.Info)}processQuoteProcessorState(t){switch(t.type){case"starting":this.reset();break;case"quoteProcessed":this.addQuoteResponse(t.response,t.input.preferredProvider,[...t.quoteDetails.alerts,...t.quoteDetails.warnings].map(r=>r.toString()));break;default:break}}getStateData(t){let r=this.queue.getItems(),o=this.compactData(r,t),n=Wp.gzip(JSON.stringify(o));return Buffer.from(n).toString("base64")}compactData(t,r){return t.length===0?null:{items:t.map(o=>({q:o.quotes.map(n=>({i:n.amountIn,o:n.amountOut,p:n.provider,ti:n.tokenIn,to:n.tokenOut})),t:o.timestamp,sp:o.selectedProvider,a:o.alerts})),th:r}}expandData(t){return t.items.map(r=>({quotes:r.q.map(o=>({amountIn:o.i,amountOut:o.o,tokenIn:o.ti,tokenOut:o.to,provider:o.p})),timestamp:r.t,selectedProvider:r.sp,alerts:r.a}))}decode(t){try{let r=Buffer.from(t,"base64"),o=Wp.inflate(r,{to:"string"}),n=JSON.parse(o);return n?{items:this.expandData(n),txnHash:n.th}:{items:[]}}catch(r){return console.error("Failed to decode compressed data:",r),{items:[]}}}},go=new Zp;u();l();u();l();var $;(function(e){e.AccountFrozen="AccountFrozen",e.NoCurrentQuoteError="Trying to execute swap with no current quote",e.NoQuoteResponseError="Trying to execute swap with no quote response",e.NoGasEstimation="No gas estimation available",e.NoSwapTransactions="No swap transactions available",e.InsufficientFunds="INSUFFICIENT_FUNDS",e.InsufficientGas="INSUFFICIENT_GAS",e.SlippageExceeded="slippageToleranceExceeded",e.SimulationTimeout="SIMULATION_TIMEOUT",e.NotValidScanResultsError="Scan results are not valid",e.StaleQuote="STALE_QUOTE",e.NotEnoughSol="NotEnoughSol",e.TransactionConfirmationFailed="Transaction confirmation failed",e.SimulationUnknownError="SimulationUnknownError",e.UnknownError="UnknownError",e.MissingArgument="MissingArgument",e.EmptyRoute="EmptyRoute",e.InvalidCalculation="InvalidCalculation",e.MissingPlatformFeeAccount="MissingPlatformFeeAccount",e.InvalidSlippage="InvalidSlippage",e.NotEnoughPercent="NotEnoughPercent",e.InvalidInputIndex="InvalidInputIndex",e.InvalidOutputIndex="InvalidOutputIndex",e.NotEnoughAccountKeys="NotEnoughAccountKeys",e.NonZeroMinimumOutAmountNotSupported="NonZeroMinimumOutAmountNotSupported",e.InvalidRoutePlan="InvalidRoutePlan",e.InvalidReferralAuthority="InvalidReferralAuthority",e.LedgerTokenAccountDoesNotMatch="LedgerTokenAccountDoesNotMatch",e.InvalidTokenLedger="InvalidTokenLedger",e.IncorrectTokenProgramID="IncorrectTokenProgramID",e.TokenProgramNotProvided="TokenProgramNotProvided",e.SwapNotSupported="SwapNotSupported",e.ExactOutAmountNotMatched="ExactOutAmountNotMatched",e.SourceAndDstinationMintCannotBeTheSame="SourceAndDstinationMintCannotBeTheSame",e.LedgerConnectionError="LedgerConnectionError",e.LedgerRejectAction="LedgerRejectAction",e.LedgerUnknownSignError="LedgerUnknownSignError",e.LedgerUnknownError="LedgerUnknownError"})($||($={}));var Ze=class extends Error{static{s(this,"SwapperError")}code;detailMessage;constructor(t,r){super(t),this.code=t,this.detailMessage=r}};var MF=$.SlippageExceeded,OF=$.InsufficientFunds,QF=Ef,qF="insufficient lamports",zF="lower balance than rent-exempt minimum",GF=xf,KF="Transaction confirmation failed",VF=["Ledger App not open","Ledger not connected","Unable to connect to Ledger","Unable to connect to Ledger device","Need permission to connect to Ledger"],jF="Ledger user rejected action",HF="Ledger Sign Error";function $F(e){try{return Number(e.split('"Custom":')[1].split("}")[0])}catch{return null}}s($F,"parseProgramErrorCode");function WF(e){switch($F(e.message)){case 301:return $.SlippageExceeded;case 6e3:return $.EmptyRoute;case 6001:return $.SlippageExceeded;case 6002:return $.InvalidCalculation;case 6003:return $.MissingPlatformFeeAccount;case 6004:return $.InvalidSlippage;case 6005:return $.NotEnoughPercent;case 6006:return $.InvalidInputIndex;case 6007:return $.InvalidOutputIndex;case 6008:return $.NotEnoughAccountKeys;case 6009:return $.NonZeroMinimumOutAmountNotSupported;case 6010:return $.InvalidRoutePlan;case 6011:return $.InvalidReferralAuthority;case 6012:return $.LedgerTokenAccountDoesNotMatch;case 6013:return $.InvalidTokenLedger;case 6014:return $.IncorrectTokenProgramID;case 6015:return $.TokenProgramNotProvided;case 6016:return $.SwapNotSupported;case 6017:return $.ExactOutAmountNotMatched;case 6018:return $.SourceAndDstinationMintCannotBeTheSame;default:return null}}s(WF,"parseProgramError");function ZF(e){return VF.some(r=>e.message.includes(r))?$.LedgerConnectionError:e.message.includes(jF)?$.LedgerRejectAction:e.message.includes(HF)?$.LedgerUnknownSignError:e.message.toLowerCase().includes("ledger")?$.LedgerUnknownError:null}s(ZF,"parseLedgerError");function Bc(e){if(e===void 0)return new Ze($.UnknownError,"No error provided");if(e instanceof Ze)return e;let t=YF(e);if(t.message.includes(OF))return new Ze($.InsufficientFunds);if(XF(t.message))return new Ze($.SlippageExceeded);if(t.message===$.NotValidScanResultsError)return new Ze($.NotValidScanResultsError);if([QF,qF,GF,zF].some(m=>t.message.includes(m)))return new Ze($.NotEnoughSol);let a=WF(t);if(a!==null)return new Ze(a);if(t.message.includes(KF))return new Ze($.TransactionConfirmationFailed);let p=ZF(t);return p!==null?new Ze(p):new Ze($.UnknownError,t.message)}s(Bc,"parseSwapError");function YF(e){return typeof e=="string"?new Error(e):typeof e=="object"&&"logs"in e&&e.logs?.length?new Error(e.logs.join(`
`)):e}s(YF,"normalizeError");function XF(e){return e.includes(MF)}s(XF,"errorMessageFailsFromSlippage");u();l();u();l();var mS=3;function Lc(){try{let e=Ht.getMultivariateAssignment("swapper-high-slippage-threshold"),t=Number(e);return!e||isNaN(t)?mS:t}catch{return mS}}s(Lc,"getHighSlippageThreshold");var fS=s(({currentQuote:e,quoteResponse:t,gasEstimation:r,swapTransactions:o,scanResults:n,isSwapSimulationDisabled:a,slippageTolerance:c})=>{if(!e)throw new Ze($.NoCurrentQuoteError);if(!t)throw new Ze($.NoQuoteResponseError);if(x.isEVMNetworkID(t.sellToken.chainId)&&(!r||r?.length===0||r?.length<(o?.transactions.length??1)))throw new Ze($.NoGasEstimation);if(!o)throw new Ze($.NoSwapTransactions);if(n.state!=="valid"&&(P.addBreadcrumb(M.Swapper,"swapSimulationNotValid",Y.Info,en({scanResults:n.state})),!a)){let m=[$.NotValidScanResultsError,$.AccountFrozen,$.InsufficientFunds,$.InsufficientGas,$.SlippageExceeded,$.SimulationTimeout,$.MissingArgument,$.StaleQuote,$.SimulationUnknownError];if(ev(n.state)&&m.includes(n.state.code)){if(JF(n.state,c))return;throw n.state}else throw new Ze($.NotValidScanResultsError)}},"validateSwap");function JF(e,t){return e.code===$.SlippageExceeded&&t&&t>=Lc()}s(JF,"shouldSuppressError");function ev(e){return e instanceof Ze}s(ev,"isSwapperError");var tv={swap:{solana:"executeSolanaSwap",evm:"executeEvmSwap",sui:"executeSuiSwap",bitcoin:"executeBitcoinSwap"},bridge:{solana:"executeSolanaBridge",evm:"executeEvmBridge",sui:"executeSuiBridge",bitcoin:"executeBitcoinBridge"}},Yp=s((e,t)=>tv[e?"bridge":"swap"][t??"solana"],"getExecuteSwapSpanName"),kH=s(async({isBridge:e,addressType:t,isSwapSimulationDisabled:r,sender:o,currentQuote:n,quoteResponse:a,gasEstimation:c,swapTransactions:p,scanResults:m,pendingActivityRows:d,connection:f,logSwapFailureNoSignature:h,logTransactionSubmitted:w,onTransactionReceiptReceived:y,onTransactionSubmissionError:S,resetToInitialState:T,slippageTolerance:b,swapFungibles:A})=>{await P.startSpan(Yp(e,p?.type),async()=>{T();let E;try{fS({currentQuote:n,quoteResponse:a,gasEstimation:c,swapTransactions:p,scanResults:m,isSwapSimulationDisabled:r,slippageTolerance:b});let C=await A({type:t,callerAddress:o,swapTransactions:p,pendingSwapActivityRows:d.pendingSwapActivityRows,pendingApprovalActivityRows:d.pendingApprovalActivityRows,gasEstimation:c,connection:f});if(y(C),C.error)throw C.id||h(),E=C.id,C.error;w(C),go.logState(C.id)}catch(C){let I=Bc(C);S(I,E)}})},"executeSwap");u();l();var ut;(function(e){e.SetPair="setPair",e.QuoteRequestStarted="quoteRequestStarted",e.QuoteResponseReceived="quoteResponseReceived",e.QuoteResponseStreamed="quoteResponseStreamed",e.QuoteRequestError="quoteRequestError",e.UserSelectedQuote="userSelectedQuote"})(ut||(ut={}));u();l();u();l();var Te;(function(e){e.SlippageExceeded="SLIPPAGE_EXCEEDED",e.InsufficientFunds="INSUFFICIENT_FUNDS",e.InsufficientGas="INSUFFICIENT_GAS",e.AccountFrozen="ACCOUNT_FROZEN",e.SimulationTimeout="SIMULATION_TIMEOUT",e.StaleQuote="STALE_QUOTE",e.UnknownError="UNKNOWN_ERROR",e.SimulationFailed="SIMULATION_FAILED"})(Te||(Te={}));var Ln=class e extends Error{static{s(this,"SimulationError")}scannedTransactionResult;type;detailMessage;constructor(t,r,o){super(t),this.scannedTransactionResult=r,this.type=o,r&&(this.detailMessage=r.simulationError?.humanReadableError??(r.warnings.length>0?r.warnings[0].message:void 0)),this.type=o}static fromError(t){return t instanceof e?t:new e(t.message)}static fromScannedTransactionResult(t,r){return s(n=>Object.values(Te).includes(n),"isSimulationErrorType")(t)?new e(t,r,t):new e(t,r)}};u();l();var Un=class e extends Error{static{s(this,"SubmissionError")}type;constructor(t,r){super(t),this.type=r}static fromError(t){return new e(t.message)}static fromType(t){return new e(t,t)}};var gS="https://phantom.com",Uc=class{static{s(this,"EventfulSwapCommand")}swapCommand;send;executingQuote;takerAddress;networkId;quote;executionId;constructor(t,r,o){this.swapCommand=t,this.send=r,this.executingQuote=o,this.takerAddress=t.takerAddress,this.networkId=t.networkId,this.quote=t.quote,this.executionId=t.executionId}createTransaction(){return this.send({type:j.ExecuteSwapStarted,executionId:this.executionId,executingQuote:this.executingQuote}),this.swapCommand.createTransaction()}async fetchSimulation(t){let{transactions:r,deviceId:o,isSimulationKilled:n}=t,a=wr(v.language)??"en";if(x.isSuiNetworkID(this.networkId))return{type:"transaction",expectedChanges:[],warnings:[],advancedDetails:void 0,error:void 0,simulationError:void 0,block:void 0};if(x.isBitcoinNetworkID(this.networkId))return{type:"transaction",expectedChanges:[],warnings:[],advancedDetails:void 0,error:void 0,simulationError:void 0,block:void 0};let c=await kn({transactions:r,locale:a,url:gS,deviceId:o,takerAddress:this.takerAddress,networkId:this.networkId,slippageType:this.executingQuote.slippageType,quote:this.quote,quoteResponse:this.executingQuote.response,isSimulationKilled:n});return c.status==="success"?c.result:null}async simulate(t,r,o,n){try{this.send({type:j.SimulationRequestStarted,executionId:this.executionId,executingQuote:this.executingQuote,networkId:this.networkId});let a=await this.fetchSimulation({transactions:t,deviceId:o,isSimulationKilled:n});if(!a)return this.send({type:j.SimulationSkipped,executionId:this.executionId,networkId:this.networkId}),null;switch(a.error){case void 0:break;case Te.SimulationFailed:break;case Te.SlippageExceeded:if(this.executingQuote.response.slippageTolerance>=Lc())break;default:throw Ln.fromScannedTransactionResult(a.error,a)}return this.send({type:j.SimulationPassed,scannedTransactionResult:a,executionId:this.executionId,networkId:this.networkId}),a}catch(a){throw this.send({type:j.SimulationFailed,error:Ln.fromError(a),executionId:this.executionId,networkId:this.networkId,url:gS}),a}}async swap(t,r,o,n,a){this.send({type:j.TransactionSubmissionStarted,executionId:this.executionId});try{let c=await this.swapCommand.swap(t,r,o,n,a);if(!c.id)throw Un.fromType("noSignature");return this.send({type:j.TransactionSubmissionSuccess,txReceipt:c,executionId:this.executionId}),c}catch(c){let p=c instanceof Un?c:Un.fromError(c);throw this.send({type:j.TransactionSubmissionFailed,error:p,executionId:this.executionId}),p}}async waitForConfirmation(t){this.send({type:j.TransactionConfirmationStarted,executionId:this.executionId,txReceipt:t});try{let r=await this.swapCommand.waitForConfirmation(t);return this.send({type:j.TransactionConfirmed,executionId:this.executionId,txReceipt:t}),r}catch(r){throw this.send({type:j.TransactionConfirmationFailed,error:r,txReceipt:t,executionId:this.executionId}),r}}};u();l();var Mc=class extends Error{static{s(this,"ExecuteSwapIllegalTransitionError")}constructor(t,r){let n=(Array.isArray(r)?r:[r]).join(", ");super(`Can't transition to ${n} from ${t.type}`)}},Oc=class{static{s(this,"ExecuteSwapStateMachine")}state=new Map;listeners=new Set;send(t){t.type===j.ExecuteSwapStarted&&this.state.set(t.executionId,{type:be.Idle,executingQuote:t.executingQuote});let r=this.state.get(t.executionId);if(!r)throw new Error(`No previous state found for execution id: ${t.executionId}`);let o=r;try{return o=this.detectNextState(r,t),o.type===be.TransactionConfirmed?this.state.delete(t.executionId):this.state.set(t.executionId,o),o}catch{return r}finally{this.notifyListeners(t,r,o,this.state)}}notifyListeners(t,r,o,n){this.listeners.forEach(a=>{try{a.onStateChange(t,r,o,n)}catch(c){console.error("Error notifying ExecuteSwapStateListener:",c)}})}getState(){return this.state}addListener(t){this.listeners.add(t)}removeListener(t){this.listeners.delete(t)}detectNextState(t,r){switch(r.type){case j.ExecuteSwapStarted:return Ir(t,be.Idle),{type:be.Started,executingQuote:r.executingQuote};case j.SimulationRequestStarted:return Ir(t,be.Started),{type:be.Simulating,executingQuote:t.executingQuote};case j.SimulationPassed:return Ir(t,be.Simulating),{type:be.Simulated,scannedTransactionResult:r.scannedTransactionResult,executingQuote:t.executingQuote};case j.SimulationFailed:return Ir(t,be.Simulating),{type:be.SimulationFailed,error:r.error,executingQuote:t.executingQuote};case j.SimulationSkipped:return Ir(t,be.Simulating),{type:be.SimulationSkipped,executingQuote:t.executingQuote};case j.TransactionSubmissionStarted:return rv(t,[be.Simulated,be.SimulationSkipped]),{type:be.SubmittingTransaction,executingQuote:t.executingQuote,scannedTransactionResult:t.type===be.Simulated?t.scannedTransactionResult:void 0};case j.TransactionSubmissionFailed:return Ir(t,be.SubmittingTransaction),{type:be.TransactionSubmissionFailed,error:r.error,executingQuote:t.executingQuote,scannedTransactionResult:t.scannedTransactionResult};case j.TransactionSubmissionSuccess:return Ir(t,be.SubmittingTransaction),{type:be.TransactionSubmitted,txReceipt:r.txReceipt,executingQuote:t.executingQuote,scannedTransactionResult:t.scannedTransactionResult};case j.TransactionConfirmationStarted:return Ir(t,be.TransactionSubmitted),{type:be.ConfirmingTransaction,txReceipt:t.txReceipt,scannedTransactionResult:t.scannedTransactionResult,executingQuote:t.executingQuote};case j.TransactionConfirmationFailed:return Ir(t,be.TransactionSubmitted),{type:be.TransactionNotConfirmed,txReceipt:t.txReceipt,scannedTransactionResult:t.scannedTransactionResult,error:r.error,executingQuote:t.executingQuote};case j.TransactionConfirmed:return Ir(t,be.ConfirmingTransaction),{type:be.TransactionConfirmed,txReceipt:t.txReceipt,scannedTransactionResult:t.scannedTransactionResult,executingQuote:t.executingQuote}}}};function Ir(e,t){if(e.type!==t)throw new Mc(e,t)}s(Ir,"checkState");function rv(e,t){if(!t.includes(e.type))throw new Mc(e,t)}s(rv,"checkStateAny");u();l();var Le;(function(e){e.Idle="idle",e.Pair="pair",e.FetchingQuote="fetchingQuote",e.QuoteError="quoteError",e.Quote="quote",e.ExecutingSwap="executingSwap",e.SwapConfirmed="swapConfirmed"})(Le||(Le={}));function hS(e){return e.type===Le.Quote}s(hS,"isExecutableSwapState");u();l();u();l();var ov={"Could not find any routes":"noRoute"},Qc=class e extends Error{static{s(this,"QuoteError")}type;constructor(t,r){super(r??t),this.type=t}static fromMessage(t){let r=t?ov[t]??"undefinedError":"undefinedError";return new e(r,t)}};var Oo=class extends Error{static{s(this,"SwapperIllegalTransitionError")}constructor(t,r){super(`Can't transition to ${r} from ${t.type}`)}},qc=class{static{s(this,"SwapperStateMachine")}state;listeners=new Set;constructor(t){this.state=t??{type:Le.Idle}}send(t){let r=this.state;try{return r=this.detectNextState(this.state,t),this.state=r,r}catch{return this.state}finally{this.notifyListeners(t,this.state,r)}}getState(){return this.state}addListener(t){this.listeners.add(t)}removeListener(t){this.listeners.delete(t)}notifyListeners(t,r,o){try{this.listeners.forEach(n=>n.onStateChange(t,r,o))}catch{}}detectNextState(t,r){switch(r.type){case ut.SetPair:return{type:Le.Pair,buy:r.buy,sell:r.sell,amount:r.amount};case ut.QuoteRequestStarted:switch(t.type){case Le.Pair:case Le.Quote:case Le.QuoteError:return{type:Le.FetchingQuote,buy:t.buy,sell:t.sell,amount:r.amount,slippageType:r.slippageType};default:throw new Oo(t,r.type)}case ut.QuoteRequestError:if(t.type!==Le.FetchingQuote)throw new Oo(t,r.type);return{type:Le.QuoteError,buy:t.buy,sell:t.sell,amount:t.amount,error:r.error,slippageType:t.slippageType};case ut.QuoteResponseReceived:if(t.type!==Le.FetchingQuote)throw new Oo(t,r.type);let o=r.response.quotes[0];return o?{type:Le.Quote,response:r.response,buy:t.buy,sell:t.sell,quote:o,amount:t.amount,slippageType:t.slippageType}:{type:Le.QuoteError,buy:t.buy,sell:t.sell,amount:t.amount,error:new Qc("noRoute"),slippageType:t.slippageType};case ut.QuoteResponseStreamed:switch(t.type){case Le.Pair:case Le.FetchingQuote:case Le.Quote:case Le.QuoteError:return{type:Le.Quote,response:r.response,buy:t.buy,sell:t.sell,quote:r.quote,amount:{amount:r.quoteInput.amount,perspective:r.quoteInput.exactOut?"buy":"sell"},slippageType:r.quoteInput.autoSlippage?ce.Auto:ce.Fixed,input:r.quoteInput};default:throw new Oo(t,r.type)}case ut.UserSelectedQuote:if(t.type!==Le.Quote)throw new Oo(t,r.type);return{type:Le.Quote,quote:r.quote,buy:t.buy,sell:t.sell,response:t.response,amount:t.amount,slippageType:t.slippageType}}}};u();l();u();l();var yS=i.object({buyToken:i.custom(),sellToken:i.custom(),buyTokenPrice:i.custom().optional(),sellTokenPrice:i.custom().optional(),maxSellAmount:i.string().optional()}),la=class e extends Error{static{s(this,"SwapInitializationError")}type;constructor(t,r){super(r??t.name),this.type=t}static fromError(t){return new e({name:"unknown"},t.message)}};function Xp(e,t){if(e.type!==t.type)return!1;switch(e.type){case"buy":return t.type!=="buy"?!1:e.buyCaip19===t.buyCaip19&&e.sellCaip19===t.sellCaip19&&e.takerCaip19===t.takerCaip19&&e.takerDestinationCaip19===t.takerDestinationCaip19&&e.options===t.options&&e.buyFungibleKey===t.buyFungibleKey;case"sell":return t.type!=="sell"?!1:e.sellCaip19===t.sellCaip19&&e.buyCaip19===t.buyCaip19&&e.takerCaip19===t.takerCaip19&&e.takerDestinationCaip19===t.takerDestinationCaip19&&e.options===t.options&&e.sellFungibleKey===t.sellFungibleKey;case"swap":return t.type!=="swap"?!1:e.network===t.network&&e.sellCaip19===t.sellCaip19&&e.buyCaip19===t.buyCaip19&&e.takerCaip19===t.takerCaip19&&e.takerDestinationCaip19===t.takerDestinationCaip19&&e.options===t.options;case"prediction":{if(t.type!=="prediction"||e.mode.direction!==t.mode.direction||e.outcomeType!==t.outcomeType||e.network!==t.network||e.takerCaip19!==t.takerCaip19||e.takerDestinationCaip19!==t.takerDestinationCaip19||e.options!==t.options)return!1;if(e.mode.direction==="buy"){if(t.mode.direction!=="buy"||e.mode.sellCaip19!==t.mode.sellCaip19)return!1}else if(t.mode.direction!=="sell"||e.mode.sellMintAddress!==t.mode.sellMintAddress)return!1;return e.mintAccounts===t.mintAccounts}default:{let r=e;return!1}}}s(Xp,"isSwapModeEqual");var Mn=class{static{s(this,"BackendSwapInitializer")}async initialize(t,r,o,n){let a=r.reduce((d,f)=>(d[f.networkID]=f.address,d),{}),c=await K.api().headers({"Content-Type":"application/json"}).timeout(z({seconds:20})).post("/swap/v2/initialize",{...t,addresses:a,cashAddresses:or?o:void 0,...n?{settings:n}:{}});if(c.status!==200)throw new Ve({key:"SwapInitializationFailed"});let p=yS.safeParse(c.data);if(!p.success)throw new Ve({key:"SwapInitializationFailed"});return{...p.data,takerCaip19:this.takerCaip19ForToken({token:p.data.sellToken,addresses:r}),takerDestinationCaip19:this.takerCaip19ForToken({token:p.data.buyToken,addresses:r})}}takerCaip19ForToken({token:t,addresses:r}){if(t.data.walletAddress&&ni(t))return O({chainId:t.data.chain.id,resourceType:ee.address,address:t.data.walletAddress});let o=this.findChainAddress({chain:t.data.chain,addresses:r});return O({chainId:o.networkID,resourceType:ee.address,address:o.address})}findChainAddress({chain:t,addresses:r}){let{id:o}=t,n=r.find(c=>c.networkID===o);if(!n)throw new Error(`No address found for chain ${o}`);let a={...n};return fr(a)&&(a.address=a.address.toLowerCase()),a}};u();l();var On=class{static{s(this,"BitcoinSwapInitializer")}proxyInitializer;constructor(t){this.proxyInitializer=t}async initialize(t,r,o,n){let a=this.getBitcoinAddressTypeForKey(t);if(!a)return this.proxyInitializer.initialize(t,r,o,n);let{key:c,addressType:p,direction:m}=a,d=nv(r,w=>{if(!(zm(w)&&w.addressType!==p))return w}),f=r.find(w=>w.addressType===p);if(!f)return this.proxyInitializer.initialize(t,r,o,n);switch(m){case"buy":t.takerDestinationCaip19=O({chainId:f.networkID,resourceType:ee.address,address:f.address});break;case"sell":t.takerCaip19=O({chainId:f.networkID,resourceType:ee.address,address:f.address});break}let h=await this.proxyInitializer.initialize(t,d,o,n);switch(m){case"buy":h.buyToken.data.key=c;break;case"sell":h.sellToken.data.key=c;break}switch(m){case"buy":h.takerCaip19=this.takerCaip19ForToken({token:h.sellToken,addresses:d});break;case"sell":h.takerDestinationCaip19=this.takerCaip19ForToken({token:h.buyToken,addresses:d});break}return h}keyToAddressType={"BitcoinNative-bip122_p2wpkh":he.BitcoinNativeSegwit,"BitcoinNative-bip122_p2tr":he.BitcoinTaproot,BitcoinNative:he.BitcoinTaproot};getBitcoinAddressTypeForKey(t){if(!(t.type!=="buy"&&t.type!=="sell"&&t.type!=="swap")){if(t.sellFungibleKey){let r=this.keyToAddressType[t.sellFungibleKey];if(r)return{key:t.sellFungibleKey,addressType:r,direction:"sell"}}if(t.buyFungibleKey){let r=this.keyToAddressType[t.buyFungibleKey];if(r)return{key:t.buyFungibleKey,addressType:r,direction:"buy"}}}}takerCaip19ForToken({token:t,addresses:r}){if(t.data.walletAddress)return O({chainId:t.data.chain.id,resourceType:ee.address,address:t.data.walletAddress});let o=this.findChainAddress({chain:t.data.chain,addresses:r});return O({chainId:o.networkID,resourceType:ee.address,address:o.address})}findChainAddress({chain:t,addresses:r}){let{id:o}=t,n=r.find(c=>c.networkID===o);if(!n)throw new Error(`No address found for chain ${o}`);let a={...n};return fr(a)&&(a.address=a.address.toLowerCase()),a}};function nv(e,t){return e.reduce((r,o)=>{let n=t(o);return n!=null&&r.push(n),r},[])}s(nv,"compactMap");u();l();function wS(e){if(e.type!=="pair")return;let{mode:t,buyToken:r,sellToken:o}=e;if(t.type!=="swap")throw new Error("Can't switch swap mode for: "+t.type);let n=O(X(e.buyToken)),a=O(X(e.sellToken)),c=e.takerDestinationCaip19,p=e.takerCaip19,m=r.data.key,d=o.data.key;return{type:"swap",network:n?et(n).chainId:x.solana.mainnetID,sellCaip19:n,buyCaip19:a,takerCaip19:c,takerDestinationCaip19:p,sellFungibleKey:m,buyFungibleKey:d}}s(wS,"switchSwapMode");u();l();u();l();u();l();u();l();u();l();u();l();var Jp={id:x.solana.mainnetID,imageUrl:x.solana.iconUrl,name:x.solana.name,symbol:x.solana.tokenSymbol},SS={type:oe.SolanaNative,data:{amount:"0",balance:new U(0),chain:Jp,decimals:9,key:"SolanaNative",logoUri:"https://cdn.jsdelivr.net/gh/solana-labs/token-list@main/assets/mainnet/So11111111111111111111111111111111111111112/logo.png",name:"Solana",symbol:"SOL",tokenAddress:void 0,walletAddress:"",spamStatus:ie.Verified}},bS={type:oe.SPL,data:{amount:"0",balance:new U(0),chain:Jp,decimals:6,key:"EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v",logoUri:"https://raw.githubusercontent.com/solana-labs/token-list/main/assets/mainnet/EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v/logo.png",mintAddress:"EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v",name:"USD Coin",splTokenAccountPubkey:"EAF7dH8Jy43Xgp68PhyybKhfKxk46NFRkWN4PMCLqMfS",symbol:"USDC",tokenAddress:"EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v",walletAddress:"",programId:"TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA",spamStatus:ie.Verified}},J$={type:oe.SPL,data:{amount:"0",balance:new U(0),chain:Jp,decimals:6,key:"cash-account",logoUri:"https://raw.githubusercontent.com/solana-labs/token-list/main/assets/mainnet/EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v/logo.png",mintAddress:"CASHx9KJUStyftLFWGvEVf59SGeG9sh5FfcnZMVPCASH",name:"Cash",splTokenAccountPubkey:"8mK7wXFmkUYZnXmKWyKvP3jN9vQxT4R2pLsD6aGcHqYz",symbol:"CASH",tokenAddress:"CASHx9KJUStyftLFWGvEVf59SGeG9sh5FfcnZMVPCASH",walletAddress:"9vKHN2wXQPzJ4mR5sYtL3bUfD6eWcX7aGpMqS8hV4nTz",programId:"TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA",spamStatus:ie.Verified}},TS={type:oe.SuiNative,data:{chain:{id:x.sui.mainnetID,name:x.sui.name,symbol:x.sui.tokenSymbol,imageUrl:x.sui.iconUrl},walletAddress:"",decimals:18,amount:"0",logoUri:"https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/sui/info/logo.png",name:"Sui",symbol:"SUI",balance:new U(0),key:"SuiNative",usd:85.14215868842653,price:1858.01,usd_24h_change:.0009391170983548136,tokenAddress:void 0,spamStatus:ie.Verified}},AS={type:oe.SuiCoin,data:{chain:{id:x.sui.mainnetID,name:x.sui.name,symbol:x.sui.tokenSymbol,imageUrl:x.sui.iconUrl},walletAddress:"",contractAddress:"0xdba34672e30cb065b1f93e3ab55318768fd6fef66c15942c9f7cb846e2f900e7::usdc::USDC",decimals:6,amount:"0",logoUri:"https://assets.coingecko.com/coins/images/6319/large/USD_Coin_icon.png?1547042389",name:"USD Coin",symbol:"USDC",balance:new U(0),key:"0xdba34672e30cb065b1f93e3ab55318768fd6fef66c15942c9f7cb846e2f900e7::usdc::USDC",tokenAddress:"0xdba34672e30cb065b1f93e3ab55318768fd6fef66c15942c9f7cb846e2f900e7::usdc::USDC",usd:1.8807026139560001,price:.999793,usd_24h_change:-.0005475429199477411,spamStatus:ie.Verified}},xS={type:oe.PolygonNative,data:{chain:{id:x.polygon.mainnetID,name:x.polygon.name,symbol:x.polygon.tokenSymbol,imageUrl:x.polygon.iconUrl},walletAddress:"",decimals:18,amount:"72172806352057410682",logoUri:"https://wallet-asset.matic.network/img/tokens/matic.svg",name:"Polygon",symbol:x.polygon.tokenSymbol,balance:new U(0),key:"PolygonNative",usd:79.02922295550286,price:1.095,usd_24h_change:-.19903579005681138,tokenAddress:void 0,spamStatus:ie.Verified}},ES={type:oe.BaseNative,data:{chain:{id:x.base.mainnetID,name:x.base.name,symbol:x.base.tokenSymbol,imageUrl:x.base.iconUrl},walletAddress:"",decimals:18,amount:"72172806352057410682",logoUri:"https://cdn.jsdelivr.net/gh/trustwallet/assets@master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",name:"Base",symbol:x.base.tokenSymbol,balance:new U(0),key:"BaseNative",usd:79.02922295550286,price:1.095,usd_24h_change:-.19903579005681138,tokenAddress:void 0,spamStatus:ie.Verified}},kS={type:oe.ArbitrumNative,data:{chain:{id:x.arbitrum.mainnetID,name:x.arbitrum.name,symbol:x.arbitrum.tokenSymbol,imageUrl:x.arbitrum.iconUrl},walletAddress:"",decimals:18,amount:"72172806352057410682",logoUri:"https://cdn.jsdelivr.net/gh/trustwallet/assets@master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",name:"Ethereum",symbol:"ETH",balance:new U(0),key:"ArbitrumNative",usd:79.02922295550286,price:1.095,usd_24h_change:-.19903579005681138,tokenAddress:void 0,spamStatus:ie.Verified}},CS={type:oe.MonadNative,data:{chain:{id:x.monad.mainnetID,name:x.monad.name,symbol:x.monad.tokenSymbol,imageUrl:x.monad.iconUrl},walletAddress:"",decimals:18,amount:"0",logoUri:"https://static.phantom.app/assets/monad.png",name:"Monad",symbol:x.monad.tokenSymbol,balance:new U(0),key:"MonadNative",usd:0,price:0,usd_24h_change:0,tokenAddress:void 0,spamStatus:ie.Verified}},_S={type:oe.ERC20,data:{amount:"0",balance:new U(0),decimals:6,key:"0x3c499c542cef5e3811e1192ce70d8cc03d5c3359",logoUri:"https://wallet-asset.matic.network/img/tokens/usdc.svg",name:"USD Coin",symbol:"USDC",tokenAddress:"0x3c499c542cef5e3811e1192ce70d8cc03d5c3359",walletAddress:"",chain:{id:x.polygon.mainnetID,imageUrl:x.polygon.iconUrl,name:x.polygon.name,symbol:x.polygon.tokenSymbol},contractAddress:"0x3c499c542cef5e3811e1192ce70d8cc03d5c3359",spamStatus:ie.Verified}},IS={type:oe.ERC20,data:{amount:"0",balance:new U(0),decimals:6,key:"0x833589fcd6edb6e08f4c7c32d4f71b54bda02913",logoUri:"https://wallet-asset.matic.network/img/tokens/usdc.svg",name:"USD Coin",symbol:"USDC",tokenAddress:"0x833589fcd6edb6e08f4c7c32d4f71b54bda02913",walletAddress:"",chain:{id:x.base.mainnetID,imageUrl:x.base.iconUrl,name:x.base.name,symbol:x.base.tokenSymbol},contractAddress:"0x833589fcd6edb6e08f4c7c32d4f71b54bda02913",spamStatus:ie.Verified}},FS={type:oe.ERC20,data:{amount:"0",balance:new U(0),decimals:6,key:"0xaf88d065e77c8cC2239327C5EDb3A432268e5831",logoUri:"https://wallet-asset.matic.network/img/tokens/usdc.svg",name:"USD Coin",symbol:"USDC",tokenAddress:"0xaf88d065e77c8cC2239327C5EDb3A432268e5831",walletAddress:"",chain:{id:x.arbitrum.mainnetID,imageUrl:x.arbitrum.iconUrl,name:x.arbitrum.name,symbol:x.arbitrum.tokenSymbol},contractAddress:"0xaf88d065e77c8cC2239327C5EDb3A432268e5831",spamStatus:ie.Verified}},vS={type:oe.ERC20,data:{amount:"0",balance:new U(0),decimals:6,key:"0x0000000000000000000000000000000000000000",logoUri:"https://wallet-asset.matic.network/img/tokens/usdc.svg",name:"USD Coin",symbol:"USDC",tokenAddress:"0x0000000000000000000000000000000000000000",walletAddress:"",chain:{id:x.monad.mainnetID,imageUrl:x.monad.iconUrl,name:x.monad.name,symbol:x.monad.tokenSymbol},contractAddress:"0x0000000000000000000000000000000000000000",spamStatus:ie.Verified}},PS={type:oe.HyperevmNative,data:{chain:{id:x.hyperevm.mainnetID,name:x.hyperevm.name,symbol:x.hyperevm.tokenSymbol,imageUrl:x.hyperevm.iconUrl},walletAddress:"",decimals:18,amount:"0",logoUri:"",name:"Ethereum",symbol:"ETH",balance:new U(0),key:"HyperevmNative",usd:79.02922295550286,price:1.095,usd_24h_change:-.19903579005681138,tokenAddress:void 0,spamStatus:ie.Verified}},RS={type:oe.ERC20,data:{amount:"0",balance:new U(0),decimals:6,key:"0xb88339cb7199b77e23db6e890353e22632ba630f",logoUri:"https://wallet-asset.matic.network/img/tokens/usdc.svg",name:"USD Coin",symbol:"USDC",tokenAddress:"0xb88339cb7199b77e23db6e890353e22632ba630f",walletAddress:"",chain:{id:x.hyperevm.mainnetID,imageUrl:x.hyperevm.iconUrl,name:x.hyperevm.name,symbol:x.hyperevm.tokenSymbol},contractAddress:"0xb88339cb7199b77e23db6e890353e22632ba630f",spamStatus:ie.Verified}},DS={type:oe.EthereumNative,data:{chain:{id:x.ethereum.mainnetID,name:x.ethereum.name,symbol:x.ethereum.tokenSymbol,imageUrl:x.ethereum.iconUrl},walletAddress:"",decimals:18,amount:"45824381294194610",logoUri:"https://cdn.jsdelivr.net/gh/trustwallet/assets@master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",name:"Ethereum",symbol:"ETH",balance:new U(0),key:"EthereumNative",usd:85.14215868842653,price:1858.01,usd_24h_change:.0009391170983548136,tokenAddress:void 0,spamStatus:ie.Verified}},NS={type:oe.ERC20,data:{chain:{id:x.ethereum.mainnetID,name:x.ethereum.name,symbol:x.ethereum.tokenSymbol,imageUrl:x.ethereum.iconUrl},walletAddress:"",contractAddress:"0xa0b86991c6218b36c1d19d4a2e9eb0ce3606eb48",decimals:6,amount:"1881092",logoUri:"https://assets.coingecko.com/coins/images/6319/large/USD_Coin_icon.png?1547042389",name:"USD Coin",symbol:"USDC",balance:new U(0),key:"0xa0b86991c6218b36c1d19d4a2e9eb0ce3606eb48",tokenAddress:"0xa0b86991c6218b36c1d19d4a2e9eb0ce3606eb48",usd:1.8807026139560001,price:.999793,usd_24h_change:-.0005475429199477411,spamStatus:ie.Verified}};var e4="https://help.phantom.com/hc/en-us/articles/5985106844435",t4="https://help.phantom.com/hc/en-us/articles/29763090277139";var ho={amount:new U(0),amountUsd:null,pct:0};u();l();var Yt={};var BS={...Yt,bridgeMinimumUsdAmounts:0,swapDefaultFee:new U(15e-5*10**18),bridgeDefaultFee:new U(.025*10**18),averageNetworkFee:new U(15e-5*10**18),nativeFungible:kS,usdcFungible:FS};u();l();var LS={...Yt,bridgeMinimumUsdAmounts:0,swapDefaultFee:new U(15e-5*10**18),bridgeDefaultFee:new U(.025*10**18),averageNetworkFee:new U(15e-5*10**18),nativeFungible:ES,usdcFungible:IS};u();l();var US={bridgeMinimumUsdAmounts:10,swapDefaultFee:new U(1e4),bridgeDefaultFee:new U(1e4),averageNetworkFee:new U(1e4),nativeFungible:{type:oe.BitcoinNative,data:{chain:{id:x.bitcoin.mainnetID,name:x.bitcoin.name,symbol:x.bitcoin.tokenSymbol,imageUrl:x.bitcoin.iconUrl},walletAddress:"",decimals:18,amount:"45824381294194610",logoUri:"https://cdn.jsdelivr.net/gh/trustwallet/assets@master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",name:"Bitcoin",symbol:"BTC",balance:new U(0),key:"BitcoinNative",usd:85.14215868842653,price:1858.01,usd_24h_change:.0009391170983548136,tokenAddress:void 0,spamStatus:ie.Verified}},usdcFungible:{type:oe.BitcoinNative,data:{chain:{id:x.bitcoin.mainnetID,name:x.bitcoin.name,symbol:x.bitcoin.tokenSymbol,imageUrl:x.bitcoin.iconUrl},walletAddress:"",decimals:18,amount:"45824381294194610",logoUri:"https://cdn.jsdelivr.net/gh/trustwallet/assets@master/blockchains/ethereum/assets/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2/logo.png",name:"Bitcoin",symbol:"BTC",balance:new U(0),key:"BitcoinNative",usd:85.14215868842653,price:1858.01,usd_24h_change:.0009391170983548136,tokenAddress:void 0,spamStatus:ie.Verified}}};u();l();var MS={...Yt,bridgeMinimumUsdAmounts:20,swapDefaultFee:new U(2.5*10**16),bridgeDefaultFee:new U(3.75*10**16),averageNetworkFee:new U(0),nativeFungible:DS,usdcFungible:NS};u();l();var OS={...Yt,bridgeMinimumUsdAmounts:0,swapDefaultFee:new U(15e-5*10**18),bridgeDefaultFee:new U(.025*10**18),averageNetworkFee:new U(15e-5*10**18),nativeFungible:PS,usdcFungible:RS};u();l();var QS={...Yt,bridgeMinimumUsdAmounts:0,swapDefaultFee:new U(.015*10**18),bridgeDefaultFee:new U(.025*10**18),averageNetworkFee:new U(.0021*10**18),nativeFungible:CS,usdcFungible:vS,requiredFeatureFlag:"enable-monad-swapper"};u();l();var qS={...Yt,bridgeMinimumUsdAmounts:2,swapDefaultFee:new U(6*10**16),bridgeDefaultFee:new U(6*10**16),averageNetworkFee:new U(.0015*10**18),nativeFungible:xS,usdcFungible:_S};u();l();var zS={bridgeMinimumUsdAmounts:1,swapDefaultFee:new U(3*10**6),bridgeDefaultFee:new U(30*10**6),averageNetworkFee:new U(15e3),nativeFungible:SS,usdcFungible:bS};u();l();var GS={bridgeMinimumUsdAmounts:1,swapDefaultFee:new U(50*10**6),bridgeDefaultFee:new U(50*10**6),averageNetworkFee:new U(50*10**6),nativeFungible:TS,usdcFungible:AS};var yW=[ne.Solana,ne.Ethereum,ne.Polygon,ne.Monad,ne.Base,ne.Sui,ne.Arbitrum,ne.Hyperevm,ne.Bitcoin],sv=new Jo({[ne.Solana]:zS,[ne.Ethereum]:MS,[ne.Polygon]:qS,[ne.Monad]:QS,[ne.Base]:LS,[ne.Sui]:GS,[ne.Arbitrum]:BS,[ne.Hyperevm]:OS,[ne.Bitcoin]:US}),Xt=Xo(sv);var pa=s((e,t)=>{let r=[];if(av(e)&&r.push({type:"permanentDelegate",level:"warn",titleKey:"swapAssetWarningPermanentDelegate",shortTitleKey:"swapAssetWarningPermanentDelegateShort",modalTitleKey:"swapAssetWarningPermanentDelegateModalTitle"}),(e.data.spamStatus===ie.NotVerified||e.data.spamStatus===ie.Spam||e.data.spamStatus===ie.PossibleSpam)&&r.push({type:"unverified",level:"info",titleKey:"swapAssetWarningUnverified",shortTitleKey:"swapAssetWarningUnverifiedShort",modalTitleKey:"swapAssetWarningUnverifiedModalTitle"}),!St(e.type)&&t&&iv(t)){let o=Xt.get(e.data.chain.id).nativeFungible;r.push({type:"lowBalance",level:"info",titleKey:"swapAssetWarningLowTokenBalance",shortTitleKey:"swapAssetWarningLowTokenBalanceShort",modalTitleKey:"swapAssetWarningLowTokenBalanceModalTitle",options:{token:o.data.symbol??"",network:o.data.chain.name}})}return r},"detectAssetWarnings");function av(e){let t=e.data;return t?.mintExtensions?t.mintExtensions.some(r=>r.extension===oi.permanentDelegate):!1}s(av,"hasPermanentDelegateExtension");function iv(e){let t=Xt.get(e.data.chain.id);return new _(e.data.amount?e.data.amount:0).lt(t.swapDefaultFee)}s(iv,"isLowNativeTokenBalance");u();l();var cv=3,KS=new _(2039280),uv=new _(356190);function zc(e,t){if(!St(e.type))return new _(e.data.balance);let{balance:r,decimals:o}=e.data,n=r?new _(r).multipliedBy(10**o):new _(0),a=lv(e,t);return(n.gt(a)?n.minus(a):n).dividedBy(10**o)}s(zc,"getMaxSellAmountWithDefaults");function lv(e,t){let r=e.data.chain.id;if(x.isSolanaNetworkID(r))return pv(e,t);if(x.isEVMNetworkID(r))return dv(e,t);if(x.isSuiNetworkID(r))return mv(e,t);throw new Error("Chain not supported by swapper")}s(lv,"calculateFees");function pv(e,t){let{defaultSwapFee:r,networkFeeBuffer:o}=ed(e,t),n=r.plus(o),a=KS,c=!t||new _(t.data.balance).isZero()?KS:new _(0);return n.plus(a).plus(c)}s(pv,"calculateSolanaFees");function dv(e,t){let{networkFeeBuffer:r}=ed(e,t),o=fv(e.data.chain.id),n=new _(o.maxFeePerGas),a=new _(o.maxPriorityFeePerGas);return uv.multipliedBy(n.plus(a)).plus(r)}s(dv,"calculateEVMFees");function mv(e,t){let{defaultSwapFee:r,networkFeeBuffer:o}=ed(e,t);return r.plus(o)}s(mv,"calculateSuiFees");function ed(e,t){let r=$t(e.data.chain.id,t?.data.chain.id),o=Xt.get(e.data.chain.id),n=r?o.bridgeDefaultFee:o.swapDefaultFee,a=o.averageNetworkFee.multipliedBy(cv);return{defaultSwapFee:n,networkFeeBuffer:a}}s(ed,"getCommonFeeComponents");function fv(e){if(x.isEthereumNetworkID(e))return{maxFeePerGas:new _("5000000000"),maxPriorityFeePerGas:new _("79000000")};if(x.isPolygonNetworkID(e))return{maxFeePerGas:new _("30000000000"),maxPriorityFeePerGas:new _("30000000000")};if(x.isBaseNetworkID(e))return{maxFeePerGas:new _("25000000"),maxPriorityFeePerGas:new _("1100000")};if(x.isArbitrumNetworkID(e))return{maxFeePerGas:new _("29000000"),maxPriorityFeePerGas:new _("0")};throw new Error("Chain not supported by swapper")}s(fv,"getEVMDefaultTransactionUnitCost");var Gc=class{static{s(this,"TokenStateMachine")}state={type:"idle"};eventListeners=[];send(t){let r=this.state,o=r;try{return o=this.detectNextState(t),this.state=o,o}catch{return r}finally{this.eventListeners.forEach(n=>n.onStateChange(t,r,o))}}detectNextState(t){switch(t.type){case"initializeStarted":return{type:"initializing",mode:t.mode};case"initializeCompleted":if(this.state.type==="initializing"||this.state.type==="refreshing"){let r=new _(t.result.maxSellAmount??t.result.sellToken.data.balance);return{type:"pair",mode:this.state.mode,sellToken:t.result.sellToken,buyToken:t.result.buyToken,sellTokenPrice:t.result.sellTokenPrice,buyTokenPrice:t.result.buyTokenPrice,warnings:pa(t.result.buyToken),maxSellAmount:r,takerCaip19:t.result.takerCaip19,takerDestinationCaip19:t.result.takerDestinationCaip19}}throw new Error("Invalid state");case"initializeFailed":if(this.state.type!=="initializing")throw new Error("Invalid state");return{type:"error",error:t.error};case"switchTokens":{if(this.state.type!=="pair")throw new Error("Invalid state");let r=this.state.buyToken,o=this.state.sellToken,n=this.state.buyTokenPrice,a=this.state.sellTokenPrice;return{type:"pair",mode:t.mode,sellToken:r,buyToken:o,sellTokenPrice:n,buyTokenPrice:a,maxSellAmount:zc(r,o),warnings:pa(o),takerCaip19:this.state.takerDestinationCaip19,takerDestinationCaip19:this.state.takerCaip19}}case"changeToken":{if(this.state.type!=="pair")throw new Error("Invalid state");let r=t.perspective==="sell"?t.token:this.state.sellToken,o=t.perspective==="buy"?t.token:this.state.buyToken;return{type:"pair",mode:t.mode,sellToken:r,buyToken:o,sellTokenPrice:t.sellTokenPrice??this.state.buyTokenPrice,buyTokenPrice:t.buyTokenPrice??this.state.sellTokenPrice,maxSellAmount:zc(r,o),warnings:pa(t.perspective==="buy"?t.token:this.state.buyToken),takerCaip19:this.state.takerCaip19,takerDestinationCaip19:this.state.takerDestinationCaip19}}case"updateBalances":{if(this.state.type!=="pair")throw new Error("Invalid state");if(O(X(this.state.sellToken))!==t.sellTokenCaip19)throw new Error("Invalid state");let r={...this.state.sellToken,data:{...this.state.sellToken.data,balance:t.sellTokenBalance}},o=this.state.buyToken;return{type:"pair",mode:this.state.mode,sellToken:r,buyToken:o,sellTokenPrice:this.state.sellTokenPrice,buyTokenPrice:this.state.buyTokenPrice,warnings:pa(o),maxSellAmount:zc(r,o),takerCaip19:this.state.takerCaip19,takerDestinationCaip19:this.state.takerDestinationCaip19}}case"refreshing":if(this.state.type!=="pair")throw new Error("Invalid state");return{type:"refreshing",mode:this.state.mode,sellToken:this.state.sellToken,buyToken:this.state.buyToken,sellTokenPrice:this.state.sellTokenPrice,buyTokenPrice:this.state.buyTokenPrice,maxSellAmount:this.state.maxSellAmount,warnings:this.state.warnings,takerCaip19:this.state.takerCaip19,takerDestinationCaip19:this.state.takerDestinationCaip19}}}getState(){return this.state}subscribe(t){this.eventListeners.push(t)}unsubscribe(t){this.eventListeners=this.eventListeners.filter(r=>r!==t)}};var Kc=class{static{s(this,"Swapper")}apiClient;swapCommandFactory;quoteProcessor;stateMachine=new qc;executeSwapStateMachine=new Oc;account;cashAccount;config={slippageType:ce.Auto,slippageTolerance:1.3,isSimulationKilled:!1};swapInitializer=new On(new Mn);tokenStateMachine=new Gc;accountChangeListeners=[];constructor(t,r,o,n){this.apiClient=t,this.swapCommandFactory=r,this.quoteProcessor=o,this.quoteProcessor.subscribe(this.quoteProcessorListener),this.tokenStateMachine.subscribe(this.tokenStateListener),n&&(this.account=n)}tokenStateListener={onStateChange:s((t,r,o)=>{o.type==="pair"&&(this.setPair(o.buyToken,o.sellToken,{amount:"0",perspective:"sell"}),t.type==="changeToken"&&this.refreshQuoteProcessor())},"onStateChange")};refreshPair({swapMode:t,cashAddresses:r,settings:o}){this.initializeSwap({swapMode:t,cashAddresses:r,settings:o,refresh:!0})}initializeSwap({swapMode:t,cashAddresses:r,settings:o,refresh:n=!1}){let a=this.checkAccount();this.getTokenState().type==="pair"&&n?this.tokenStateMachine.send({type:"refreshing"}):this.tokenStateMachine.send({type:"initializeStarted",mode:t}),this.swapInitializer.initialize(t,a.addresses,r,o).then(p=>{this.tokenStateMachine.send({type:"initializeCompleted",result:p})}).catch(p=>{P.captureError(p,M.Swapper),p instanceof la?this.tokenStateMachine.send({type:"initializeFailed",error:p}):this.tokenStateMachine.send({type:"initializeFailed",error:la.fromError(p)})})}updateBalances({sellTokenBalance:t,sellTokenCaip19:r}){this.getTokenState().type==="pair"&&this.tokenStateMachine.send({type:"updateBalances",sellTokenBalance:t,sellTokenCaip19:r})}getTokenState(){return this.tokenStateMachine.getState()}subscribeToken(t){return this.tokenStateMachine.subscribe(t),()=>this.unsubscribeToken(t)}unsubscribeToken(t){this.tokenStateMachine.unsubscribe(t)}quoteProcessorListener={onStateChange:s((t,r)=>{(r.type==="firstQuoteReceived"||r.type==="quoteProcessed")&&this.send({type:ut.QuoteResponseStreamed,response:r.response,quoteInput:r.input,quote:r.quote})},"onStateChange")};isValidAmount(t){try{let r=new _(t);return r.isFinite()?!r.isNegative():!1}catch{return!1}}setAmount(t,r){let o=this.getTokenState();if(!bt(o)){console.error(`Can't set amount from tokenState ${o.type}`);return}let{amount:n}=t;if(n===""&&(n="0"),!this.isValidAmount(n))return;this.quoteProcessor.stop();let a=this.checkAccount(),c={...this.config,...r,isSimulationKilled:r?.isSimulationKilled??this.config.isSimulationKilled??!1};if(n==="0"||n===""){this.send({type:ut.SetPair,buy:o.buyToken,sell:o.sellToken,amount:t});return}let{buyToken:p,sellToken:m,takerCaip19:d,takerDestinationCaip19:f}=o,h=je(p)||je(m);try{let w={amount:new _(t.amount).shiftedBy(t.perspective==="buy"?p.data.decimals:m.data.decimals).toString(),amountUsd:_(t.amount).times(t.perspective==="buy"?p.data.price??0:m.data.price??0).toString(),buy:p,sell:m,taker:d,takerDestination:f,slippageTolerance:c.slippageTolerance,autoSlippage:c.slippageType===ce.Auto,exactOut:t.perspective==="buy",priorityFee:c.priorityFee,tipAmount:c.tipAmount,preferredProvider:c.preferredProvider,isLedger:a.type==="ledger",phantomCashAccount:h,isSimulationKilled:c.isSimulationKilled};this.quoteProcessor.start(w,a)}catch(w){console.error("Error when streaming quotes",w)}}setPair(t,r,o){this.send({type:ut.SetPair,buy:t,sell:r,amount:o})}switchTokens(){let t=this.getTokenState();if(t.type!=="pair")return;let r=wS(t);r&&this.tokenStateMachine.send({type:"switchTokens",mode:r})}setAccount(t){this.account=t,this.accountChangeListeners.forEach(r=>r.onAccountChange(t))}setCashAccount(t){this.cashAccount=t}getAccount(){return this.account}getInitializer(){return this.swapInitializer}setInitializer(t){this.swapInitializer=t}async fetchQuotes({amount:t,amountUsd:r,buy:o,sell:n,slippageTolerance:a,autoSlippageEnabled:c,priorityFee:p,tipAmount:m,signal:d,phantomCashAccount:f}){let h=X(n),w=X(o),y=t.perspective==="buy",S=new _(t.amount).shiftedBy(t.perspective==="buy"?o.data.decimals:n.data.decimals).toString();this.send({type:ut.QuoteRequestStarted,amount:t,slippageType:c?ce.Auto:ce.Fixed});let T=this.checkChainAddress(n.data),b={chainId:T.networkID,resourceType:ee.address,address:T.address},A;if($t(n.data.chain.id,o.data.chain.id)){let E=this.checkChainAddress(o.data);A={chainId:E.networkID,resourceType:ee.address,address:E.address}}try{let E=await this.apiClient.getQuotes({sell:h,buy:w,amount:S,amountUsd:r,taker:b,takerDestination:A,slippageTolerance:a??0,autoSlippageEnabled:c,exactOutEnabled:y,priorityFee:p,tipAmount:m,signal:d,phantomCashAccount:f});return this.send({type:ut.QuoteResponseReceived,response:E}),E}catch(E){throw this.send({type:ut.QuoteRequestError,error:E}),E}}async swap(t){let{signer:r,storage:o,locale:n,deviceId:a,connection:c,authRepository:p,isSimulationKilled:m,gasEstimation:d,preprocessor:f}=t,h=this.getState();if(!hS(h))throw new Error(`Can't swap from ${h.type}`);this.quoteProcessor.stop();let w=this.checkAccount(),y={account:w,buy:h.buy,sell:h.sell,amount:h.amount,quote:h.quote,response:h.response,slippageType:h.slippageType,quoteInput:h.input},S=this.getAddressFromCaip19({caip19:h.response.taker}),T=this.swapCommandFactory.create(y,S,h.sell.data.chain.id,c,p,this.cashAccount,d),b=new Uc(T,E=>this.executeSwapStateMachine.send(E),y),A=await b.createTransaction();await P.startSpan(Yp(se(h.quote),A.type),async()=>{let E=await b.simulate(A,n,a,m),C=s(async()=>{let I=await b.swap(w.identifier,A,E,r,o);await b.waitForConfirmation(I)},"performSwap");f?await f(C):await C()})}changeToken(t,r,o){let n=this.getTokenState();if(n.type!=="pair")return;let a=r==="buy"?t:n.buyToken,c=r==="sell"?t:n.sellToken,p=X(c),m=X(a),d;n.mode.type==="swap"?d={...n.mode,network:c.data.chain.id,sellCaip19:O(p),buyCaip19:O(m),takerCaip19:r==="sell"?o:n.mode.takerCaip19,takerDestinationCaip19:r==="buy"?o:n.mode.takerDestinationCaip19,sellFungibleKey:r==="sell"?t.data.key:n.mode.sellFungibleKey,buyFungibleKey:r==="buy"?t.data.key:n.mode.buyFungibleKey}:n.mode.type==="buy"?d={...n.mode,buyCaip19:O(m),sellCaip19:O(p),takerCaip19:r==="buy"?o:n.mode.takerCaip19}:n.mode.type==="sell"&&(d={...n.mode,sellCaip19:O(p),buyCaip19:O(m),takerDestinationCaip19:r==="sell"?o:n.mode.takerDestinationCaip19}),si({tokens:[m,p]}).then(f=>{let h=f[O(m)],w=f[O(p)];this.tokenStateMachine.send({type:"changeToken",mode:d,token:t,perspective:r,buyTokenPrice:h,sellTokenPrice:w})}).catch(f=>{P.captureError(f,M.Swapper),this.tokenStateMachine.send({type:"changeToken",mode:d,token:t,perspective:r})})}selectQuote(t){this.send({type:ut.UserSelectedQuote,quote:t})}setQuoteConfig(t){this.config={...this.config,...t},this.refreshQuoteProcessor()}refreshQuoteProcessor(){let t=this.getLastQuoteProcessorSwapAmount();t&&this.setAmount(t)}getLastQuoteProcessorSwapAmount(){let t=this.getQuoteProcessorState();switch(t.type){case"starting":case"firstQuoteReceived":case"quoteProcessed":case"error":let r=t.input;return{amount:new _(r.amount).shiftedBy(-1*(r.exactOut?r.buy.data.decimals:r.sell.data.decimals)).toString(),perspective:r.exactOut?"buy":"sell"};default:return}}getState(){return this.stateMachine.getState()}getExecuteState(){return this.executeSwapStateMachine.getState()}stopProcessingQuotes(){this.quoteProcessor.stop()}subscribeExecution(t){return this.executeSwapStateMachine.addListener(t),()=>this.unsubscribeExecution(t)}unsubscribeExecution(t){this.executeSwapStateMachine.removeListener(t)}getQuoteProcessorState(){return this.quoteProcessor.getState()}subscribeQuoteProcessor(t){return this.quoteProcessor.subscribe(t),()=>this.unsubscribeQuoteProcessor(t)}unsubscribeQuoteProcessor(t){this.quoteProcessor.unsubscribe(t)}stopQuoteProcessor(){this.quoteProcessor.stop()}subscribeAccountChange(t){return this.accountChangeListeners.push(t),()=>this.unsubscribeAccountChange(t)}unsubscribeAccountChange(t){this.accountChangeListeners=this.accountChangeListeners.filter(r=>r!==t)}setQuoteStreamer(t){this.quoteProcessor.setQuoteStreamer(t)}getSwapCommandFactory(){return this.swapCommandFactory}setSwapCommandFactory(t){this.swapCommandFactory=t}send(t){return this.stateMachine.send(t)}checkAccount(){if(!this.account)throw new Error("Must set a MultiChainAccount");return this.account}checkChainAddress({chain:t,walletAddress:r}){let{id:o}=t;if(r)return{networkID:o,address:r};let a=this.checkAccount().addresses.find(p=>p.networkID===o);if(!a)throw new Error(`No address found for chain ${o}`);let c={...a};return fr(c)&&(c.address=c.address.toLowerCase()),c}getAddressFromCaip19(t){let r;if("encodedCaip19"in t?r=et(t.encodedCaip19):r=t.caip19,r.resourceType===ee.address)return r.address;throw new Error(`CAIP19 ${r} is not an address`)}};u();l();var Vc=D(L());var VS=(0,Vc.createContext)(null),jS=VS.Provider;function Qn(){let e=(0,Vc.useContext)(VS);if(!e)throw new Error("useBridgeStatusManager must be used within a BridgeStatusManagerProvider");return e}s(Qn,"useBridgeStatusManager");u();l();var HS=D(L());u();l();u();l();var da=class{static{s(this,"WarmSwapAnalytics")}analytics;constructor(t){this.analytics=t}warmingStarted(t){this.analytics.capture("swapperWarmingStarted",{data:{mode:t.type,caip19:this.getCaip19(t)}})}warmingCompleted(t,r){this.analytics.capture("swapperWarmingCompleted",{data:{mode:t.type,caip19:this.getCaip19(t),durationMs:r}})}warmingFailed(t){this.analytics.capture("swapperWarmingFailed",{data:{mode:t.type,caip19:this.getCaip19(t)}})}cacheHit(t){this.analytics.capture("swapperWarmCacheHit",{data:{mode:t.type,caip19:this.getCaip19(t)}})}cacheMiss(t){this.analytics.capture("swapperWarmCacheMiss",{data:{mode:t.type,caip19:this.getCaip19(t)}})}warmingAwaited(t){this.analytics.capture("swapperWarmingAwaited",{data:{mode:t.type,caip19:this.getCaip19(t)}})}getCaip19(t){switch(t.type){case"buy":return t.buyCaip19;case"sell":return t.sellCaip19;default:return}}};var jc=class{static{s(this,"WarmSwapInitializer")}proxyInitializer;multiChainAccount;cashAddresses;cache;analytics;constructor(t,r,o){this.proxyInitializer=t,this.cache=new td(r),this.analytics=o?new da(o):void 0}async initialize(t,r,o,n){let a=this.cache.get(t);if(!a)return this.analytics?.cacheMiss(t),this.proxyInitializer.initialize(t,r,o,n);switch(a.type){case"idle":return this.analytics?.cacheMiss(t),this.proxyInitializer.initialize(t,r,o,n);case"warming":return this.analytics?.warmingAwaited(t),a.promise.catch(()=>this.proxyInitializer.initialize(t,r,o,n)).finally(()=>{this.cache.delete(t)});case"warmed":return this.analytics?.cacheHit(t),this.cache.delete(t),a.initializationResult}}warmInitialization(t){if(!this.multiChainAccount)return;let r=this.cache.peek(t);if(r&&r.type==="warmed"&&Xp(r.swapMode,t))return;this.analytics?.warmingStarted(t);let o=Date.now(),n=this.proxyInitializer.initialize(t,this.multiChainAccount.addresses,this.cashAddresses??{},{});this.cache.set(t,{type:"warming",swapMode:t,promise:n}),n.then(a=>{let c=Date.now()-o;this.analytics?.warmingCompleted(t,c),this.cache.set(t,{type:"warmed",swapMode:t,initializationResult:a})}).catch(()=>{this.analytics?.warmingFailed(t),this.cache.delete(t)})}setMultiChainAccount(t){this.cache.clear(),this.multiChainAccount=t}setCashAddresses(t){this.cache.clear(),this.cashAddresses=t}setAnalytics(t){this.analytics||(this.analytics=new da(t))}},td=class{static{s(this,"Cache")}capacity;entries=new Map;constructor(t){this.capacity=t}getKey(t){let r={type:t.type},o=s(n=>{if(n?.minimumOrderSize)return{minimumOrderSize:{base:n.minimumOrderSize.base?.toString(),quote:n.minimumOrderSize.quote?.toString()}}},"serializeOptions");switch(t.type){case"buy":return JSON.stringify({...r,buyCaip19:t.buyCaip19,sellCaip19:t.sellCaip19,takerCaip19:t.takerCaip19,takerDestinationCaip19:t.takerDestinationCaip19,options:o(t.options)});case"sell":return JSON.stringify({...r,sellCaip19:t.sellCaip19,buyCaip19:t.buyCaip19,takerCaip19:t.takerCaip19,takerDestinationCaip19:t.takerDestinationCaip19,options:o(t.options)});case"swap":return JSON.stringify({...r,network:t.network,sellCaip19:t.sellCaip19,buyCaip19:t.buyCaip19,takerCaip19:t.takerCaip19,takerDestinationCaip19:t.takerDestinationCaip19,options:o(t.options)});case"prediction":return JSON.stringify({...r,network:t.network,mode:t.mode,outcomeType:t.outcomeType,mintAccounts:t.mintAccounts,takerCaip19:t.takerCaip19,takerDestinationCaip19:t.takerDestinationCaip19,options:o(t.options)});default:let n=t;return JSON.stringify(r)}}get(t){return this.entries.get(this.getKey(t))}peek(t){return this.entries.get(this.getKey(t))}set(t,r){let o=this.getKey(t);if(this.entries.set(o,r),this.entries.size>this.capacity){let n=Array.from(this.entries.keys())[0];this.entries.delete(n)}}delete(t){this.entries.delete(this.getKey(t))}clear(){this.entries.clear()}};var gv=2,Hc=new jc(new On(new Mn),gv);var $S=(0,Dt.createContext)(null);function hv({children:e,processorMode:t="noOp"}){let{data:r}=_e(),o=wt(),n=(0,Dt.useMemo)(()=>qy(o),[o]);(0,Dt.useEffect)(()=>{n.initialize()},[n]);let a=(0,Dt.useMemo)(()=>WS(t,n),[t,n]);(0,Dt.useEffect)(()=>{r&&(a.setAccount(r),Hc.setMultiChainAccount(r))},[r,a]);let c=Ni();return(0,Dt.useEffect)(()=>{c&&Hc.setCashAddresses(c)},[c,a]),Dt.default.createElement(jS,{value:n},Dt.default.createElement($S.Provider,{value:a},e))}s(hv,"SwapperProvider");function ot(){let e=(0,Dt.useContext)($S);return e||WS("noOp")}s(ot,"useSwapper");function WS(e,t){let r=new Kc(new Li,new rc(t),new Tc(new sc(or?new nc:new oc),e==="noOp"?new yc:new hc));return r.setInitializer(Hc),r}s(WS,"createSwapper");u();l();var ZS=D(L());var yv=s(e=>{let t=wt(),r=Qn(),{t:o}=Ie(),n=(0,ZS.useRef)(void 0),a=Af.pendingTransactionById(e);return ae({queryKey:a,queryFn:s(async()=>{try{let m=(await Rf(t))[e],d=m?void 0:r.getPendingBridgeTransactionById(e,o),f=m??d;return f?(Dm(f,n.current)||(n.current=f),n.current):void 0}catch(p){throw P.captureError(p,M.Transaction),p}},"queryFn"),refetchInterval:z({milliseconds:200}),staleTime:z({milliseconds:200}),gcTime:0,refetchOnMount:!0})},"usePendingTransactionByIdWithBridge");u();l();var Kr=D(L());u();l();var Fr=s(e=>{let t=Math.floor(e/3600),r=Math.floor((e-t*3600)/60),o=e%60;if(t>0)return v.t("swapProviderEstimatedTimeHM",{hours:t,minutes:r});if(r>0){let n=o>0?r+1:r;return v.t("swapProviderEstimatedTimeM",{minutes:n})}return v.t("swapProviderEstimatedTimeS",{seconds:o})},"formatSecondsAsSwapTime");u();l();var $c=s(e=>e.steps.reduce((t,r)=>t.plus(new U(r.nonIncludedNonGasFees)),new U(0)),"getBridgeStepsFees"),qn=s(e=>e.steps.flatMap(o=>o.feeCosts).reduce((o,n)=>o.plus(n.amountUSD??0),new U(0)),"getBridgeStepsFeesInUsd");u();l();var yo=s(e=>e&&se(e)?e.executionDuration:0,"getSwapExecutionDuration");var wv=s(({selectProvider:e})=>{let{currencySymbol:t,fromUsd:r}=mt(),o=ot(),[n,a]=(0,Kr.useState)(!1),[c,p]=(0,Kr.useState)(o.getQuoteProcessorState());(0,Kr.useEffect)(()=>{let h=o.subscribeQuoteProcessor({onStateChange(w,y){p(y)}});return()=>h()},[o]);let[m,d]=(0,Kr.useState)(o.getTokenState());return(0,Kr.useEffect)(()=>{let h=o.subscribeToken({onStateChange(w,y,S){d(S)}});return()=>h()},[o]),{details:(0,Kr.useMemo)(()=>{if(c.type!=="quoteProcessed"&&c.type!=="firstQuoteReceived"||m.type!=="pair")return[];let h=c.quote,w=Av(h),y=h.baseProvider.name,S=Tv({currentQuote:h,buyToken:m.buyToken,sellToken:m.sellToken,isFlipped:n,setIsFlipped:a});return se(h)?bv({quote:h,selectProvider:e,exchangeRate:S,currencySymbol:t,fromUsd:r}):Sv({provider:y,sources:w,exchangeRate:S,selectProvider:e})},[c,m,e,t,r,n]),footnote:v.t("swapProviderPricingFootnote")}},"useSwapPricing"),Sv=s(({provider:e,sources:t,exchangeRate:r,selectProvider:o})=>[{label:v.t("swapProviderPricingProvider"),value:e,icon:"chevron-right",onPress:o},{label:v.t("swapProviderPricingMarket"),value:t},{label:v.t("swapProviderPricingPrice"),value:r.rate,icon:"swap",onPress:r.flip}],"getStandardRows"),bv=s(({quote:e,selectProvider:t,exchangeRate:r,currencySymbol:o,fromUsd:n})=>{let a=e.baseProvider.name,c=qn(e).toString(),p=Fr(yo(e));return[{label:v.t("swapProviderPricingProvider"),value:a,icon:"chevron-right",onPress:t},{label:v.t("swapProviderPricingPrice"),value:r.rate,icon:"swap",onPress:r.flip},{label:v.t("swapProviderPricingFees"),value:`${o}${n(Number(c),2)} ${v.t("swapProvidersFee")}`},{label:v.t("swapProviderPricingTime"),value:p}]},"getBridgeRows");function Tv({currentQuote:e,buyToken:t,sellToken:r,isFlipped:o,setIsFlipped:n}){let{exchangeRate:a,exchangeRateFlipped:c}=yp(e,t,r);return{rate:o?c:a,flip:s(()=>n(!o),"flip")}}s(Tv,"getExchangeRate");function Av(e){return Re(Oe(e))}s(Av,"getSources");u();l();u();l();var Vr=D(L());function xv(e){let t=Qn(),{t:r}=Ie(),[o,n]=(0,Vr.useState)(0),[a,c]=(0,Vr.useState)(0),[p,m]=(0,Vr.useState)(0);return(0,Vr.useEffect)(()=>{let f={onBridgeStatusChange:s(h=>{n(w=>w+1),(h.type==="completed"||h.type==="failed")&&c(w=>w+1)},"onBridgeStatusChange")};return t.addListener(f),()=>{t.removeListener(f)}},[t]),(0,Vr.useEffect)(()=>{let f=setInterval(()=>{m(h=>h+1)},z({minutes:1}));return()=>clearInterval(f)},[]),{pendingBridgeTransactions:(0,Vr.useMemo)(()=>e.length?t.getPendingBridgeTransactions(r,{addresses:e}):[],[t,e,r,o,p,a])}}s(xv,"useBridgePendingActivities");u();l();var jr=D(L());var Ev={"BitcoinNative-bip122_p2wpkh":he.BitcoinNativeSegwit,"BitcoinNative-bip122_p2tr":he.BitcoinTaproot,BitcoinNative:he.BitcoinTaproot};function YS(e){return Ev[e]??null}s(YS,"normalizeBitcoinFungibleKey");function XS(e,t){let r=YS(e),o=YS(t);return r&&o?r===o:e===t}s(XS,"doBitcoinFungibleKeysMatch");function kv(e,t,r){let o=Qn(),{t:n}=Ie(),[a,c]=(0,jr.useState)(0),[p,m]=(0,jr.useState)(0);(0,jr.useEffect)(()=>{let w={onBridgeStatusChange:s(y=>{c(S=>S+1),(y.type==="completed"||y.type==="failed")&&m(S=>S+1)},"onBridgeStatusChange")};return o.addListener(w),()=>{o.removeListener(w)}},[o]);let d=(0,jr.useMemo)(()=>e.length?o.getPendingBridgeActivities(n,{addresses:e}):[],[o,e,n,a,p]),f=(0,jr.useMemo)(()=>e.length?o.getPendingBridgeTransactions(n,{addresses:e}):[],[o,e,n,a,p]);return{pendingBridgeTransactions:(0,jr.useMemo)(()=>{if(!f.length||!d.length)return[];let w=new Map(d.map(T=>[T.record.executionId,T.record])),y=x.isBitcoinNetworkID(r),S=t;return f.filter(T=>{let b=w.get(T.id);if(!b)return!1;let A=b.quote.sell,E=b.quote.buy;if(!A&&!E)return!1;if(A){let C=A.data.key;if(y&&XS(S,C))return!0;let I=X(A),N=ko(I)?.[0];if(N&&S===N)return!0}if(E){let C=E.data.key;if(y&&XS(S,C))return!0;let I=X(E),N=ko(I)?.[0];if(N&&S===N)return!0}return!1})},[f,d,t,r])}}s(kv,"useFungibleBridgePendingActivities");u();l();u();l();function Qo(e){return{chain:ne.Solana,type:"fungible",address:e.type===oe.SPL?e.data.mintAddress:void 0,symbol:e.data.symbol??""}}s(Qo,"getAnalyticsAsset");var Wc=class{static{s(this,"NextGenAnalytics")}analytics;additionalAnalyticsTags;constructor(t,r){this.analytics=t,this.additionalAnalyticsTags=r}captureEvent(t,r){let o={...r,data:{...r.data,...this.additionalAnalyticsTags}};this.analytics.capture(t,o)}swapperOpen(t,r,o){this.captureEvent("swapperOpen",{data:{uiContext:o??"swapperInterstitial",swapMode:t,comingFrom:r}})}swapperClose(t,r){this.captureEvent("swapperClose",{data:{uiContext:r??"swapperInterstitial",reason:t}})}swapperUpdateAsset(t,r){switch(t.type){case"sell":this.captureEvent("swapperUpdateToAsset",{data:Qo(r)});break;case"buy":this.captureEvent("swapperUpdateFromAsset",{data:Qo(r)});break}}swapperSwapDefaultQuoteSelected(t){this.captureEvent("swapperSwapDefaultQuoteSelected",{data:{quotePercentageValue:t}})}swapperDetailPanelClicked(){this.captureEvent("swapperDetailPanelClicked",{data:{uiContext:"swapperInterstitial"}})}swapperToggleQuoteCurrency(){this.captureEvent("swapperToggleQuoteCurrency",{data:{uiContext:"swapperInterstitial"}})}swapperQuotesResult(t,r,o){this.captureEvent("swapperQuotesResult",{data:{...ma(t,o),numQuotes:r.quotes.length,sellToken:O(X(t.sell)),buyToken:O(X(t.buy)),fromNetworkId:t.sell.data.chain.id,toNetworkId:t.buy.data.chain.id,isGasless:r.quotes.some(n=>"gaslessSwapFeeResult"in n&&n.gaslessSwapFeeResult?.success===!0)}})}swapperQuotesError({input:t,quoteError:r}){this.captureEvent("swapperQuotesError",{data:{...ma(t),error:r.name}})}};function ma(e,t){let r=t?Cv(t):void 0;return{isSellTokenVerified:ri({minimum:ie.Verified,spamStatus:e.sell.data.spamStatus}),sellTokenCaip19:O(X(e.sell)),sellTokenNetworkId:e.sell.data.chain.id,sellTokenSymbol:e.sell.data.symbol??void 0,sellTokenMarketCap:e.sell.data.marketCap,sellTokenAmount:e.amount,buyTokenCaip19:O(X(e.buy)),buyTokenNetworkId:e.buy.data.chain.id,buyTokenSymbol:e.buy.data.symbol??void 0,isAutoSlippageEnabled:e.autoSlippage,manualSlippagePercent:e.slippageTolerance,isExactOut:e.exactOut,isManualTipInput:e.tipAmount!==void 0,gaslessError:r?.error,gaslessAtaFeeUSD:r?.data?.ataFeeUSD,gaslessNetworkFeeUSD:r?.data?.networkFeeUSD,gaslessTotalAmountUSD:r?.data?.totalAmountUSD}}s(ma,"createSwapperAnalyticsFields");function rd(e){if(e.type==="quoteProcessed")return ma(e.input,e.quote)}s(rd,"createSwapperAnalyticsFieldsFromQuoteProcessorState");function Cv(e){if(It(e))return e.gaslessSwapFeeResult}s(Cv,"getGaslessSwapFeeResult");u();l();var zn=D(L());var _v=(0,zn.createContext)(void 0);var JS=s(()=>{let e=(0,zn.useContext)(_v);if(!e)throw new Error("useSwapToken must be used within a SwapTokenProvider");return e},"useSwapToken");u();l();function eb(e,t,r,o){let a=t.find(p=>p.percentage===1)?.amount;if(o==="sell"&&a&&new U(e).gt(a))return["insufficientBalance"];let c=r.type==="buy"?r.options?.minimumOrderSize?.quote:r.options?.minimumOrderSize?.base;return c!=null&&new U(e).lt(c)?["minimumBalance"]:[]}s(eb,"createQuoteInputErrors");u();l();var Iv=[.25,.5,1],od=class{static{s(this,"SellPercentage")}percentage;amount;fiatAmount;constructor(t,r,o){this.percentage=t,this.amount=r,this.fiatAmount=o}getAmountForDenomination(t){return t==="crypto"?this.amount:this.fiatAmount}};function tb({maxSellAmount:e,sellTokenPrice:t,allowedPercentages:r=Iv}){return r.map(o=>{let n=e.multipliedBy(o);return new od(o,n,n.multipliedBy(t?.usd??0))})}s(tb,"getSellPercentages");u();l();var sd=D(L());u();l();var Gn=s(()=>vt({key:Ce.PriorityFee,queryKey:ye.priorityFee()}),"usePriorityFee"),qY=s(()=>Pt({key:Ce.PriorityFee,queryKey:ye.priorityFee()}),"useSetPriorityFee");u();l();var Kn=s(()=>vt({key:Ce.TipAmount,queryKey:ye.tipAmount()}),"useTip"),$Y=s(()=>Pt({key:Ce.TipAmount,queryKey:ye.tipAmount()}),"useSetTip");u();l();function nd(e){return new _(e??0).multipliedBy(10**Qm.tokenDecimals)}s(nd,"getCustomFee");u();l();var Fv=3,vv=new U(356190),Pv=s(e=>Xt.get(e).averageNetworkFee.times(Fv),"getNetworkFeeBuffer");function rb({sellFungible:e,totalFees:t,transactionSpeedsToUnitCost:r,minRequiredBalance:o,customPriorityFee:n,customTip:a,isBridge:c=!1}){let{decimals:p,amount:m,balance:d,chain:f}=e.data,h=m?new U(m):d?new U(d).multipliedBy(Wa(p)):new U(0),w=St(e.type),y=je(e),{source:S,destination:T}=o;if(y)return nl(h.toString(),p);let A=Rv({isNativeToken:w,network:f,totalFees:t,isBridge:c,transactionSpeedsToUnitCost:r,customPriorityFee:n,customTip:a}).plus(T),E=w?Dv(h,A,S):h.toString();return nl(E,p)}s(rb,"getMaxSellAmount");function Rv({isNativeToken:e,network:t,totalFees:r,isBridge:o,transactionSpeedsToUnitCost:n,customPriorityFee:a,customTip:c}){if(!e)return r;let p=Xt.get(t.id),m=o?p.bridgeDefaultFee:p.swapDefaultFee,d=n?.[br.standard];return Pf(d)&&(m=vv.multipliedBy(d.maxFeePerGas.plus(d.maxPriorityFeePerGas))),x.isSolanaNetworkID(t.id)&&a&&(m=m.plus(a)),x.isSolanaNetworkID(t.id)&&c&&(m=m.plus(c)),m.plus(Pv(t.id))}s(Rv,"calculateFees");function Dv(e,t,r){let o=r.plus(t);return e.gt(o)?e.minus(o).toString():e.toString()}s(Dv,"calculateNativeTokenMaxSell");u();l();var fa=D(L());var ob=s(e=>{let t=e?.data.chain.id,{data:r}=_e(),o=(0,fa.useMemo)(()=>r?.addresses.find(a=>a.networkID===t),[r,t]),{data:n=0}=Co(o);return(0,fa.useMemo)(()=>new _(n),[n])},"useSourceMinRequiredBalance"),nb=s((e,t)=>{let r=e?.data.chain.id,n=t?.data.chain.id??r,{data:a}=_e(),c=(0,fa.useMemo)(()=>a?.addresses.find(m=>m.networkID===n),[a,n]),{data:p=0}=Co(c);return(0,fa.useMemo)(()=>t?.data.amount||t?.data.balance&&new _(t.data.balance).gt(0)?new _(0):new _(p),[t?.data.amount,t?.data.balance,p])},"useDestinationMinRequiredBalance");function sb(e){let t=e.type==="pair"?e.sellToken:null,r=e.type==="pair"?e.buyToken:null,o=ob(t),n=nb(t,r),{data:a}=cg({networkID:t?.data.chain.id}),{data:c}=Gn(),{data:p}=Kn(),m=(0,sd.useMemo)(()=>!t||!r?!1:$t(t.data.chain.id,r.data.chain.id),[t,r]);return(0,sd.useMemo)(()=>t?rb({sellFungible:t,totalFees:new _(0),transactionSpeedsToUnitCost:x.isEVMNetworkID(t.data.chain.id)?a:void 0,isBridge:m,minRequiredBalance:{source:o,destination:n},customPriorityFee:nd(c??0),customTip:nd(p??0)}):"0",[t,a,m,o,n,c,p])}s(sb,"useGetMaxSellAmount");u();l();var Hr=We(e=>({preferredProvider:void 0,setPreferredProvider:s(t=>e({preferredProvider:t}),"setPreferredProvider")}));u();l();var pb=D(L());u();l();var ab=s(()=>vt({key:Ce.SlippageTolerance,queryKey:ye.slippageTolerance()}),"useSlippageTolerance"),GX=s(()=>Pt({key:Ce.SlippageTolerance,queryKey:ye.slippageTolerance()}),"useSetSlippageTolerance");u();l();var ib=D(L());var Vn;(function(e){e.Auto="auto",e.Fixed="fixed"})(Vn||(Vn={}));var Nv={type:Vn.Auto},cb=s(()=>{let{priorityFeeSetting:e,isFetched:t,save:r}=Bv();return{isFetched:t,selectedSetting:e,setPriorityFeeSetting:r}},"usePriorityFeeSettings"),Bv=s(()=>{let{data:e,isFetched:t}=vt({key:Ce.PriorityFeeSettings,queryKey:ye.priorityFeeSettings()}),{mutateAsync:r}=Pt({key:Ce.PriorityFeeSettings,queryKey:ye.priorityFeeSettings()}),o=(0,ib.useCallback)(async n=>{await r(n)},[r]);return{isFetched:t,priorityFeeSetting:e??Nv,save:o}},"usePriorityFeeSettingsStore");u();l();var ub=D(L());var jn;(function(e){e.Auto="auto",e.Fixed="fixed"})(jn||(jn={}));var Lv={type:jn.Auto},lb=s(()=>{let{tipSetting:e,isFetched:t,save:r}=Uv();return{isFetched:t,selectedSetting:e,setTipSetting:r}},"useTipSettings"),Uv=s(()=>{let{data:e,isFetched:t}=vt({key:Ce.TipSettings,queryKey:ye.tipSettings()}),{mutateAsync:r}=Pt({key:Ce.TipSettings,queryKey:ye.tipSettings()}),o=(0,ub.useCallback)(async n=>{await r(n)},[r]);return{isFetched:t,tipSetting:e??Lv,save:o}},"useTipSettingsStore");var db=s(()=>{let{selectedSetting:e}=co(),{data:t}=ab(),{data:r}=Gn(),{selectedSetting:o}=cb(),{data:n}=Kn(),{selectedSetting:a}=lb(),c=Hr(d=>d.preferredProvider),p=tn("kill-swapper-simulation")??!1;return(0,pb.useMemo)(()=>({slippageTolerance:t??void 0,priorityFee:o.type==="fixed"?r??void 0:void 0,tipAmount:a.type==="fixed"?n??void 0:void 0,slippageType:e.type,preferredProvider:c,isSimulationKilled:p}),[t,r,o.type,n,a.type,e,c,p])},"useQuoteConfig");u();l();var mb=D(L());var fb=s(()=>{let{data:e,isFetched:t}=Gn(),{data:r,isFetched:o}=Kn();return(0,mb.useMemo)(()=>{if(!t||!o||!e&&!r)return;let n={};return e&&(n.priorityFee=new _(e)),r&&(n.tip=new _(r)),n},[t,o,e,r])},"useSwapModeSettings");u();l();var gt=D(L());var Mv=s((e,t=[],r)=>{let o=ot(),n=Se(),a;try{a=JS().nextGenAnalytics}catch{}let c=(0,gt.useMemo)(()=>a||new Wc(n,r),[n,r,a]),p=Ke("enable-be-swapper-max-amount"),[m,d]=(0,gt.useState)([]),[f,h]=(0,gt.useState)(o.getTokenState());(0,gt.useEffect)(()=>{let F=o.subscribeToken({onStateChange(G,W,re){h(re)}});return()=>F()},[o,h]);let[w,y]=(0,gt.useState)(o.getQuoteProcessorState());(0,gt.useEffect)(()=>{let F=o.subscribeQuoteProcessor({onStateChange:s((G,W)=>{W.type==="firstQuoteReceived"&&c.swapperQuotesResult(W.input,W.response,W.quote),y(W),go.processQuoteProcessorState(W)},"onStateChange")});return()=>{o.stopQuoteProcessor(),F()}},[o,c]);let S=(0,gt.useMemo)(()=>Qv(f,w),[f,w]),T=db();(0,gt.useEffect)(()=>{o.setQuoteConfig(T)},[T,o]);let b=sb(f),A=(0,gt.useMemo)(()=>bt(f)?tb({sellTokenPrice:f.sellTokenPrice,allowedPercentages:t,maxSellAmount:p?f.maxSellAmount:new _(b)}):[],[f,t,p,b]),E=Hr(F=>F.setPreferredProvider);(0,gt.useEffect)(()=>{let F=o.subscribeToken({onStateChange(G,W,re){G.type==="initializeStarted"&&E(void 0)}});return()=>F()},[o,E]);let C=(0,gt.useCallback)(({amount:F,denomination:G,perspective:W,tokenStateOverride:re})=>{try{let Z=Ov(re??f,F,G,W),He=eb(Z,A,e,W);d(He),E(void 0),o.setAmount({amount:Z,perspective:W},{...T,preferredProvider:void 0})}catch(Z){P.captureError(Z,M.Swapper)}},[f,A,e,E,o,T]),{connection:I}=dn(),N=wt(),Q=on(),R=Qa(),H=v.language,q=tn("kill-swapper-simulation")??!1,k=(0,gt.useCallback)(async F=>{F.forEach(W=>o.subscribeExecution(W));let G=await n.getDeviceId();await o.swap({signer:Q,storage:N,locale:H,deviceId:G,connection:I,authRepository:R,isSimulationKilled:q}),F.forEach(W=>o.unsubscribeExecution(W))},[o,n,Q,N,H,I,R,q]);return{setAmount:C,swap:k,tokenState:f,quoteProcessorState:w,quotedAmounts:S,inputErrors:m,sellPercentages:A}},"useSwapperQuotes");function Ov(e,t,r,o){if(!bt(e))throw new Error("Token state is not a pair");let{sellTokenPrice:n,sellToken:a,buyToken:c,buyTokenPrice:p}=e;switch(r){case"fiat":switch(o){case"buy":if(!p?.usd)throw new Error("Token price not found");return new _(t).dividedBy(p.usd).decimalPlaces(c.data.decimals).toString();case"sell":if(!n?.usd)throw new Error("Token price not found");return new _(t).dividedBy(n.usd).decimalPlaces(a.data.decimals).toString()}break;case"crypto":switch(o){case"buy":return new _(t).decimalPlaces(c.data.decimals).toString();case"sell":return new _(t).decimalPlaces(a.data.decimals).toString()}break}}s(Ov,"parseAmount");function Qv(e,t){if(!bt(e)||t.type!=="firstQuoteReceived"&&t.type!=="quoteProcessed")return;let r=t.quote,{sellToken:o,buyToken:n,sellTokenPrice:a,buyTokenPrice:c}=e;return{buyAmount:new _(r.buyAmount).shiftedBy(-n.data.decimals),buyAmountUsd:c?.usd?new _(r.buyAmount).shiftedBy(-n.data.decimals).multipliedBy(c.usd):void 0,sellAmount:new _(r.sellAmount).shiftedBy(-o.data.decimals),sellAmountUsd:a?.usd?new _(r.sellAmount).shiftedBy(-o.data.decimals).multipliedBy(a.usd):void 0}}s(Qv,"parseQuoteAmounts");u();l();function gb(e){switch(e.type){case Te.SlippageExceeded:return v.t("swapTxConfirmationSwapFailedSlippageLimit");case Te.InsufficientFunds:return v.t("swapTxConfirmationSwapFailedInsufficientBalance");case Te.InsufficientGas:return v.t("swapTxConfirmationSwapFailedInsufficientGas");case Te.AccountFrozen:return v.t("swapTxConfirmationSwapFailedAcountFrozen");case Te.SimulationTimeout:return v.t("swapTxConfirmationSwapFailedSimulationTimeout");case Te.StaleQuote:return v.t("swapTxConfirmationSwapFailedStaleQuote");case Te.UnknownError:return v.t("swapTxConfirmationSwapFailedSimulationUnknownError");default:return v.t("swapTxConfirmationSwapFailedTryAgain")}}s(gb,"getSimulationErrorMessage");u();l();var lr=D(L());u();l();var ad=class{static{s(this,"FullBalanceDisplayStrategy")}format(t,r){return`${ar(t)} ${r}`}},id=class{static{s(this,"CompactBalanceDisplayStrategy")}format(t,r){return`${pn(t,{compact:!0})} ${r}`}},cd=class{static{s(this,"CompactNoSymbolBalanceDisplayStrategy")}format(t){return pn(t,{compact:!0})}};function ud(e){switch(e){case"full":return new ad;case"compact":return new id;case"compactNoSymbol":return new cd}}s(ud,"createBalanceDisplayStrategy");u();l();var Zc=class{static{s(this,"DefaultGetSwapQuotesStrategy")}async fetch(t){return await Bi(t)}stopFetching(){}getFetchInterval(t){return t}};u();l();u();l();var Hn=class{static{s(this,"QuoteLoggerExecuteSwapStateListener")}streamedQuoteLogger;constructor(t){this.streamedQuoteLogger=t}onStateChange(t,r,o){o.type===be.TransactionSubmitted&&this.streamedQuoteLogger.logState(o.txReceipt.id)}};u();l();u();l();u();l();var Yc=s((e,t,r)=>{if(r)return Ee(e,t).times(_(r)).toNumber()},"getAssetVolumeUsd"),hb=s((e,t)=>t&&e?t>e?t:e:t??e,"getTotalUsdVolume");function yb({buyAssetUsdValue:e,buyToken:t,sellAssetUsdValue:r,sellToken:o,buyAmount:n,sellAmount:a,phantomFeeUiAmount:c,priceImpact:p,provider:m,baseProvider:d,slippageTolerance:f,slippageType:h,sellSwapFilter:w,isRetry:y,analyticsContext:S}){if(t&&o){let T=Yc(n,t.data.decimals,e),b=Yc(a,o.data.decimals,r),A=hb(T,b);return{networkId:o.data.chain.id,chainId:x.getChainID(o.data.chain.id),toNetworkId:t.data.chain.id,toChainId:x.getChainID(t.data.chain.id),isBridge:o.data.chain.id!==t.data.chain.id,marketName:`${o.data.symbol}/${t.data.symbol}`,tradeDirection:"sell",swapSource:m,baseProvider:d,priceImpact:p,fromAssetSymbol:o.data.symbol??"",fromAssetAddress:o.data.tokenAddress,fromAssetAmount:Ee(a,o.data.decimals),fromAssetUsdPrice:r,fromAssetUsdVolume:b,toAssetSymbol:t.data.symbol??"",toAssetAddress:t.data.tokenAddress,toAssetAmount:Ee(n,t.data.decimals),toAssetUsdPrice:e,toAssetUsdVolume:T,totalUsdVolume:A,feeUsd:c,slippageTolerance:f,slippageType:h,sellSwapFilter:w,isRetry:y,analyticsContext:S}}return null}s(yb,"legacyAnalyticsPayload");function Xc({buyAssetUsdValue:e,buyToken:t,sellAssetUsdValue:r,sellToken:o,quote:n,slippageTolerance:a,slippageType:c,sellSwapFilter:p,isRetry:m,analyticsContext:d,baseProvider:f}){if(t&&o){let{buyAmount:h,sellAmount:w}=n,y="priceImpact"in n?n.priceImpact:0,S="sources"in n?Re(n.sources):"",T=("fees"in n?n.fees.find(C=>C.type==="phantom")?.amount.toString():"")??"",b=Yc(h,t.data.decimals,e),A=Yc(w,o.data.decimals,r),E=hb(b,A);return{chainId:o.data.chain.id??t.data.chain.id,swap:{marketName:`${o.data.symbol}/${t.data.symbol}`,tradeDirection:"sell",swapSource:S,priceImpact:y,fromAssetSymbol:o.data.symbol??"",fromAssetAddress:o.data.tokenAddress??"",fromAssetAmount:Ee(w,o.data.decimals),fromAssetUsdPrice:r??0,fromAssetUsdVolume:A??0,toAssetSymbol:t.data.symbol??"",toAssetAddress:t.data.tokenAddress??"",toAssetAmount:Ee(h,t.data.decimals),toAssetUsdPrice:e,toAssetUsdVolume:b,totalUsdVolume:E??0,feeUsd:Number(T),slippageTolerance:a,slippageType:c,sellSwapFilter:p,isRetry:m,analyticsContext:d,baseProvider:f}}}return null}s(Xc,"analyticsPayload");function wb({buyAssetUsdValue:e,buyToken:t,sellAssetUsdValue:r,sellToken:o,buyAmount:n,sellAmount:a,phantomFeeUiAmount:c,priceImpact:p,provider:m,baseProvider:d,slippageTolerance:f,transactionId:h,slippageType:w,sellSwapFilter:y,isRetry:S,analyticsContext:T}){let b=yb({buyAssetUsdValue:e,buyToken:t,sellAssetUsdValue:r,sellToken:o,buyAmount:n,sellAmount:a,phantomFeeUiAmount:c,priceImpact:p,provider:m,baseProvider:d,slippageTolerance:f,slippageType:w,sellSwapFilter:y,isRetry:S,analyticsContext:T});return b?{data:{...b,id:h}}:{}}s(wb,"getAnalyticsPayload");u();l();var Sb=s(({txReceipt:e,networkID:t,amountType:r,swapAnalytics:o,walletAddress:n})=>{let a=Cs(t);P.addBreadcrumb(M.Swapper,"submittedTransaction",Y.Info,{...a,txReceipt:e.id,method:a.chainType===he.Solana?"signAndSendTransaction":a.chainType===he.EVM?"eth_sendRawTransaction":a.chainType===he.Sui?"signAndExecuteTransaction":"UNKNOWN"}),a.chainType===he.Solana?o.submittedTransaction(e.id,{...a,method:"signAndSendTransaction",swapType:r==="sell"?"exactIn":"exactOut",walletAddress:n}):a.chainType===he.EVM?o.submittedTransaction(e.id,{...a,method:"eth_sendRawTransaction",swapType:r==="sell"?"exactIn":"exactOut",walletAddress:n}):a.chainType===he.Sui&&o.submittedTransaction(e.id,{...a,method:"signAndExecuteTransaction",swapType:r==="sell"?"exactIn":"exactOut",walletAddress:n})},"logTransactionSubmitted");u();l();var bb=D(L());var qv={calculate(e){let t=(e?.fees??[]).find(r=>r.type==="phantom");return{amount:new _(t?.amount??0),amountUsd:null,pct:t?.percentage??0}}},zv={calculate(e){let t=e.steps.flatMap(r=>r.feeCosts).find(r=>r.name==="phantom");return{amount:new _(t?.amount??0),amountUsd:null,pct:parseFloat(t?.percentage??"0")}}},Tb=s(()=>{let{currentQuote:e}=rt();return{phantomFee:(0,bb.useMemo)(()=>ld(e),[e])}},"usePhantomFee");function ld(e){return Ar(e)?qv.calculate(e):se(e)?zv.calculate(e):ho}s(ld,"calculatePhantomFee");u();l();var Ab=s(e=>e?se(e)?void 0:e.priceImpact:0,"getSwapPriceImpact");u();l();var xb=We(e=>({lastFailedSwap:void 0,setLastFailedSwap:s(t=>{e({lastFailedSwap:t})},"setLastFailedSwap")}));function Eb(){return xb.getState().lastFailedSwap}s(Eb,"getLastFailedSwap");function pd(e){xb.getState().setLastFailedSwap(e)}s(pd,"setLastFailedSwap");var $n=class{static{s(this,"AnalyticsExecuteSwapStateListener")}swapAnalytics;analytics;uiContext;additionalAnalyticsTags;constructor(t,r,o="swapperClassic",n){this.swapAnalytics=t,this.analytics=r,this.uiContext=o,this.additionalAnalyticsTags=n}captureEvent(t,r){let o={...r,data:{...r?.data,...this.additionalAnalyticsTags}};this.analytics.capture(t,o)}onStateChange(t,r,o,n){switch(t.type){case j.ExecuteSwapStarted:this.captureEvent("swapperSwap",{data:{...this.createAnalyticsPayload(o.executingQuote).data,uiContext:this.uiContext}});let a=Xc({buyAssetUsdValue:o.executingQuote.buy.data.usd,buyToken:o.executingQuote.buy,sellAssetUsdValue:o.executingQuote.sell.data.usd,sellToken:o.executingQuote.sell,quote:o.executingQuote.quote,slippageTolerance:this.parseSlippageTolerance(o.executingQuote.slippageType,o.executingQuote.quote,o.executingQuote.response),slippageType:o.executingQuote.slippageType,sellSwapFilter:V.getState().swapFilter,isRetry:this.isRetry(o.executingQuote),analyticsContext:o.executingQuote.quote.analyticsContext,baseProvider:o.executingQuote.quote.baseProvider?.id??""});a&&(P.addBreadcrumb(M.Swapper,"approved",Y.Info,en(a.swap)),this.swapAnalytics.approved(a));break;case j.SimulationFailed:t.error.type!==Te.SlippageExceeded&&P.captureError(t.error,M.Swapper),this.captureEvent("swapperSwapFailure",{data:{...this.createAnalyticsPayload(o.executingQuote).data,error:Gv(t.error)}});break;case j.TransactionSubmissionFailed:P.captureError(t.error,M.Swapper),t.error.type==="noSignature"&&this.captureEvent("swapperSwapFailureNoSignature"),this.captureEvent("swapperSwapFailure",{data:{...this.createAnalyticsPayload(o.executingQuote).data,error:t.error.message,uiContext:this.uiContext}});break;case j.TransactionSubmissionSuccess:Sb({txReceipt:t.txReceipt,networkID:t.txReceipt.networkID,amountType:o.executingQuote.amount.perspective==="buy"?"buy":"sell",swapAnalytics:this.swapAnalytics});break;case j.TransactionConfirmationFailed:let c=Bc(t.error);P.captureError(t.error,M.Swapper),this.captureEvent("swapperSwapFailure",{data:{...this.createAnalyticsPayload(o.executingQuote).data,error:c.message,uiContext:this.uiContext}});let p=Cs(t.txReceipt.networkID),m={chainId:x.getChainID(t.txReceipt.networkID),networkId:t.txReceipt.networkID},d=t.txReceipt;switch(this.captureEvent("waitForTransactionConfirmationError",{data:{...m,errorMessage:c.message}}),p.chainType){case he.EVM:case he.Solana:case he.Sui:P.addBreadcrumb(M.Swapper,"transactionStatus",Y.Error,{...p,txReceipt:d.id}),this.swapAnalytics.transactionStatus(d.id,{...p,status:{type:"error"}});break}break;case j.TransactionConfirmed:this.captureEvent("swapperSwapSuccess",{data:{...this.createAnalyticsPayload(o.executingQuote,t.txReceipt).data,uiContext:this.uiContext}});let f=Cs(t.txReceipt.networkID);switch(P.addBreadcrumb(M.Swapper,"transactionStatus",Y.Info,{...f,txReceipt:t.txReceipt.id}),f.chainType){case he.EVM:case he.Solana:case he.Sui:this.swapAnalytics.transactionStatus(t.txReceipt.id,{...f,status:{type:"confirmed"}});break}break}this.isFailureEvent(t)?pd(o.executingQuote):t.type===j.TransactionSubmissionSuccess&&pd(void 0)}createAnalyticsPayload(t,r){let o=t.quote,n=V.getState(),a=wb({buyToken:t.buy,sellToken:t.sell,buyAmount:o.buyAmount.toString(),sellAmount:o.sellAmount.toString(),phantomFeeUiAmount:ld(o).amountUsd?.toString()??"",priceImpact:Ab(o),provider:Re(Oe(o)),buyAssetUsdValue:n.buyUsdValue,sellAssetUsdValue:n.sellUsdValue,slippageTolerance:this.parseSlippageTolerance(t.slippageType,o,t.response),transactionId:r?.id??"",slippageType:t.slippageType,sellSwapFilter:n.swapFilter,isRetry:this.isRetry(t),analyticsContext:t.quote.analyticsContext,baseProvider:t.quote.baseProvider?.id??""}),c=t.quoteInput;return c?{data:{...a.data,...ma(c,o)}}:a}parseSlippageTolerance(t,r,o){switch(t){case ce.Fixed:return o.slippageTolerance;case ce.Auto:return Ar(r)?r.slippageTolerance:o.slippageTolerance}}isRetry(t){let r=Eb();if(!r)return!1;let o=O(X(r.buy)),n=O(X(r.sell)),a=O(X(t.buy)),c=O(X(t.sell));return o===a&&n===c}isFailureEvent(t){switch(t.type){case j.SimulationFailed:case j.TransactionSubmissionFailed:case j.TransactionConfirmationFailed:return!0;default:return!1}}};function Gv(e){switch(e.type){case Te.SlippageExceeded:return $.SlippageExceeded;case Te.InsufficientFunds:return $.InsufficientFunds;case Te.InsufficientGas:return $.InsufficientGas;case Te.AccountFrozen:return $.AccountFrozen;case Te.StaleQuote:return $.StaleQuote;case Te.SimulationTimeout:return $.SimulationTimeout;case Te.UnknownError:return $.SimulationUnknownError;case Te.SimulationFailed:return"SIMULATION_FAILED";default:return $.NotValidScanResultsError}}s(Gv,"toSimulationErrorMessage");u();l();u();l();function kb(e,t){let r=ye.optimisticUpdates(),o=e.getQueryData(r)??[];e.setQueryData(r,[...o.filter(n=>n.id!==t.id),t])}s(kb,"pushOptimisticUpdate");function Cb(e){return`${e.type}-${e.data.key}`}s(Cb,"getOptimisticUpdateKey");var Wn=class{static{s(this,"ConfirmationExecuteSwapStateListener")}queryClient;storage;authRepository;constructor(t,r,o){this.queryClient=t,this.storage=r,this.authRepository=o}onStateChange(t,r,o,n){let{sell:a,quote:c,account:p}=o.executingQuote;if(t.type===j.TransactionConfirmed){this.storage.set(Ce.PriorityFee,null),this.storage.set(Ce.PriorityFeeSettings,{type:Vn.Auto}),this.queryClient.setQueryData(ye.priorityFee(),null),this.queryClient.setQueryData(ye.priorityFeeSettings(),{type:Vn.Auto}),this.storage.set(Ce.TipAmount,null),this.storage.set(Ce.TipSettings,{type:jn.Auto}),this.queryClient.setQueryData(ye.tipAmount(),null),this.queryClient.setQueryData(ye.tipSettings(),{type:jn.Auto});let m=new U(a.data.amount),d=new U(c.sellAmount),f=m.minus(d).toString();kb(this.queryClient,{id:Cb(a),amount:f}),this.queryClient.invalidateQueries({queryKey:Jf.tokens(p.addresses)}),this.queryClient.invalidateQueries({queryKey:dg.tokenBalance({wallets:p.addresses,encodedCaip19:O(X(a))})})}}};u();l();u();l();var Jc=class{static{s(this,"SimulationAnalytics")}#e;constructor(t){this.#e=t}onScannedMessageByUser=s(t=>{this.#e.capture("simulation",{data:{simulation:{...t,type:"message",status:"success"}}})},"onScannedMessageByUser");onFailedScannedMessageByUser=s(t=>{this.#e.capture("simulation",{data:{simulation:{...t,type:"message",status:"error"}}})},"onFailedScannedMessageByUser");onScannedTransactionByUser=s(t=>{this.#e.capture("simulation",{data:{simulation:{...t,type:"transaction",status:"success"}}})},"onScannedTransactionByUser");onFailedScannedTransactionByUser=s(t=>{this.#e.capture("simulation",{data:{simulation:{...t,type:"transaction",status:"error"}}})},"onFailedScannedTransactionByUser");onSkippedTransactionByUser=s(t=>{this.#e.capture("simulation",{data:{simulation:{...t,type:"transaction",status:"skipped"}}})},"onSkippedTransactionByUser")};var _b="swap-validation",Zn=class{static{s(this,"SimulationAnalyticsExecuteSwapStateListener")}simulationAnalytics;constructor(t){this.simulationAnalytics=new Jc(t)}onStateChange(t,r,o){switch(t.type){case j.SimulationPassed:let n=t.scannedTransactionResult;this.simulationAnalytics.onScannedTransactionByUser({networkId:t.networkId,warnings:n.warnings.map(c=>c.severity),shouldBlock:!!n.block,errorCode:n.error??""});break;case j.SimulationFailed:let a=t.error.scannedTransactionResult;if(a){this.simulationAnalytics.onScannedTransactionByUser({networkId:t.networkId,warnings:a.warnings.map(c=>c.severity),shouldBlock:!!a.block,errorCode:a.error??""}),a?.error&&P.addBreadcrumb(_b,`Simulation error: ${JSON.stringify({error:a.error})}`,Y.Info);return}this.simulationAnalytics.onFailedScannedTransactionByUser({networkId:t.networkId,url:t.url}),P.addBreadcrumb("simulation",`networkID: ${t.networkId}, url: ${t.url}, type: transaction`,Y.Info);break;case j.SimulationSkipped:this.simulationAnalytics.onSkippedTransactionByUser({networkId:t.networkId}),P.addBreadcrumb(_b,`Simulation skipped for networkID: ${t.networkId}`,Y.Info);break}}};u();l();u();l();u();l();var ue;(function(e){e.Idle="idle",e.FetchingQuote="fetchingQuote",e.Quote="quote",e.SimulationRequestErrored="simulationRequestErrored",e.SimulationFailed="simulationFailed",e.Simulated="simulated",e.TransactionSubmissionFailed="transactionSubmissionFailed",e.TransactionNotConfirmed="transactionNotConfirmed"})(ue||(ue={}));var Kv=10,Vv=We(e=>({transitions:[],addTransition:s((t,r)=>e(o=>{let n=jv(r,t);return n?{transitions:[n,...o.transitions].slice(0,Kv)}:o}),"addTransition")}));function tu(e,t){Vv.getState().addTransition(e,t)}s(tu,"addSwapperTransition");function jv(e,t){switch(t.type){case ue.Idle:return;case ue.FetchingQuote:return;case ue.Quote:return{sell:vr(t.response,t.sell,"sell"),buy:vr(t.response,t.buy,"buy"),sellAmount:t.quote.sellAmount,buyAmount:t.quote.buyAmount,provider:ga(t.quote),slippage:t.response.slippageTolerance,stateType:t.type,eventType:e.type,timestamp:Date.now()};case ue.SimulationRequestErrored:return{sell:vr(t.response,t.sell,"sell"),buy:vr(t.response,t.buy,"buy"),sellAmount:t.quote.sellAmount,buyAmount:t.quote.buyAmount,provider:ga(t.quote),slippage:t.response.slippageTolerance,stateType:t.type,eventType:e.type,error:t.error,quoteTransactionData:eu(t.quote),timestamp:Date.now()};case ue.Simulated:return;case ue.SimulationFailed:return{sell:vr(t.response,t.sell,"sell"),buy:vr(t.response,t.buy,"buy"),sellAmount:t.quote.sellAmount,buyAmount:t.quote.buyAmount,provider:ga(t.quote),slippage:t.response.slippageTolerance,simulationError:t.simulationError,stateType:t.type,eventType:e.type,simulationWarning:t.scannedTransactionResult?.warnings,quoteTransactionData:eu(t.quote),simulationHumanReadableError:t.scannedTransactionResult?.simulationError?.humanReadableError,simulationRequestId:t.scannedTransactionResult?.advancedDetails?.requestId,timestamp:Date.now()};case ue.TransactionSubmissionFailed:return{sell:vr(t.response,t.sell,"sell"),buy:vr(t.response,t.buy,"buy"),sellAmount:t.quote.sellAmount,buyAmount:t.quote.buyAmount,provider:ga(t.quote),slippage:t.response.slippageTolerance,error:t.error,stateType:t.type,eventType:e.type,quoteTransactionData:eu(t.quote),timestamp:Date.now()};case ue.TransactionNotConfirmed:return{sell:vr(t.response,t.sell,"sell"),buy:vr(t.response,t.buy,"buy"),sellAmount:t.quote.sellAmount,buyAmount:t.quote.buyAmount,provider:ga(t.quote),slippage:t.response.slippageTolerance,stateType:t.type,eventType:e.type,quoteTransactionData:eu(t.quote),timestamp:Date.now(),error:t.error};default:return}}s(jv,"toSparseTransition");var ga=s(e=>{let t=Oe(e);return Re(t)},"parseProvider"),vr=s((e,t,r)=>{switch(r){case"sell":return{caip19:e.sellToken,symbol:t.data.symbol??void 0};case"buy":return{caip19:e.buyToken,symbol:t.data.symbol??void 0}}},"parseTokens"),eu=s(e=>{if(!se(e))return e.transactionData},"parseQuoteTransactionData");u();l();var ht;(function(e){e.QuoteRequestStarted="quoteRequestStarted",e.QuoteResponseReceived="quoteResponseReceived",e.QuoteSelected="quoteSelected",e.SimulationResponseReceived="simulationResponseReceived",e.SimulationRequestError="simulationRequestError",e.TransactionSubmissionFailed="transactionSubmissionFailed",e.TransactionConfirmationFailed="transactionConfirmationFailed"})(ht||(ht={}));var Yn=class{static{s(this,"TransitionsExecuteSwapStateListener")}onStateChange(t,r,o,n){let a=this.toLegacyTransition(t,o);a&&tu(a.nextState,a.event)}toLegacyTransition(t,r){let{buy:o,sell:n,quote:a,response:c}=r.executingQuote;switch(t.type){case j.SimulationFailed:return{event:{type:ht.SimulationRequestError,error:t.error},nextState:{type:ue.SimulationFailed,buy:o,sell:n,response:c,quote:a,scannedTransactionResult:t.error.scannedTransactionResult,simulationError:t.error.message}};case j.TransactionSubmissionFailed:return{event:{type:ht.TransactionSubmissionFailed,error:t.error},nextState:{type:ue.TransactionSubmissionFailed,buy:o,sell:n,response:c,quote:a,error:t.error}};case j.TransactionConfirmationFailed:return{event:{type:ht.TransactionConfirmationFailed,error:t.error,txReceipt:t.txReceipt},nextState:{type:ue.TransactionNotConfirmed,buy:o,sell:n,response:c,quote:a,error:t.error,txReceipt:t.txReceipt}};default:return}}};u();l();u();l();u();l();u();l();u();l();var Ib=s(e=>{let t,r=new Set,o=s((f,h)=>{let w=typeof f=="function"?f(t):f;if(!Object.is(w,t)){let y=t;t=h??(typeof w!="object"||w===null)?w:Object.assign({},t,w),r.forEach(S=>S(t,y))}},"setState"),n=s(()=>t,"getState"),m={setState:o,getState:n,getInitialState:s(()=>d,"getInitialState"),subscribe:s(f=>(r.add(f),()=>r.delete(f)),"subscribe"),destroy:s(()=>{(import.meta.env?import.meta.env.MODE:void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),r.clear()},"destroy")},d=t=e(o,n,m);return m},"createStoreImpl"),Fb=s(e=>e?Ib(e):Ib,"createStore");var qb=D(L(),1),zb=D(Mb(),1);var{useDebugValue:lP}=qb.default,{useSyncExternalStoreWithSelector:pP}=zb.default,Ob=!1,dP=s(e=>e,"identity");function mP(e,t=dP,r){(import.meta.env?import.meta.env.MODE:void 0)!=="production"&&r&&!Ob&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),Ob=!0);let o=pP(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,r);return lP(o),o}s(mP,"useStore");var Qb=s(e=>{(import.meta.env?import.meta.env.MODE:void 0)!=="production"&&typeof e!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");let t=typeof e=="function"?Fb(e):e,r=s((o,n)=>mP(t,o,n),"useBoundStore");return Object.assign(r,t),r},"createImpl"),fP=s(e=>e?Qb(e):Qb,"create"),Gb=s(e=>((import.meta.env?import.meta.env.MODE:void 0)!=="production"&&console.warn("[DEPRECATED] Default export is deprecated. Instead use `import { create } from 'zustand'`."),fP(e)),"react");u();l();var wo;(function(e){e.Failed="Failed",e.Progress="Progress",e.Success="Success",e.Default="Default"})(wo||(wo={}));var gP=3e3,Jt=Gb(e=>({toast:void 0,toastId:void 0,visible:!1,currentTimer:null,hideToast(t){e(r=>t&&r.toastId!==t?r:(r.currentTimer&&clearTimeout(r.currentTimer),{visible:!1,currentTimer:null}))},removeToast(){e(t=>(t.currentTimer&&clearTimeout(t.currentTimer),{toast:void 0,toastId:void 0,visible:!1,currentTimer:null}))},success(t){e(r=>{r.currentTimer&&clearTimeout(r.currentTimer);let o=setTimeout(()=>{e({visible:!1,currentTimer:null})},gP);return{toast:{type:wo.Success,...t},toastId:t.id??$e(),visible:!0,currentTimer:o}})},failed(t){e(r=>(r.currentTimer&&clearTimeout(r.currentTimer),{toast:{type:wo.Failed,...t},toastId:t.id??$e(),visible:!0,currentTimer:null}))},progress(t){e(r=>(r.currentTimer&&clearTimeout(r.currentTimer),{toast:{type:wo.Progress,...t},toastId:t.id??$e(),visible:!0,currentTimer:null}))},message(t){e(r=>(r.currentTimer&&clearTimeout(r.currentTimer),{toast:{type:wo.Default,...t},toastId:t.id??$e(),visible:!0,currentTimer:null}))}}));u();l();var ha=s(e=>{let t=yo(e);return Fr(t)},"getEstimatedTime");u();l();function Kb(e,t,r,o){let n=je(e),a=n?e:t,c=n?t:e,p=n?r.sellAmount:r.buyAmount,m=Ee(p,a.data.decimals),d=Va(m,!0),f=c.data.symbol,h="";return o?h=n?"swapTokenConfirmationBuyToast":"swapTokenConfirmationSellToast":h=n?"swapSwappingCashBuyToast":"swapSwappingCashSellToast",v.t(h,{amount:d,symbol:f})}s(Kb,"cashSwapToastMessage");u();l();u();l();function Vb({sell:e,buy:t,onBuyFungiblePress:r}){let o=`${v.t("swapTxConfirmationSwapFailed")} ${e.data.symbol} \u2192 ${t.data.symbol}`,n=x.getChainDefinition(e.data.chain.id).tokenSymbol,a=v.t("buyAssetInterpolated",{tokenSymbol:n});return{title:o,message:v.t("swapTabInsufficientFunds"),onPress:r,buttonText:a}}s(Vb,"getInsufficientFundsToastProps");function jb(e,t,r,o,n,a){let{sell:c,buy:p}=t,m=hP(e,c,p,n,o,r,a);return m||{title:`${v.t("swapTxConfirmationSwapFailed")} ${c.data.symbol} \u2192 ${p.data.symbol}`,message:gb(e),onPress:s(()=>{Jt.getState().hideToast(),o()},"onPress"),buttonText:v.t("commandRetry")}}s(jb,"createSimulationErrorToast");function hP(e,t,r,o,n,a,c){if(!(e.type&&!c.includes(e.type)))switch(e.type){case Te.InsufficientFunds:return Vb({sell:t,buy:r,onBuyFungiblePress:s(()=>{Jt.getState().hideToast(),a()},"onBuyFungiblePress")});case Te.SlippageExceeded:return o.selectedSetting.type===ce.Auto?void 0:{title:v.t("swapEnableAutoSlippageTitleToast",{sellSymbol:t.data.symbol,buySymbol:r.data.symbol}),buttonText:v.t("swapEnableAutoSlippageButtonToast"),message:"",onPress:s(()=>{o.setSlippageSetting({type:ce.Auto}),n(),Jt.getState().hideToast()},"onPress")}}}s(hP,"createCustomSimulationErrorToast");u();l();u();l();var yP=["Ledger App not open","Ledger not connected","Unable to connect to Ledger","Unable to connect to Ledger device","Need permission to connect to Ledger"],wP="Ledger user rejected action",SP="Ledger Sign Error";function Hb(e){return yP.some(r=>e.message.includes(r))?v.t("swapTxConfirmationSwapFailedLedgerConnectionError"):e.message.includes(wP)?v.t("swapTxConfirmationSwapFailedLedgerReject"):e.message.includes(SP)?v.t("swapTxConfirmationSwapFailedLedgerSignError"):e.message.toLowerCase().includes("ledger")?v.t("swapTxConfirmationSwapFailedLedgerError"):null}s(Hb,"parseLedgerError");function $b({sellSymbol:e,buySymbol:t,error:r,onPress:o}){let n=v.t("unknownToken"),a=`${v.t("swapTxConfirmationSwapFailed")} ${e??n} \u2192 ${t??n}`,c=v.t("commandRetry"),p=v.t("swapTxConfirmationSwapFailedUnknownError"),m=Hb(r);return m&&(p=m),{title:a,message:p,onPress:o,buttonText:c}}s($b,"createSwapFailedToast");var Jn=class{static{s(this,"ToastExecuteSwapStateListener")}showFungibleDetails;showBuyFungibleScreen;slippageSettings;supportedCustomSimulationToastErrorTypes;retryAndNavigateToSwapper;toastMessageParser;constructor(t,r,o,n,a,c=TP){this.showFungibleDetails=t,this.showBuyFungibleScreen=r,this.slippageSettings=o,this.supportedCustomSimulationToastErrorTypes=n,this.retryAndNavigateToSwapper=a,this.toastMessageParser=c}onStateChange(t,r,o,n){let{sell:a,buy:c,quote:p}=o.executingQuote;switch(t.type){case j.ExecuteSwapStarted:let m;if(se(p)){if(x.isBitcoinNetworkID(a.data.chain.id)){Wb(v.t("swapBitcoinSellBridgeProgressToast",{estimatedTime:ha(p)}),()=>{this.showFungibleDetails(c)});return}x.isBitcoinNetworkID(c.data.chain.id)?m=v.t("swapBitcoinBuyingToast"):m=v.t("swapInitiatingBridgeToast",{sellSymbol:a.data.symbol,sellChain:a.data.chain.name,buySymbol:c.data.symbol,buyChain:c.data.chain.name})}else je(a)||je(c)?m=Kb(a,c,p,!1):m=v.t("swapSwappingToast",{sellSymbol:a.data.symbol,buySymbol:c.data.symbol});bP(m);break;case j.TransactionConfirmed:Wb(this.toastMessageParser.parseTransactionConfirmed(a,c,p),()=>this.showFungibleDetails(c));break;case j.SimulationFailed:Zb(jb(t.error,o.executingQuote,this.showBuyFungibleScreen,()=>this.handleRetryPress(o.executingQuote),this.slippageSettings,this.supportedCustomSimulationToastErrorTypes));break;case j.TransactionSubmissionFailed:case j.TransactionConfirmationFailed:Zb($b({sellSymbol:a.data.symbol,buySymbol:c.data.symbol,error:t.error,onPress:s(()=>this.handleRetryPress(o.executingQuote),"onPress")}));break}}handleRetryPress(t){Jt.getState().hideToast(),this.retryAndNavigateToSwapper(t)}};function bP(e){Jt.getState().progress({message:e,onPress:s(()=>{Jt.getState().hideToast()},"onPress")})}s(bP,"progress");function Wb(e,t){Jt.getState().success({id:"swap-success",message:e,onPress:s(()=>{Jt.getState().hideToast(),t()},"onPress")})}s(Wb,"success");function Zb(e){Jt.getState().failed(e)}s(Zb,"failed");var TP={parseTransactionConfirmed(e,t,r){return se(r)?x.isBitcoinNetworkID(e.data.chain.id)?v.t("swapBitcoinSellBridgeProgressToast",{estimatedTime:ha(r)}):x.isBitcoinNetworkID(t.data.chain.id)?v.t("swapBitcoinBuyBridgeProgressToast",{estimatedTime:ha(r)}):v.t("swapBridgeInitiatedToast",{sellSymbol:e.data.symbol,sellChain:e.data.chain.name,buySymbol:t.data.symbol,buyChain:t.data.chain.name,estimatedTime:ha(r)}):v.t("swapSwappedToast",{sellSymbol:e.data.symbol,buySymbol:t.data.symbol})}};var ou=class{static{s(this,"ToastsSwapReviewInterceptor")}intercept(t){let{swapper:r,connection:o,storage:n,vaultProxy:a,locale:c,analytics:p,resetSwapper:m,queryClient:d,showFungibleDetails:f,showBuyFungibleScreen:h,swapAnalytics:w,gasEstimation:y,slippageSettings:S,supportedCustomSimulationToastErrorTypes:T,navigateToSwapper:b,storePairs:A,isMobile:E,enableExtSwapCommands:C,authRepository:I,isSimulationKilled:N}=t;if(r.getAccount()?.type===tf.Ledger||!E&&!C)return"continue";let R=r.getState();if(R.type!==Le.Quote)return"continue";let{quote:H,sell:q,buy:k}=R;return this.isSupportedQuote(H)&&(async()=>{A(q,k);let F=await p.getDeviceId(),G=new Jn(f,h,S,T,st=>{b(st)}),W=new Wn(d,n,I),re=new $n(w,p),Z=new Zn(p),He=new Yn,Ue=new Hn(go);try{r.subscribeExecution(W),r.subscribeExecution(Z),r.subscribeExecution(re),r.subscribeExecution(G),r.subscribeExecution(He),r.subscribeExecution(Ue),await r.swap({signer:a,storage:n,locale:c,deviceId:F,connection:o,authRepository:I,isSimulationKilled:N,gasEstimation:y}),m()}catch{}finally{r.unsubscribeExecution(W),r.unsubscribeExecution(Z),r.unsubscribeExecution(re),r.unsubscribeExecution(G),r.unsubscribeExecution(He),r.unsubscribeExecution(Ue)}})(),"continue"}isSupportedQuote(t){return It(t)||cr(t)||Mr(t)||se(t)}};u();l();var nu=class{static{s(this,"StreamGetSwapQuotesStrategy")}swapper;queryClient;constructor(t,r){this.swapper=t,this.queryClient=r}queryKey;quoteProcessorListener={onStateChange:s((t,r)=>{if(!this.queryKey){console.error("queryKey is not set");return}r.type==="quoteProcessed"&&this.queryClient.setQueryData(this.queryKey,r.response)},"onStateChange")};async fetch(t,r){return this.queryKey=r,this.swapper.unsubscribeQuoteProcessor(this.quoteProcessorListener),new Promise((o,n)=>{let a=AP(t.amount,t.sell,t.buy),c={onStateChange:s((p,m)=>{switch(m.type){case"firstQuoteReceived":o(m.response),this.swapper.unsubscribeQuoteProcessor(c);break;case"error":n(m.error),this.swapper.unsubscribeQuoteProcessor(c),this.swapper.unsubscribeQuoteProcessor(this.quoteProcessorListener);break}},"onStateChange")};this.swapper.subscribeQuoteProcessor(this.quoteProcessorListener),this.swapper.subscribeQuoteProcessor(c),this.swapper.setPair(Yb(t.buy),Yb(t.sell),a),this.swapper.setAmount(a,{slippageTolerance:t.slippageTolerance,slippageType:t.enableAutoSlippage?ce.Auto:ce.Fixed,priorityFee:t.priorityFee,tipAmount:t.tipAmount,preferredProvider:t.preferredProvider})})}stopFetching(){this.swapper.getQuoteProcessorState().type!=="idle"&&(this.swapper.stopProcessingQuotes(),this.swapper.unsubscribeQuoteProcessor(this.quoteProcessorListener))}getFetchInterval(t){return!1}};function AP(e,t,r){let o=e.type==="sell"?t:r;return{amount:new _(e.value).shiftedBy(-o.data.decimals).toString(),perspective:e.type}}s(AP,"normalizeAmount");function Yb(e){return{...e,data:{...e.data,walletAddress:""}}}s(Yb,"removeWalletAddress");u();l();u();l();var su;(function(e){e.AutoSlippageOptIn="autoSlippageOptIn"})(su||(su={}));var au=class{static{s(this,"AutoSlippageOptInInterceptor")}intercept({hasViewedAutoSlippageOptIn:t,selectedSetting:r,setHasViewedAutoSlippageOptIn:o,showOverlay:n}){return!t&&r!==ce.Auto?(n(su.AutoSlippageOptIn),o(!0),"interrupt"):"continue"}};u();l();var yd=D(L());u();l();var Jb=D(L());u();l();var xP=i.object({swapper:i.number(),review:i.number().nullish().default(null)}),iu={swapper:Sn.Short,review:null},Xb=s(()=>{let e=Ht.getMultivariateAssignment("swapper-poll-interval-json");if(!e)return iu;try{let t=JSON.parse(e);return xP.parse(t)}catch{return iu}},"getQuotePollIntervalConfig");var wa=s(()=>{let e=ya(n=>n.intervalMs),t=ya(n=>n.state),r=ya(n=>n.setState),o=(0,Jb.useCallback)(n=>{r("resumed",n??eT())},[r]);return{state:t,pause:s(()=>r("paused"),"pause"),resume:o,intervalMs:e}},"useQuotePoller"),Sa=s(e=>{ya.getState().setState("resumed",e??eT())},"resumePoller"),hd=s(()=>{ya.getState().setState("paused")},"pausePoller"),eT=s(()=>Xb().swapper,"getDefaultInterval"),ya=We(e=>({state:"resumed",intervalMs:iu.swapper,setState(t,r){e(r?{state:t,intervalMs:r}:{state:t})}}));var tT=s(()=>{let e=(0,yd.useCallback)(()=>{Sa()},[]),t=(0,yd.useCallback)(()=>{hd()},[]);return{onSwapTabEnter:e,onSwapTabExit:t}},"useSwapTabSwitchActions");var rT=(0,lr.createContext)(void 0),Use=s(({children:e})=>{let t=[ce.Auto,ce.Fixed],r=[Te.SlippageExceeded],o=(0,lr.useMemo)(()=>[new au,new ou],[]),n=!0,a=ot(),c=ze(),p=(0,lr.useMemo)(()=>xo?new nu(a,c):new Zc,[a,c]),{onSwapTabEnter:m,onSwapTabExit:d}=tT(),f=Oa("trade-hub-variant"),h=Ke("enable-replace-classic-ngs"),w=(0,lr.useMemo)(()=>{if(h||f==="remove-buy-sell")return"remove-buy-sell";if(f==="swapper-modal")return"swapper-modal";if(f==="trade-menu")return"trade-menu"},[f,h]),y=(0,lr.useMemo)(()=>or?ud("full"):ud("compactNoSymbol"),[]);return lr.default.createElement(rT.Provider,{value:{slippageSettingTypes:t,reviewInterceptors:o,showStickyCTAButton:n,getSwapQuotesStrategy:p,supportedCustomSimulationToastErrorTypes:r,onSwapTabEnter:m,onSwapTabExit:d,balanceDisplayStrategy:y,tradeHubVariant:w}},e)},"SwapTabProvider"),oT=s(()=>{let e=(0,lr.useContext)(rT);if(!e)throw new Error("useSwapTab must be used within a SwapTabProvider");return e},"useSwapTab");u();l();var qo=D(L());u();l();u();l();var EP=i.enum(["pumpFun","moonshot"]),kP=i.object({type:EP,programId:i.string(),name:i.string(),iconUrl:i.string()}),CP=i.object({programs:i.array(kP)}),nT=s(e=>{try{return CP.parse(e)}catch{return}},"parseUgcPrograms");var _P={type:"pumpFun",programId:"6EF8rrecthR5Dkzon8Nwu78hRvfCKubJ14M5uBEwF6P",name:"Pump.fun",iconUrl:"https://dhc7eusqrdwa0.cloudfront.net/assets/pumpfun.svg"},wd=[],$r=s(()=>{try{let e=Ht.getMultivariateAssignment("enabled-ugc-programs");if(!e)return Ht.isFeatureEnabled("enabled-ugc-programs")?[_P]:wd;let t=JSON.parse(e);return nT(t)?.programs??wd}catch{return wd}},"getSupportedUgcPrograms");var IP=i.object({programId:i.string(),complete:i.boolean(),progress:i.string()}),FP=i.object({bondingCurves:i.record(i.string(),IP)}),er;(function(e){e.Loading="Loading",e.BondingCurve="BondingCurve",e.BondingCurveRefreshing="BondingCurveRefreshing",e.NoBondingCurve="NoBondingCurve",e.Graduated="Graduated",e.Error="Error"})(er||(er={}));function vP(e){let t=sT(e),o=ze().getQueryData(t.queryKey),{data:n,isFetching:a,isError:c}=ae({...t,initialData:o,staleTime:0}),p=(0,qo.useMemo)(()=>$r(),[]);return(0,qo.useMemo)(()=>{let m=o===n;if(a&&!m)return{type:er.Loading};if(c)return{type:er.Error};let d=FP.safeParse(n);if(!d.success)return{type:er.Error};let f=d.data.bondingCurves[e];if(!f)return{type:er.NoBondingCurve};let h=p.find(y=>y.programId===f.programId);if(!h)return{type:er.NoBondingCurve};let w=DP(f.progress);return w?f.complete?{type:er.Graduated,ugcProgram:h}:{type:m&&a?er.BondingCurveRefreshing:er.BondingCurve,progressPercentage:w,ugcProgram:h}:{type:er.Error}},[o,e,n,c,a,p])}s(vP,"useBondingCurveProgress");var PP=s(e=>{let t=ze(),r=sT(e);return(0,qo.useCallback)(async()=>{await t.refetchQueries({queryKey:r.queryKey,type:"active"})},[t,r.queryKey])},"useUgcEnabledAwareBondingCurveRefetch"),sT=s(e=>{let t=(0,qo.useMemo)(()=>$r(),[]),r=(0,qo.useMemo)(()=>t.map(n=>n.programId),[t]);return{queryKey:["bonding-curve",e,r],queryFn:s(()=>RP(e,r),"queryFn")}},"useQueryOptions"),RP=s(async(e,t)=>{let r=encodeURIComponent(e),o=encodeURIComponent(t.join(","));return(await K.api().get(`/ugc/v1/bonding-curve/${r}/${o}`)).data},"queryFn"),DP=s(e=>{let t=Number(e);if(!isNaN(t))return Math.round(t*100)},"parseProgressPercentage");u();l();var NP="https://help.phantom.com/hc/en-us/articles/33745013398675";u();l();u();l();var uT=D(L());u();l();var BP="swap",LP=s(e=>new Tf(e,BP),"createSwapAnalytics"),cu=lf(Se,e=>LP(e));u();l();function aT(e,t,r){if(!r)return;if(t===ce.Fixed)return r.slippageTolerance;let o=r.quotes[e];if(o)return se(o)?r.slippageTolerance:Ar(o)?o.slippageTolerance:r.slippageTolerance}s(aT,"parseSlippage");u();l();var uu=D(L());var cT=s(()=>{let{data:e,isFetching:t}=vt({key:Ce.LastSubmittedPairs,queryKey:ye.lastSubmittedPairs()}),r=(0,uu.useMemo)(()=>e??null,[e]),{mutateAsync:o}=Pt({key:Ce.LastSubmittedPairs,queryKey:ye.lastSubmittedPairs()}),n=(0,uu.useCallback)(async(a,c)=>{await o({sellFungible:iT(a),buyFungible:iT(c)})},[o]);return{pairs:r,isLoading:t,storePairs:n}},"useLastSubmittedPairs");function iT(e){return{...e,data:{...e.data,walletAddress:""}}}s(iT,"removeWalletAddress");var UP=s(({goToConfirmation:e})=>{let t=V(b=>b.sellUsdValue),r=V(b=>b.buyUsdValue),{currentQuote:o,quoteResponse:n,selectedProviderIndex:a,selectedBaseProvider:c}=rt(),p=V(b=>b.sellFungible),m=V(b=>b.buyFungible),d=V(b=>b.swapFilter),{selectedSetting:f}=co(),{storePairs:h}=cT(),w=Se(),y=cu(),{pause:S}=wa();return(0,uT.useCallback)(()=>{if(!o||!p||!m)return;let b=aT(a,f.type,n);w.capture("swapperSwap");let A=Xc({buyToken:m,sellToken:p,sellAssetUsdValue:t,buyAssetUsdValue:r,quote:o,slippageTolerance:b,slippageType:f.type,sellSwapFilter:d,baseProvider:c});A&&(P.addBreadcrumb(M.Swapper,"approved",Y.Info,en(A.swap)),y.approved(A)),S(),e(),x.compareNetworkID(p.data.chain.id,m.data.chain.id)===0&&h(p,m)},[o,p,m,a,f.type,n,w,t,r,S,e,y,h,d,c])},"useOnSwap");u();l();var pT=D(L());u();l();var Sd=D(L());u();l();var MP=i.object({blocked:i.array(i.nativeEnum(ne))}),lT=s(()=>{let e=Oa("blocked-swapper-chains"),t=MP.safeParse(e);return t.success?t.data.blocked:[]},"useBlockedSwapperChains");u();l();function So(){return Xt.supportedChains.filter(e=>{let t=Xt.get(e);return t.requiredFeatureFlag?Km(t.requiredFeatureFlag):!0})}s(So,"useSwapperChains");var zo=s(()=>{let{data:e}=_e(),t=So(),r=lT(),o=(0,Sd.useMemo)(()=>t.filter(n=>!r.includes(n)).map(n=>x.getMainnetNetworkID(n)),[t,r]);return(0,Sd.useMemo)(()=>OP(e,o),[e,o])},"useSupportedNetworkIDs"),OP=s((e,t)=>[...new Set((e?.addresses??[]).map(r=>r.networkID).filter(r=>t.includes(r)))],"getSupportedNetworkIDs");var bd=s(()=>{let e=zo(),t=Ke("enable-bitcoin-swap");return(0,pT.useCallback)(r=>!t&&r&&x.isBitcoinNetworkID(r)?!1:!!r&&e.includes(r),[e,t])},"useIsSupportedNetworkId");u();l();var du=D(L());u();l();u();l();var lu=class{static{s(this,"SwapperTransitionsStateListener")}onStateChange(t,r,o){tu(o,t)}};u();l();var pu=class{static{s(this,"SwapperStateMachine")}listeners;constructor(t){this.listeners=t}transition(t,r){try{let o=this.detectNextState(t,r);return this.listeners.forEach(n=>n.onStateChange(r,t,o)),o}catch{return t}}detectNextState(t,r){switch(r.type){case ht.QuoteRequestStarted:return{type:ue.FetchingQuote,buy:r.buy,sell:r.sell,amount:r.amount};case ht.QuoteResponseReceived:switch(t.type){case ue.FetchingQuote:case ue.Quote:case ue.Simulated:case ue.SimulationRequestErrored:case ue.TransactionSubmissionFailed:case ue.TransactionNotConfirmed:let o=r.response.quotes[r.quoteIndex];if(!o)throw new Error("Quote index out of bounds");return{type:ue.Quote,response:r.response,buy:t.buy,sell:t.sell,quote:o};default:throw new Error("Can't transition from this state")}case ht.QuoteSelected:switch(t.type){case ue.Quote:let o=t.response.quotes[r.quoteIndex];if(!o)throw new Error("Quote index out of bounds");return{type:ue.Quote,quote:o,buy:t.buy,sell:t.sell,response:t.response};default:throw new Error("Can only transition to QuoteChanged from Quote")}case ht.SimulationResponseReceived:switch(t.type){case ue.Quote:return r.scannedTransactionResult.error?{type:ue.SimulationFailed,quote:t.quote,buy:t.buy,sell:t.sell,response:t.response,scannedTransactionResult:r.scannedTransactionResult,simulationError:r.scannedTransactionResult.error}:{type:ue.Simulated,quote:t.quote,buy:t.buy,sell:t.sell,response:t.response,scannedTransactionResult:r.scannedTransactionResult};default:throw new Error("Can only transition to Simulated from Simulating")}case ht.SimulationRequestError:switch(t.type){case ue.Quote:return{type:ue.SimulationRequestErrored,buy:t.buy,sell:t.sell,quote:t.quote,response:t.response,error:r.error};default:throw new Error("Can only transition to SimulationRequestErrored from Simulating")}case ht.TransactionSubmissionFailed:switch(t.type){case ue.Simulated:case ue.SimulationFailed:return{type:ue.TransactionSubmissionFailed,quote:t.quote,buy:t.buy,sell:t.sell,response:t.response,scannedTransactionResult:t.scannedTransactionResult,error:r.error};default:throw new Error("Can only transition to SwapSubmitFailed from SubmittingSwap")}case ht.TransactionConfirmationFailed:switch(t.type){case ue.Simulated:return{type:ue.TransactionNotConfirmed,quote:t.quote,buy:t.buy,sell:t.sell,txReceipt:r.txReceipt,response:t.response,scannedTransactionResult:t.scannedTransactionResult,error:r.error};default:throw new Error("Can only transition to TransactionNotConfirmed from ConfirmingTransaction")}}}};var QP=new pu(new Set([new lu])),dT=We(e=>({state:{type:ue.Idle},transition:s(t=>{e(r=>{let o=r.state;return{state:QP.transition(o,t)}})},"transition")}));var mT=s(()=>{let e=dT(r=>r.state),t=dT(r=>r.transition);return{state:e,transition:t}},"useSwapperState");u();l();var qP=5*60,fT=s(e=>{if(se(e))return Re(Tn(e));let{sources:t}=e;return Re(t)},"getProviderLabel"),gT=s(({quotes:e,buyTokenNetworkId:t,buyTokenDecimals:r,buyTokenSymbol:o})=>e.map(n=>{let{buyAmount:a}=n,c=sr.get(t).formDisplayPrecision;return{name:fT(n),amount:`${ar(Ee(a,r),c)} ${o}`}}),"parseSwapProviders"),hT=s(({quotes:e,buyTokenNetworkId:t,buyTokenDecimals:r,buyTokenSymbol:o,networkIDForFees:n,networkFee:a,priceMap:c})=>e.filter(se).map(p=>{let{buyAmount:m,executionDuration:d,steps:f}=p,w=$c(p).plus(a),y=f.find(T=>!!T.tool.logoURI),S=sr.get(t).formDisplayPrecision;return{name:fT(p),feeUsd:n&&c?Qt(n,w,c):null,amount:`${ar(Ee(m,r),S)} ${o}`,time:{text:Fr(d),isFast:d<=qP},logoURI:y?.tool.logoURI??""}}),"parseBridgeProviders");u();l();var zP={aggregate(e){return e.reduce((t,r)=>({...t,gasLimit:t.gasLimit.plus(r.gasLimit)}),{networkID:x.ethereum.mainnetID,gasLimit:new U(0),maxFeePerGas:e[0].maxFeePerGas,maxPriorityFeePerGas:e[0].maxPriorityFeePerGas})}},GP={aggregate(e){return e.reduce((t,r)=>({...t,value:t.value+r.value}),{networkID:x.solana.mainnetID,value:0})}},KP={aggregate(e){return e.reduce((t,r)=>({...t,gasBudget:t.gasBudget.plus(r.gasBudget)}),{networkID:x.sui.mainnetID,gasBudget:new U(0)})}},ba=s(e=>{if(!(!e||e.length===0)){if(Za(e[0]))return zP.aggregate(e);if(Ff(e[0]))return GP.aggregate(e);if(vf(e[0]))return KP.aggregate(e)}},"aggregateGasEstimation");function VP({selectQuote:e}){let{quoteResponse:t,isFetchingQuote:r,quotes:o,selectedProviderIndex:n}=rt(),a=V(C=>C.setSelectedProviderIndex),c=V(C=>C.gasEstimation.estimateWithBuffer),p=V(C=>C.sellFungible),m=V(C=>C.buyFungible),d=p?.data.chain.id,{data:f}=_s(d,ba(c)),w=So().map(C=>gr(C)),{data:y={}}=to({query:{data:w}}),S=t?.type==="xchain",T=(0,du.useMemo)(()=>m?S?hT({quotes:o,buyTokenNetworkId:m.data.chain.id,buyTokenDecimals:m.data.decimals,buyTokenSymbol:m.data.symbol,networkIDForFees:d,networkFee:f?.gasEstimationAmount??new U(0),priceMap:y}):gT({quotes:o,buyTokenNetworkId:m.data.chain.id,buyTokenDecimals:m.data.decimals,buyTokenSymbol:m.data.symbol}):[],[m,S,o,d,f?.gasEstimationAmount,y]),b=Se(),{transition:A}=mT(),E=(0,du.useCallback)(C=>{let I=T[C];b.capture("swapperProviderSelected",{data:{provider:I.name}}),a(C),e(o,C),A({type:ht.QuoteSelected,quoteIndex:C})},[a,T,b,A,o,e]);return{rows:T,selectedProviderIndex:n,isLoadingProviders:r,setSelectedProviderIndex:E}}s(VP,"useSwapProvidersProps");u();l();var gu=D(L());u();l();var wT=D(L());u();l();var yT=D(L());var mu=s(()=>{let e=ze();return{cancelQuotes:(0,yT.useCallback)(async()=>{await e.cancelQueries({queryKey:ye.quotesScope()}),await nf(1)},[e])}},"useSwapCancelQuotes");u();l();function Go(e,t){return e.data.key===t.data.key}s(Go,"areFungiblesEqual");function Td(){let e=Se(),t=V(n=>n.setBuyFungible),r=V(n=>n.buyFungible),{cancelQuotes:o}=mu();return(0,wT.useCallback)(async n=>{if(r&&Go(n,r))return;await o();let a=Qo(n);e.capture("swapperUpdateToAsset",{data:a}),t(n)},[e,r,o,t])}s(Td,"useSwapSetBuyAsset");u();l();var jce=s((e,t)=>{fu.getState().setAsset(e,t)},"setUgcSelectedAsset"),fu=We(e=>({asset:void 0,onConfirm:void 0,setAsset(t,r){e({asset:t,onConfirm:r})}}));var jP=s(({onClose:e})=>{let t=ot(),r=Td(),o=fu(p=>p.asset),n=fu(p=>p.onConfirm),a=(0,gu.useMemo)(()=>$r().find(m=>m.programId===o?.data?.ugcTokenMeta?.programId),[o]),c=(0,gu.useCallback)(async()=>{o&&(t.changeToken(o,"buy"),await r(o),n?.(),e())},[r,t,o,n,e]);return{asset:o,program:a,handleConfirmPress:c}},"useUGCTradeWarningProps");u();l();u();l();var HP=s(()=>{let e=ze(),t=V();return{clearQuotes:s(async()=>{t.resetQuote(),await e.invalidateQueries({queryKey:ye.quotesScope()})},"clearQuotes")}},"useSwapClearQuotes");u();l();var bue=s(({accountIdentifier:e,networkID:t})=>{let r=wt(),o=on();return Eo({mutationFn:s(async a=>{let{swapTransactions:c,type:p}=a;if(c.type==="evm"&&p===he.EVM){let{gasEstimation:m,pendingApprovalActivityRows:d,pendingSwapActivityRows:f}=a,{signature:h,error:w}=await P.startSpan("Process EVM Swap Txns",()=>$i({transactions:c.transactions,transactionTypes:c.transactionTypes,networkID:t,gasEstimation:m,pendingSwapActivityRows:f,pendingApprovalActivityRows:d,accountIdentifier:e,accountSigner:o,storage:r}));return{networkID:t,chainType:p,id:h,error:w}}else if(c.type==="solana"&&p===he.Solana){let{callerAddress:m,connection:d,pendingSwapActivityRows:f}=a;if(!d)throw new Error("missing connection");let{signature:h,error:w}=await P.startSpan("Process Solana Swap Txns",()=>Zi({callerAddress:m,connection:d,networkID:t,transactions:c.transactions,pendingSwapActivityRows:f,accountIdentifier:e,accountSigner:o,storage:r}));return{networkID:t,chainType:p,id:h,error:w}}else if(c.type==="sui"&&p===he.Sui){let{callerAddress:m,pendingSwapActivityRows:d}=a,{signature:f,error:h}=await P.startSpan("Process Sui Swap Txns",()=>ec({callerAddress:m,networkID:t,transactions:c.transactions,pendingSwapActivityRows:d,accountIdentifier:e,accountSigner:o,storage:r}));return{networkID:t,chainType:p,id:f,error:h}}throw new Error("unsupported")},"mutationFn")})},"useSwapFungibles");u();l();u();l();u();l();u();l();var Ta;(function(e){e.Fungible="fungible"})(Ta||(Ta={}));var $P=i.object({type:i.literal(Ta.Fungible),data:Yf}),ST=i.object({results:i.array(i.any()).transform(e=>e.reduce((t,r)=>{let o=$P.safeParse(r);return o.success&&t.push(o.data),t},[])),prevCursor:i.string().nullish().default(null),nextCursor:i.string().nullish().default(null),hasMore:i.boolean()});async function bT(e){let{query:t,networkIds:r,searchContext:o,supportedNetworkIds:n,pageSize:a=50,cursor:c}=e,p=await K.api().noBearer().headers({"Content-Type":"application/json"}).get("/search/v1",{params:{query:t.trim(),chainIds:r.join(","),platform:Mt,pageSize:a.toString(),searchTypes:Ta.Fungible,searchContext:o,...c&&{cursor:c},...n&&{supportedNetworkIds:n.join(",")}}});if(!le(p))throw new Ve({key:"UnknownError"});let m=ST.safeParse(p.data);if(m.success)return m.data;throw new Ve({key:"UnknownError"})}s(bT,"getFungibleSearch");u();l();var TT=s(e=>{let t=e.data,r=ol(t)??void 0;return{type:t.type,data:{...t.data,tokenAddress:ol(t)??void 0,key:r}}},"searchResultToFungible");u();l();var WP="search",AT={searchResults:s((e,t,r,o,n)=>[WP,{query:e,networkIds:t,supportedNetworkIds:o,chainAddresses:r,cursor:n}],"searchResults")};u();l();var hu;(function(e){e[e.Always=1/0]="Always",e[e.Short=z({minutes:5})]="Short",e[e.Medium=z({minutes:30})]="Medium",e[e.Long=z({hours:1})]="Long",e[e.Never=0]="Never"})(hu||(hu={}));var yu;(function(e){e[e.Immediate=0]="Immediate",e[e.Short=z({minutes:5})]="Short",e[e.Medium=z({minutes:30})]="Medium",e[e.Long=z({hours:1})]="Long"})(yu||(yu={}));var ZP=s(async e=>(await bT(e)).results.map(r=>TT(r)),"queryFn"),Aa=s(({query:e,networkIds:t,enableQuery:r=!0,keepPreviousData:o=!1,searchContext:n,supportedNetworkIds:a,chainAddresses:c,pageSize:p})=>{let m=AT.searchResults(e,t,c,a);return ae({queryKey:m,gcTime:hu.Short,staleTime:yu.Short,enabled:r,placeholderData:o?jm:void 0,queryFn:s(()=>ZP({query:e,networkIds:t,searchContext:n,supportedNetworkIds:a,pageSize:p}),"queryFn")})},"useFungibleSearch");u();l();var Ad=D(L());function YP({enablePrices:e,enableSorting:t}){let{fungibles:r,isLoadingTokens:o,tokensError:n,refetch:a}=mn({enablePrices:e,enableSorting:t}),c=bd(),p=V(f=>f.sellFungible),m=r.filter(f=>c(f.data.chain.id)&&f.type!==oe.CompressedSPL),d=(0,Ad.useMemo)(()=>{if(p){let f=m.findIndex(w=>Go(w,p)),h=m[f];h&&h.data.amount!==p.data.amount&&(m[f]=p)}return m.filter(f=>f.data.amount!=="0")},[m,p]);return(0,Ad.useMemo)(()=>({assets:d,isLoading:o,error:n,refetchTokens:a}),[d,o,n,a])}s(YP,"useSwapSellAssetList");u();l();var Gt=D(L());u();l();var XP=50,xT=s(({includeOwnedAssets:e,sellAsset:t,sellCaip19:r,ownedAssets:o,searchAssets:n})=>{if(!e||!t)return n;let a=s(w=>O(X(w)),"getEncodedCaip19"),c=a(t)??r,p=t.data.chain.id??(r&&et(r).chainId),m=o.filter(w=>a(w)!==c&&x.compareNetworkID(p,w.data.chain.id)===0&&w.type!==oe.CompressedSPL).slice(0,XP-1),d=m.map(w=>[a(w),w]),f=new Map(d),h=n.filter(w=>!f.has(a(w)));return[...m,...h]},"getDisplayedBuyAssets");function JP({enableQuery:e=!0,chainFilter:t,sellCaip19:r}={}){let o=(0,Gt.useMemo)(()=>r?et(r):void 0,[r]),{sellFungible:n,searchQuery:a,setSearchQuery:c,setNumSearchResults:p}=V(),m=Ha(a,150),{fungibles:d,isLoadingTokens:f,isRefetchingTokens:h,tokensError:w}=mn(),y=zo(),[S,T]=(0,Gt.useState)(""),{data:b}=_e(),A=(0,Gt.useMemo)(()=>b?.addresses??[],[b]),{data:E,isSuccess:C,isFetching:I,error:N}=Aa({query:m,networkIds:t?[t]:[o?.chainId??n?.data.chain.id??x.solana.mainnetID],enableQuery:e,keepPreviousData:!0,searchContext:"swapper",supportedNetworkIds:y,chainAddresses:A}),Q=!C&&I,R=(0,Gt.useMemo)(()=>d.filter(W=>W.type!==oe.CompressedSPL).map(W=>[O(X(W)),W]),[d]),H=(0,Gt.useMemo)(()=>{let W=Lm(R.map(([Z])=>Z).join("~")),re=Ym(W);return Bm(re)},[R]),q=(0,Gt.useMemo)(()=>new Map(R),[H]),k=(0,Gt.useMemo)(()=>{if(!E||E.length===0)return[];T($e());let W=E.reduce((re,Z)=>{let He="";if(St(Z.type)){if(n&&St(n.type)&&Z.data.chain.id===n.data.chain.id||o&&o.chainId===Z.data.chain.id&&o.resourceType===ee.nativeToken)return re;He=O(gr(x.getChainID(Z.data.chain.id)))}else{if(n&&Z.data.tokenAddress===n.data.tokenAddress&&!t||o&&o.chainId===Z.data.chain.id&&o.resourceType===ee.address&&o.address===Z.data.tokenAddress)return re;He=O(X(Z))}let Ue,st=q.get(He);return st&&st.data.balance?Ue=st:Ue=Z,Ue&&re.push(Ue),re},[]);return p(W.length),W},[q,E,n,p,t,o]),F=Se();(0,Gt.useEffect)(()=>{C&&k.length===0&&F.capture("swapperNullSearchResult",{data:{searchQuery:m}})},[C,k,m,F]);let G=(0,Gt.useMemo)(()=>xT({includeOwnedAssets:!m,sellAsset:n,sellCaip19:r,ownedAssets:d,searchAssets:k}),[m,d,k,n,r]);return(0,Gt.useMemo)(()=>({assets:G,initialFilterKey:t??n?.data.chain.id??o?.chainId,isLoading:f||Q,isFetching:f||Q||h,error:w??N,searchRef:S,setSearchQuery:c,searchQuery:a}),[G,f,Q,h,w,N,n,S,c,o?.chainId,t,a])}s(JP,"useLiveSwapBuyAssetList");u();l();u();l();var Gle=s((e,t=9)=>{let r=(e.match(/\./g)||[]).length;return e.endsWith(".")&&r>1?e.substring(0,e.length-1):e.length===0||e.endsWith(".")||e.endsWith("0")?e:new _(e).decimalPlaces(t).toString()},"formatTokenAmountToMaxDecimals");var wu=D(L());u();l();var ET="https://help.phantom.com/hc/en-us/articles/27085326202515";var eR=[.3,.5,1],tR=eR.map(e=>`${e}%`),rR=[...tR,"custom"],oR=[.5,1,2],nR=oR.map(e=>`${e}%`),Yle=[...nR,"custom"],Xle=rR.length-1,Jle=5,epe=2,kT=.1,CT=30,sR=2,tpe=s((e,t)=>{if(!e)return;let r=parseFloat(e);if(isNaN(r))return{message:t("swapSettingsCustomInvalidValue"),severity:"critical"};if(r>CT)return{message:t("swapSlippageSettingsCustomMaxError",{maxSlippage:CT}),severity:"critical"};if(r>sR)return{message:t("swapSlippageSettingsHighSlippageWarning"),severity:"warning"};if(r<kT)return{message:t("swapSlippageSettingsCustomMinError",{minSlippage:kT}),severity:"critical"}},"getCustomSlippageError");u();l();var es=D(L());var aR={input:{maxLength:10,maxDecimals:6},bounds:{min:1e-6,low:5e-6,high:1,max:5}},cpe=s((e,t,r)=>{let o=parseFloat(e);if(isNaN(o))return{message:t("swapSettingsCustomInvalidValue"),severity:"critical"};if(o>r.max)return{message:t("swapPriorityFeeSettingsCustomMaxError",{maxPriorityFee:r.max}),severity:"critical"};if(o<r.min)return{message:t("swapPriorityFeeSettingsCustomMinError",{minPriorityFee:r.min}),severity:"critical"};if(o>r.high)return{message:t("swapPriorityFeeSettingsHighFeeWarning"),severity:"warning"};if(o<r.low)return{message:t("swapPriorityFeeSettingsLowFeeWarning"),severity:"warning"}},"validatePriorityFee"),upe=s(()=>{let[e,t]=(0,es.useState)(aR.bounds);return(0,es.useEffect)(()=>{s(async()=>{try{let o=await Xa({accounts:[],transactionType:an.Swap});t({min:o.min,low:o.low,high:o.high,max:o.max})}catch(o){P.captureError(o instanceof Error?o:new Error("Unable to fetch priority fee bounds."),M.Swapper)}},"fetchBounds")()},[]),e},"usePriorityFeeBounds");u();l();var ts=D(L());var iR={input:{maxLength:10,maxDecimals:6},bounds:{min:1e-6,low:5e-6,high:1,max:5}},hpe=s((e,t,r)=>{let o=parseFloat(e);if(isNaN(o))return{message:t("swapSettingsCustomInvalidValue"),severity:"critical"};if(o>r.max)return{message:t("swapTipSettingsCustomMaxError",{maxTip:r.max}),severity:"critical"};if(o<r.min)return{message:t("swapTipSettingsCustomMinError",{minTip:r.min}),severity:"critical"};if(o>r.high)return{message:t("swapTipSettingsHighFeeWarning"),severity:"warning"};if(o<r.low)return{message:t("swapTipSettingsLowFeeWarning"),severity:"warning"}},"validateTip"),ype=s(()=>{let[e,t]=(0,ts.useState)(iR.bounds);return(0,ts.useEffect)(()=>{s(async()=>{try{let o=await Xa({accounts:[],transactionType:an.Swap});t({min:o.min,low:o.low,high:o.high,max:o.max})}catch(o){P.captureError(o instanceof Error?o:new Error("Unable to fetch tip bounds."),M.Swapper)}},"fetchBounds")()},[]),e},"useTipBounds");u();l();var cR=[tt.lastSubmittedPairs,tt.slippageTolerance],xd=s(e=>{let t=String(e.queryKey[1]);return cR.includes(t)},"swapperShouldDehydrateQueryPredicate");u();l();var IT=D(L());u();l();function _T(){return[new Ed,new Cd,new kd]}s(_T,"getBuyAmountEditableRules");var Ed=class{static{s(this,"SwapAssetEditableRule")}isEditable({sellAsset:t}){return!!t&&x.isSolanaNetworkID(t.data.chain.id)}},kd=class{static{s(this,"CryptoCurrencyDenominationEditableRule")}isEditable({currencyDenomination:t}){return t==="crypto"}},Cd=class{static{s(this,"BridgeSwapAssetEditableRule")}isEditable({sellAsset:t,buyAsset:r}){return!$t(t?.data.chain.id,r?.data.chain.id)}};var FT=s(({sellAsset:e,buyAsset:t,currencyDenomination:r})=>{let o=Ke("enable-swapper-exact-out"),n=(0,IT.useMemo)(()=>_T(),[]);return!t||!o?!1:n.every(a=>a.isEditable({sellAsset:e,buyAsset:t,currencyDenomination:r}))},"useBuyAmountEditableRules");u();l();var _d=class{static{s(this,"NoPriceCurrencyDenominationSwitchSupportRule")}isSupported(t,r,o,n,a){switch(t){case"sell":return!!(o&&a);case"buy":return!1}}},Id=class{static{s(this,"BuyNotSupportedCurrencyDenominationSwitchSupportRule")}isSupported(t){return t!=="buy"}};function vT(){return[new _d,new Id]}s(vT,"getCurrencyDenominationSwitchSupportRules");u();l();var zT=D(L());u();l();var PT=D(L());var uR={"Allbridge's fee":"destinationNetwork","Allbridge Liquidity Fee":"liquidityProvider"},RT=s(()=>{let{currentQuote:e}=rt(),{destinationNetworkFee:t,liquidityFee:r}=(0,PT.useMemo)(()=>{function o(a){return a?{amount:new _(a.amount??0),amountUsd:a.amountUSD?parseFloat(a.amountUSD):null,pct:parseFloat(a.percentage??"0")}:ho}s(o,"bridgeFeeToFee");let n=new Map([]);return e&&se(e)&&(n=e.steps.flatMap(a=>a.includedFeeCosts).reduce((a,c)=>{if(!c)return a;let p=uR[c.name];return p&&a.set(p,c),a},n)),{destinationNetworkFee:o(n.get("destinationNetwork")),liquidityFee:o(n.get("liquidityProvider"))}},[e]);return{destinationNetworkFee:t,liquidityFee:r}},"useBridgeFees");u();l();var DT=D(L());var lR={calculate({currentQuote:e,gasEstimationPriceData:t}){return{amount:(e&&t?.gasEstimationAmount)??new _(0),amountUsd:(e&&t?.gasEstimationPriceUSDNumber)??null,pct:0}}},pR={calculate({currentQuote:e,gasEstimationPriceData:t,priceMap:r,networkID:o}){let n=(e?.fees??[]).find(p=>p.type==="tips"||p.type==="network"&&p.name!=="Token account deposits"),a=(e&&t?.gasEstimationAmount)??new _(0),c=(e&&t?.gasEstimationPriceUSDNumber)??null;if(n&&n.amount&&(a=a.plus(new _(n.amount)),c)){let p=Qt(o,new _(n.amount),r);p&&(c+=p)}return{amount:a,amountUsd:c,pct:0}}},dR={calculate({currentQuote:e,gasEstimationPriceData:t,maxGasEstimationPriceData:r}){return{amount:(e&&t?.gasEstimationAmount)??new _(0),amountUsd:(e&&t?.gasEstimationPriceUSDNumber)??null,maxAmount:(e&&r?.gasEstimationAmount)??new _(0),maxAmountUsd:(e&&r?.gasEstimationPriceUSDNumber)??null,pct:0}}},NT=s(({priceMap:e})=>{let{currentQuote:t}=rt(),r=V(d=>d.sellFungible),o=V(d=>d.gasEstimation),n=r?.data.chain.id??we.Solana.Mainnet,{data:a,isLoading:c}=_s(n,ba(o.estimate)),{data:p}=_s(n,ba(o.estimateWithBuffer));return{networkFee:(0,DT.useMemo)(()=>x.isEVMNetworkID(n)?dR.calculate({currentQuote:t,gasEstimationPriceData:a,maxGasEstimationPriceData:p}):x.isSolanaNetworkID(n)?pR.calculate({currentQuote:t,gasEstimationPriceData:a,networkID:n,priceMap:e}):lR.calculate({currentQuote:t,gasEstimationPriceData:a}),[t,a,p,n,e]),isFetchingGasEstimationPrice:c}},"useNetworkFee");u();l();var BT=D(L());var mR={calculate(){return ho}},fR={calculate({currentQuote:e,networkID:t,priceMap:r}){let o=$c(e);return{amount:o,amountUsd:Qt(t,o,r),pct:0}}},LT=s(({priceMap:e})=>{let{currentQuote:t}=rt(),o=V(a=>a.sellFungible)?.data.chain.id??we.Solana.Mainnet;return{nonIncludedFees:(0,BT.useMemo)(()=>t&&se(t)?fR.calculate({currentQuote:t,networkID:o,priceMap:e}):mR.calculate(),[o,t,e])}},"useNonIncludedFees");u();l();var UT=D(L());var gR={calculate({currentQuote:e,networkID:t,priceMap:r}){let o=(e?.fees??[]).find(n=>n.name==="Token account deposits");return{amount:new _(o?.amount??0),amountUsd:o?.amount?Qt(t,new _(o.amount),r):null,pct:o?.percentage??0}}},hR={calculate(){return ho}},MT=s(({priceMap:e})=>{let{currentQuote:t}=rt(),o=V(a=>a.sellFungible)?.data.chain.id??we.Solana.Mainnet;return{tokenAccountFee:(0,UT.useMemo)(()=>Ar(t)?gR.calculate({currentQuote:t,networkID:o,priceMap:e}):hR.calculate(),[t,o,e])}},"useTokenAccountFee");u();l();var OT=D(L());var QT={calculate:s(({tokenAccountFee:e,networkFee:t,nonIncludedFees:r,networkID:o,priceMap:n})=>{let a=e.amount.plus(t.amount).plus(r.amount);return{amount:a,amountUsd:Qt(o,a,n),pct:0}},"calculate")},yR={calculate:s(({tokenAccountFee:e,networkFee:t,nonIncludedFees:r,networkID:o,priceMap:n})=>{let a=QT.calculate({tokenAccountFee:e,networkFee:t,nonIncludedFees:r,networkID:o,priceMap:n}),c=e.amount.plus(t.maxAmount??0).plus(r.amount);return{...a,maxAmount:c,maxAmountUsd:Qt(o,c,n)}},"calculate")},qT=s(({tokenAccountFee:e,networkFee:t,nonIncludedFees:r,priceMap:o})=>{let a=V(p=>p.sellFungible)?.data.chain.id??we.Solana.Mainnet;return{totalFees:(0,OT.useMemo)(()=>x.isEVMNetworkID(a)?yR.calculate({tokenAccountFee:e,networkFee:t,nonIncludedFees:r,networkID:a,priceMap:o}):QT.calculate({tokenAccountFee:e,networkFee:t,nonIncludedFees:r,networkID:a,priceMap:o}),[t,a,r,o,e])}},"useTotalFees");var wR=s(()=>{let e=V(w=>w.gasEstimation.isFetching),t=So(),{data:r={}}=to({query:{data:t.map(w=>gr(w))}}),{networkFee:o,isFetchingGasEstimationPrice:n}=NT({priceMap:r}),a=e||n,{phantomFee:c}=Tb(),{tokenAccountFee:p}=MT({priceMap:r}),{nonIncludedFees:m}=LT({priceMap:r}),{totalFees:d}=qT({tokenAccountFee:p,networkFee:o,nonIncludedFees:m,priceMap:r}),{destinationNetworkFee:f,liquidityFee:h}=RT();return(0,zT.useMemo)(()=>({phantomFee:c,networkFee:o,tokenAccountFee:p,totalFees:d,nonIncludedFees:m,destinationNetworkFee:f,liquidityFee:h,isFetchingFees:a}),[c,o,p,d,m,f,h,a])},"useFees");u();l();var GT=D(L());var SR=s(()=>{let{resume:e}=wa(),t=V(r=>r.resetSwapper);return(0,GT.useCallback)(()=>{e(),t()},[t,e])},"useResetSwapper");u();l();var KT=D(L());function bR(){let e=Se(),t=V(h=>h.buyFungible),r=V(h=>h.sellFungible),o=V(h=>h.setBuyFungible),n=V(h=>h.setSellFungible),a=V(h=>h.setSellAmount),c=V(h=>h.setUiSellAmountCryptoInput),p=V(h=>h.resetQuote),m=V(h=>h.setSwapFilter),d=r?.data.amount,{cancelQuotes:f}=mu();return(0,KT.useCallback)(async h=>{if(r&&Go(h,r)){h&&h.data.amount!==d&&(n(h),m(void 0));return}await f();let w=Qo(h);e.capture("swapperUpdateFromAsset",{data:w}),n(h),m(void 0),t&&r&&Go(h,t)&&o(r),h&&r?.data.chain.id!==h.data.chain.id&&(p(),o(void 0),a(""),c(""))},[e,t,f,d,p,r,o,a,n,m,c])}s(bR,"useSwapSetSellAsset");u();l();var Ko=D(L());u();l();var Wr;(function(e){e.Collapsible="collapsible",e.Static="static"})(Wr||(Wr={}));u();l();var bo=D(L());u();l();u();l();var Su=class{static{s(this,"UgcAwareAssetsSectionAdapter")}sections(t){let r=$r().map(a=>a.programId),o=t.reduce((a,c)=>{if(ri({minimum:ie.Verified,spamStatus:c.data.spamStatus}))return a.verified.push(c),a;if(c.type!==oe.SPL||!c.data.ugcTokenMeta||c.data.ugcTokenMeta.status===Zf.Graduated||!r.includes(c.data.ugcTokenMeta.programId))return a.unverified.push(c),a;let p=c.data.ugcTokenMeta.programId,m=a[p]??[];return m.push(c),a[p]=m,a},{verified:[],unverified:[]}),n=$r().map(a=>{let c=o[a.programId]??[];return{id:a.programId,header:{title:v.t("swapSectionTitleTokens",{section:a.name}),iconUrl:a.iconUrl},data:c,behavior:Wr.Collapsible}});return[{id:"verified",data:o.verified,behavior:Wr.Static},{id:"unverified",header:{title:v.t("swapUnverifiedTokens")},data:o.unverified,behavior:Wr.Collapsible},...n]}};function VT(){return new Su}s(VT,"getBuyAssetsSectionAdapter");var jT=(0,bo.createContext)(void 0),vme=s(({children:e})=>{let t=(0,bo.useMemo)(()=>VT(),[]);return bo.default.createElement(jT.Provider,{value:{buyAssetSectionAdapter:t}},e)},"SwapAssetSelectProvider"),HT=s(()=>{let e=(0,bo.useContext)(jT);if(!e)throw new Error("useSwapAssetSelect must be used within a SwapAssetSelectProvider");return e},"useSwapAssetSelect");var $T=3;function Fd(e){return{id:e.id,data:e.data,...e.header?{header:e.header}:{}}}s(Fd,"convertToBaseSection");var TR=s(e=>{let[t,r]=(0,Ko.useState)({}),o=(0,Ko.useCallback)((c,p)=>r(m=>({...m,[c]:p})),[]),{buyAssetSectionAdapter:n}=HT(),a=(0,Ko.useMemo)(()=>n.sections(e),[n,e]);return(0,Ko.useMemo)(()=>a.map(c=>{switch(c.behavior){case Wr.Static:return Fd(c);case Wr.Collapsible:{if(c.data.length<=$T)return Fd(c);let p=t[c.id],m=p?c.data:c.data.slice(0,$T),d=s(()=>o(c.id,!p),"onClick"),f=Fd(c);return{...f,header:{...f.header,title:f.header?.title||"",button:{label:p?v.t("commandShowLess"):v.t("commandShowMore"),onClick:d}},data:m}}}}),[a,t,o])},"useSwapAssetCollapsibleSections");u();l();u();l();u();l();var xa=z({days:1}),vd=z({seconds:5}),WT=z({seconds:30}),cfe=z({seconds:30}),ufe=z({seconds:5}),lfe=z({seconds:5}),pfe=z({seconds:30}),dfe=z({seconds:2}),mfe=z({seconds:10}),ZT=s(e=>`/v1/actors-search?query=${encodeURIComponent(e)}`,"actorSearchEndpoint");u();l();var cA=i.object({actors:nr.array()}),nt;(function(e){e.Buy="Buy",e.Sell="Sell",e.WhaleBuy="WhaleBuy",e.WhaleSell="WhaleSell",e.TrendingToken="TrendingToken",e.TokenFollow="TokenFollow",e.SuggestedFollow="SuggestedFollow",e.TopActorList="TopActorList",e.AggregatedBuy="AggregatedBuy",e.AggregatedSell="AggregatedSell",e.RecommendedToken="RecommendedToken",e.TopTraderActivity="TopTraderActivity",e.TokenCategory="TokenCategory",e.TopTraderBuySell="TopTraderBuySell",e.HighlightedTrade="HighlightedTrade",e.SuggestedTopTraders="SuggestedTopTraders"})(nt||(nt={}));var AR=i.object({type:i.literal("followers")}),xR=i.object({type:i.literal("actor"),id:i.string()}),ER=i.union([AR,xR]),tr=i.object({actorId:i.string(),id:i.string(),published:i.coerce.string(),storyType:i.nativeEnum(nt),destinations:i.array(ER)}),uA=tr.extend({chainId:pt}),Ea=uA.extend({storyType:i.literal(nt.Buy),tokenBoughtAmount:i.string().nullish(),tokenBoughtUsdValue:i.string().nullish(),tokenBoughtPrice:i.string().nullish(),tokenBoughtAddress:i.string()}),ka=uA.extend({storyType:i.literal(nt.Sell),tokenSoldAmount:i.string().nullish(),tokenSoldUsdValue:i.string().nullish(),tokenSoldPrice:i.string().nullish(),tokenSoldAddress:i.string()}),kR=Ea.extend({storyType:i.literal(nt.WhaleBuy)}),CR=ka.extend({storyType:i.literal(nt.WhaleSell)}),_R=tr.extend({storyType:i.literal(nt.TrendingToken),chainId:pt,tokenAddress:i.string(),tokenLogoUrl:i.string(),tokenMarketCap:i.string(),tokenName:i.string(),tokenPrice:i.string(),tokenPriceChange:i.string(),tokenRank:i.string(),tokenSymbol:i.string(),tokenVolume:i.string(),tokenVolumeChange:i.string()}),IR=tr.extend({storyType:i.literal(nt.SuggestedFollow),suggestedActorId:i.string(),mutualFollowsCount:i.number(),mutualFollowsIds:i.array(i.string())}),FR=tr.extend({storyType:i.literal(nt.TokenFollow),tokenId:i.string(),otherTokenFollowers:i.array(i.string())}),vR=i.object({actorId:i.string(),percentChange:i.number()}),PR=tr.extend({storyType:i.literal(nt.TopActorList),items:i.array(vR),listName:i.string()}),lA=tr.extend({chainId:pt,tokenAddress:i.string()}),RR=lA.extend({storyType:i.literal(nt.AggregatedBuy),tokenBuyStories:i.array(Ea)}),DR=lA.extend({storyType:i.literal(nt.AggregatedSell),tokenSellStories:i.array(ka)}),NR=tr.extend({storyType:i.literal(nt.RecommendedToken),chainId:pt,tokenAddress:i.string()}),pA=i.object({type:i.enum(["buy","sell"]),chainId:pt,tokenAddress:i.string(),published:i.coerce.string()}),BR=tr.extend({storyType:i.literal(nt.TopTraderActivity),rank:i.coerce.number(),trades:i.array(pA),percentChange:i.number()}),LR={TopGainers:"top-gainers"},UR=i.union([i.literal(LR.TopGainers),i.string()]).transform(e=>e),MR=tr.extend({storyType:i.literal(nt.TokenCategory),categoryId:UR,name:i.string(),imageUrl:i.string(),tokenIds:i.array(i.string())}),OR=tr.extend({storyType:i.literal(nt.TopTraderBuySell),rank:i.coerce.number(),percentChange:i.number(),trade:i.union([Ea,ka])}),Pd;(function(e){e.TopMiss="topMiss",e.TopSave="topSave",e.TopLoss="topLoss",e.TopWin="topWin"})(Pd||(Pd={}));var QR=tr.extend({storyType:i.literal(nt.HighlightedTrade),chainId:pt,tokenAddress:i.string(),category:i.nativeEnum(Pd),categoryRank:i.number(),tradeType:i.enum(["buy","sell"]),trade:i.union([Ea,ka])}),qR=i.object({actorId:i.string(),rank:i.coerce.number(),percentChange:i.number(),evaluationWindow:i.enum(["24h","1w"]),trades:i.array(pA)}),zR=tr.extend({storyType:i.literal(nt.SuggestedTopTraders),traders:i.array(qR)}),xfe=i.union([Ea,ka,kR,CR,_R,FR,IR,PR,RR,DR,NR,BR,MR,OR,QR,zR]),bu;(function(e){e.TokenMetadataV2="TokenMetadataV2",e.Actor="Actor"})(bu||(bu={}));var GR=Xf.pick({name:!0,symbol:!0,decimals:!0,logoUri:!0,extraMetadata:!0,price:!0}),dA=i.object({id:i.string(),type:i.string()}),Dd=dA.extend({type:i.literal(bu.TokenMetadataV2),attributes:GR}),KR=dA.extend({type:i.literal(bu.Actor),attributes:nr});var YT;(function(e){e.SUGGESTED="suggested",e.BY_LIST="by-list"})(YT||(YT={}));var XT;(function(e){e.EXPLORE="explore",e.ONBOARDING="onboarding",e.PROFILE="profile",e.TOKEN="token"})(XT||(XT={}));var JT;(function(e){e.TOP_PNL_1W="top_pnl_1w",e.TOP_PNL_1M="top_pnl_1m",e.SOCIAL_ONBOARDING="social_onboarding"})(JT||(JT={}));var Tu;(function(e){e.PNL="pnl",e.PNL_BY_TOKEN="pnl-by-token",e.FOLLOWS_YOU="follows-you",e.SEND_INTERACTION="send-interaction"})(Tu||(Tu={}));var mA=i.object({actorId:i.string()}),VR=mA.extend({type:i.literal(Tu.PNL),percentChange:i.number().optional()}),jR=mA.extend({type:i.literal(Tu.PNL_BY_TOKEN),caip19:Yu,percentChange:i.number().optional()}),HR=i.discriminatedUnion("type",[VR,jR]),Efe=i.object({items:HR.array().default([]),included:KR.array().default([]),next:i.string().nullish()}),kfe=i.object({data:i.string().array().default([]),included:Dd.array().default([])}),Cfe=i.object({data:i.string().array().default([]),meta:i.object({model:i.string()}),included:Dd.array().default([])}),_fe=i.object({orderedItems:nr.array().default([]),next:i.string().optional()}),Ife=i.object({orderedItems:nr.array().default([]),next:i.string().optional()}),Ffe=i.object({orderedItems:nr.array().default([]),next:i.string().optional()}),eA;(function(e){e.ABUSE_AND_HARASSMENT="abuse_and_harassment",e.PRIVACY_AND_IMPERSONATION="privacy_and_impersonation",e.SPAM="spam"})(eA||(eA={}));var vfe=i.object({orderedItems:nr.array().default([]),next:i.string().optional()}),Pfe=i.object({orderedItems:nr.array().default([]),next:i.string().optional()}),$R=i.object({id:i.string(),username:i.string(),icon:i.string().nullish()}),Rfe=i.object({followingHolders:$R.array().default([])}),WR=i.object({targetId:i.string(),actorId:i.string(),type:i.string(),content:i.string()}),ZR=i.object({targetId:i.string(),content:i.string(),type:i.string(),count:i.number({coerce:!0})});function YR(e,t){return e==="emoji"&&Nd.includes(t)}s(YR,"canUseReactionCount");var XR=WR.transform(e=>({...e,content:Nd.includes(e.content)?e.content:te.Eyes})),Dfe=i.object({reactions:i.array(XR),counts:i.array(ZR).transform(e=>e.filter(t=>YR(t.type,t.content))).optional()}),Nfe=i.object({actors:nr.array().default([]),nextCursor:i.string().optional()}),te;(function(e){e.Bear="\u{1F43B}",e.Bull="\u{1F402}",e.CashFlying="\u{1F4B8}",e.Celebrate="\u{1F389}",e.ChartDown="\u{1F4C9}",e.ChartUp="\u{1F4C8}",e.Coin="\u{1FA99}",e.Cool="\u{1F60E}",e.CreditCard="\u{1F4B3}",e.CryLaughing="\u{1F602}",e.Crying="\u{1F62D}",e.DevilHappy="\u{1F608}",e.DevilMad="\u{1F47F}",e.Diamond="\u{1F48E}",e.Disgusted="\u{1F922}",e.Distressed="\u{1F62B}",e.Eggplant="\u{1F346}",e.Expressionless="\u{1F611}",e.Eyes="\u{1F440}",e.Fire="\u{1F525}",e.Flag="\u{1F3C1}",e.HeartEyes="\u{1F60D}",e.Heart="\u2764\uFE0F",e.Mad="\u{1F620}",e.MiddleFinger="\u{1F595}",e.MoneyBag="\u{1F4B0}",e.Moon="\u{1F319}",e.OkHand="\u{1F44C}",e.OpenMouth="\u{1F62E}",e.Peace="\u270C\uFE0F",e.Peach="\u{1F351}",e.PointUp="\u{1F446}",e.PileOfPoo="\u{1F4A9}",e.Pray="\u{1F64F}",e.Rocket="\u{1F680}",e.Siren="\u{1F6A8}",e.Skull="\u{1F480}",e.SmileWithTear="\u{1F972}",e.Smile="\u{1F600}",e.StopSign="\u{1F6D1}",e.Surprised="\u{1F632}",e.SweatDrops="\u{1F4A6}",e.Ufo="\u{1F6F8}",e.UpsideDownFace="\u{1F643}",e.Whale="\u{1F40B}"})(te||(te={}));var Nd=[te.CryLaughing,te.Disgusted,te.Mad,te.Distressed,te.HeartEyes,te.OpenMouth,te.SmileWithTear,te.UpsideDownFace,te.Smile,te.Crying,te.Surprised,te.Expressionless,te.Cool,te.DevilHappy,te.DevilMad,te.Skull,te.Eyes,te.Diamond,te.Fire,te.Eggplant,te.Peach,te.CreditCard,te.Heart,te.SweatDrops,te.Coin,te.Siren,te.MoneyBag,te.PileOfPoo,te.Celebrate,te.OkHand,te.MiddleFinger,te.PointUp,te.Peace,te.Pray,te.Rocket,te.Ufo,te.Moon,te.ChartUp,te.ChartDown,te.Flag,te.StopSign,te.Bear,te.Bull,te.CashFlying,te.Whale],Au;(function(e){e.Image="image",e.Emoji="emoji"})(Au||(Au={}));var Rd;(function(e){e.Circle="circle",e.Square="square"})(Rd||(Rd={}));var JR=i.object({type:i.literal(Au.Image),imageUrl:i.string(),shape:i.nativeEnum(Rd)}),e1=i.object({type:i.literal(Au.Emoji),unicode:i.string()}),t1=i.discriminatedUnion("type",[JR,e1]),xu;(function(e){e.Reaction="reaction",e.Icon="icon"})(xu||(xu={}));var r1=i.object({type:i.literal(xu.Reaction),content:i.string()}).transform((e,t)=>{let r=e.content;return Nd.includes(r)?{...e,content:r}:(t.addIssue({code:i.ZodIssueCode.custom,message:`Not a supported reaction ${r}`}),i.NEVER)}),o1=i.object({type:i.literal(xu.Icon),icon:i.string(),size:i.number(),backgroundColor:i.string(),foregroundColor:i.string()}),n1=i.union([r1,o1]),s1=i.object({start:i.number(),length:i.number()}),rs;(function(e){e.Profile="profile",e.Story="story",e.Token="token",e.Dapp="dapp"})(rs||(rs={}));var a1=i.object({type:i.literal(rs.Profile),profileId:i.string()}),i1=i.object({type:i.literal(rs.Story),storyId:i.string()}),c1=i.object({type:i.literal(rs.Token),tokenId:Yu}),u1=i.object({type:i.literal(rs.Dapp),dappId:i.string()}),l1=i.discriminatedUnion("type",[a1,i1,c1,u1]),p1=i.object({data:i.record(i.string(),i.any()),event:i.string()}),Bfe=i.object({id:i.string(),startImage:t1.array(),startImageBadge:n1,text:i.string(),highlight:s1.array(),action:l1,isRead:i.boolean(),published:i.coerce.string(),onActionAnalytics:p1}),Lfe=i.object({isFollowing:i.boolean()}),tA;(function(e){e.Blocking="blocking",e.Chat="chat",e.Deeplink="deeplink",e.Feed="feed",e.Followers="followers",e.FollowRequest="followRequest",e.ManageAccounts="manageAccounts",e.Notifications="notifications",e.Nux="nux",e.Onboarding="onboarding",e.PerpsLeaderboard="perpsLeaderboard",e.ReactionsDetails="reactionsDetails",e.Search="search",e.SuggestedFollows="suggestedFollows",e.SuggestedFollowsByList="suggestedFollowsByList"})(tA||(tA={}));var rA;(function(e){e.VolumeDistribution="volumeDistribution",e.VolumeDistributionAllocations="volumeDistributionAllocations",e.OpenPositions="openPositions",e.ClosedPositions="closedPositions"})(rA||(rA={}));var oA;(function(e){e.FeedTab="feed",e.Profile="profile",e.ShareStory="shareStory"})(oA||(oA={}));var Ufe=i.object({channelType:i.string(),channelId:i.string(),enabled:i.boolean()}),d1=i.object({userId:i.string(),username:i.string(),text:i.string(),createdAt:i.coerce.string()}),m1=i.object({id:i.string(),name:i.string(),image:i.string().nullish()}),Mfe=i.object({channelId:i.string(),watcherCount:i.number(),watchers:i.array(m1).default([]),lastMessages:i.array(d1)}),fA=i.object({color:i.string(),icon:i.string(),name:i.string(),requirement:i.number()}),Ofe=i.object({quantity:i.number(),quantityString:i.string(),decimals:i.number(),price:i.number().nullish(),badge:fA.nullish()}),f1=i.object({profileId:i.string(),username:i.string(),quantity:i.number()}),Qfe=i.object({channelId:i.string(),leaderboard:i.array(f1)}),qfe=i.object({badges:i.array(fA)}),nA;(function(e){e.Buy="buy",e.Sell="sell",e.BadgeUnlocked="badge_unlocked"})(nA||(nA={}));var g1=i.object({id:i.string(),tokenId:i.string(),createdAt:i.string(),updatedAt:i.string()}),zfe=i.object({data:i.array(g1),included:Dd.array().default([])}),Gfe=i.object({channelId:i.string(),tokenId:i.string(),channelType:i.string(),watcherCount:i.number()}),sA;(function(e){e.TokenPage="tokenPage",e.TrendingList="trendingList",e.RecentList="recentList",e.Banner="banner",e.Notification="notification"})(sA||(sA={}));var aA;(function(e){e.Chat="chat",e.Badges="badges"})(aA||(aA={}));var h1=i.object({profileId:i.string(),userId:i.string(),username:i.string(),icon:Xm}),y1=i.object({accountValueUsd:i.number(),pnlUsd:i.number(),roiPct:i.number(),volumeUsd:i.number()}),iA=i.object({rank:i.number(),isViewer:i.boolean(),actor:h1,performance:y1}),Kfe=i.object({leaderboard:i.array(iA),viewer:iA.nullish()}),Vfe=i.object({accountValueUsd:i.number(),pnlUsd:i.number(),roiPct:i.number(),volumeUsd:i.number(),error:i.string().optional()}),gA=i.object({market:i.string(),name:i.string(),image:i.string(),pnlUsd:i.number()}),w1=gA.extend({margin:i.number(),roiPct:i.number(),leverage:i.string(),direction:i.string()}),S1=gA.extend({id:i.string(),valueUsd:i.number(),timestamp:i.number(),type:i.string()}),b1=i.object({market:i.string(),name:i.string(),image:i.string(),color:i.string().optional(),volumePct:i.number()}),jfe=i.object({portfolio:i.object({pnlUsd:i.number(),volumeUsd:i.number()}),openPositions:i.object({positions:i.array(w1)}),closedPositions:i.object({volumeByMarket:i.array(b1),positions:i.array(S1)})}),Hfe=i.object({totalSwapVolumeUsd:i.number(),totalPerpsVolumeUsd:i.number(),totalVolumeUsd:i.number()});u();l();var os=s(({name:e,response:t,current:r,target:o})=>{let n=`Failed to ${e}: 
`,a=[r!==void 0?`Current: ${r}`:null,o!==void 0?`Target: ${o}`:null].filter(Boolean);return a.length>0&&(n+=`${a.join(" | ")} 
`),n+=`${t.status} ${t.statusText} 
`,n+=`${JSON.stringify(t.data)}`,n},"getFetcherErrorMessage"),hA=s(({name:e,error:t,current:r,target:o})=>{let n=`Failed to parse ${e}: 
`,a=[r!==void 0?`Current: ${r}`:null,o!==void 0?`Target: ${o}`:null].filter(Boolean);return a.length>0&&(n+=`${a.join(" | ")} 
`),n+=`${JSON.stringify(t)}`,n},"getParserErrorMessage");var yA=s(async e=>{P.addBreadcrumb(M.Network,"User is searching for actors.",Y.Info,{query:e});let t=await K.api().bearer(!0).get(ZT(e));if(!le(t)){let o=new Error(os({name:"searchForActor",response:t}));throw P.captureError(o,M.UserSearch),o}let r=cA.safeParse(t.data);return r.success?{actors:r.data.actors}:{actors:[]}},"searchForActor");u();l();u();l();function wA(e){let t=e.match(/\/v1\/actors\/([^/]+)/)?.[1];return t?Ka.parse(t):void 0}s(wA,"userProfileIdFromUrl");u();l();function SA(e){return wA(e)??Ka.parse(e)}s(SA,"userProfileIdFromUrlOrProfileId");u();l();var de="social",me="@phantom/social",Pr={actor(e){return[de,`${me}:actor`,{profileId:e}]},actorVolume(e){return[de,`${me}:actor-volume`,{profileId:e}]},actorAndFollowers(e){return[de,`${me}:actor-and-followers`,{profileId:e}]},actorAndFollowing(e){return[de,`${me}:actor-and-following`,{profileId:e}]},userProfileByUsernameOrUserProfileId(e){return[de,`${me}:user-profile-by-username-or-user-profile-id`,{usernameOrUserProfileId:e}]},followUser(e,t){return[de,`${me}:follow-user`,{currentId:e,targetId:t}]},followingTokens(e){return[de,`${me}:following-tokens`,{limit:e}]},feed(e,t,r){return[de,`${me}:feed`,{profileId:e,userEnabledNetworks:t,viewFeedAsUsername:r}]},feedStory(e){return[de,`${me}:feed-story`,{storyId:e}]},notifications(e){return[de,`${me}:notifications`,{profileId:e}]},searchForActorBase(){return[de,`${me}:search`]},searchForActor(e){return[de,`${me}:search`,{query:e}]},followRequests(e){return[de,`${me}:follow-requests`,{profileId:e}]},suggestedActors(e,t){return[de,`${me}:suggested-follows`,{profileId:t,source:e}]},actorList(e,t,r){return[de,`${me}:actor-list`,{profileId:r,listName:t,source:e}]},blocking(e){return[de,`${me}:blocking`,{profileId:e}]},pendingFollowRequests(e,t){return[de,`${me}:pending-follow-requests`,{profileId:e,targetId:t}]},reaction(e){return e?[de,`${me}:reaction`,{targetId:e}]:[de,`${me}:reaction`]},reactionDetails(e){return e.targetId?[de,`${me}:reaction-details`,e]:[de,`${me}:reaction-details`,{content:e.content}]},followingHolders(e,t){return[de,`${me}:following-holders`,{profileId:e,caip19:t}]},tokenFollows(e,t){return[de,`${me}:token-follows`,{profileId:e,caip19:t}]},reportedFeedTokens(){return[de,`${me}:reported-feed-tokens`]},userProfileFeed(e,t){return[de,`${me}:user-profile-feed`,{username:e,userEnabledNetworks:t}]},tokenChatEnabled(e){return[de,`${me}:token-chat-enabled`,{caip19:e}]},tokenChatStats(e){return[de,`${me}:token-chat-stats`,{caip19:e}]},tokenChatBalance(e,t){return[de,`${me}:token-chat-balance`,{caip19:e,userId:t}]},chatLeaderboard(e){return[de,`${me}:chat-leaderboard`,{caip19:e}]},tokensForYou(e,t){return[de,`${me}:tokens-for-you`,{profileId:t,limit:e}]},similarTokens(e,t,r){return[de,`${me}:similar-tokens`,{caip19:e,profileId:r,limit:t}]},popularChats(){return[de,`${me}:popular-chats`]},chatChannel(e,t){return[de,`${me}:chat-channel`,{channelType:e,channelId:t}]},perpsLeaderboard(e,t){return[de,`${me}:perps-leaderboard`,{limit:e,windowPeriod:t}]},perpsPortfolio(e,t){return[de,`${me}:perps-portfolio`,{windowPeriod:e,userId:t}]},perpsProfile(e,t,r){return[de,`${me}:perps-profile`,{profileId:e,openLimit:t,closedLimit:r}]},badgeStatus(e){return[de,`${me}:badge-status`,{caip19:e}]}};var bA=s((e,t)=>{let r=SA(t.id);r&&e.setQueryData(Pr.actor(r),t)},"setActorInQueryCache");var TA=s(async(e,t)=>{let r=t?.startsWith("@")?t.slice(1):t;if(!r)throw new Error("No sanitized username or user profile id");let o=await e.getUserProfileByUsernameOrUserProfileId(r);if(!o)throw new Error("No user profile");return o},"getUserProfileByUsernameOrUserProfileIdQueryFn");function T1({usernameOrUserProfileId:e}){let t=pf(),r=Pr.userProfileByUsernameOrUserProfileId(e);return ae({enabled:!!e,queryKey:r,queryFn:s(async()=>TA(t,e),"queryFn"),gcTime:xa,staleTime:vd})}s(T1,"useGetUserProfileByUsernameOrUserProfileId");function A1({query:e}){let t=ze(),r=e?.startsWith("@")?e.slice(1).trim():e.trim(),o=Pr.searchForActor(r),n=s(async()=>{let{actors:a}=await yA(r);for(let c of a)bA(t,c);return a.sort((c,p)=>c.isFollowing?-1:p.isFollowing?1:0),{actors:a}},"queryFn");return qa({enabled:r.length>1,queryKey:o,queryFn:n,gcTime:xa,staleTime:vd})}s(A1,"useSearchForActor");u();l();u();l();u();l();async function AA(e){let t=await K.api().bearer(!0).headers({Accept:"application/activity+json"}).get(`/v1/actors/${e}`);if(!le(t)){let o=new Error(os({name:"getActor",response:t,target:e}));throw P.captureError(o,M.Profiles),o}let r=nr.safeParse(t.data);if(r.success)return r.data;{let o=new Error(hA({name:"getActor",error:r.error,target:e}));throw P.captureError(o,M.Profiles),o}}s(AA,"getActor");function Bd(e){let t=s(async()=>{if(!e)throw new Error("No profile ID or access token");return AA(e)},"queryFn");return qa({queryKey:Pr.actor(e),queryFn:t,enabled:!!e,gcTime:xa,staleTime:WT})}s(Bd,"useGetActor");u();l();u();l();u();l();var PA=D(vA(),1),RA=PA.default;var I1=RA.bind({concatArrays:!0,ignoreUndefined:!0});function F1(e,t){let r=self.localStorage.getItem(e);if(r){let o=JSON.parse(r),n=JSON.parse(t),a=JSON.stringify(I1(o,n));self.localStorage.setItem(e,a)}else self.localStorage.setItem(e,t)}s(F1,"mergeLocalStorageItem");function as(e,t){return new Promise((r,o)=>{try{let n=e();t?.(null,n),r(n)}catch(n){t?.(n),o(n)}})}s(as,"createPromise");function Cu(e,t,r){return Promise.all(e).then(o=>{let n=r?.(o)??null;return t?.(null,n),Promise.resolve(n)},o=>(t?.(o),Promise.reject(o)))}s(Cu,"createPromiseAll");var Ca={getItem:s((e,t)=>as(()=>self.localStorage.getItem(e),t),"getItem"),setItem:s((e,t,r)=>as(()=>self.localStorage.setItem(e,t),r),"setItem"),removeItem:s((e,t)=>as(()=>self.localStorage.removeItem(e),t),"removeItem"),mergeItem:s((e,t,r)=>as(()=>F1(e,t),r),"mergeItem"),clear:s(e=>as(()=>self.localStorage.clear(),e),"clear"),getAllKeys:s(e=>as(()=>{let t=self.localStorage.length,r=[];for(let o=0;o<t;o+=1){let n=self.localStorage.key(o)||"";r.push(n)}return r},e),"getAllKeys"),flushGetRequests:s(()=>{},"flushGetRequests"),multiGet:s((e,t)=>{let r=e.map(n=>Ca.getItem(n));return Cu(r,t,s(n=>n.map((a,c)=>[e[c],a]),"processResult"))},"multiGet"),multiSet:s((e,t)=>{let r=e.map(o=>Ca.setItem(o[0],o[1]));return Cu(r,t)},"multiSet"),multiRemove:s((e,t)=>{let r=e.map(o=>Ca.removeItem(o));return Cu(r,t)},"multiRemove"),multiMerge:s((e,t)=>{let r=e.map(o=>Ca.mergeItem(o[0],o[1]));return Cu(r,t)},"multiMerge")},Ud=Ca;u();l();var DA=Ud;u();l();var v1=Object.defineProperty,NA=Object.getOwnPropertySymbols,P1=Object.prototype.hasOwnProperty,R1=Object.prototype.propertyIsEnumerable,BA=s((e,t,r)=>t in e?v1(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,"__defNormalProp"),is=s((e,t)=>{for(var r in t||(t={}))P1.call(t,r)&&BA(e,r,t[r]);if(NA)for(var r of NA(t))R1.call(t,r)&&BA(e,r,t[r]);return e},"__spreadValues"),_u=s(e=>t=>{try{let r=e(t);return r instanceof Promise?r:{then(o){return _u(o)(r)},catch(o){return this}}}catch(r){return{then(o){return this},catch(o){return _u(o)(r)}}}},"toThenable"),LA=s((e,t)=>(r,o,n)=>{let a=is({getStorage:s(()=>localStorage,"getStorage"),serialize:JSON.stringify,deserialize:JSON.parse,partialize:s(b=>b,"partialize"),version:0,merge:s((b,A)=>is(is({},A),b),"merge")},t);(a.blacklist||a.whitelist)&&console.warn(`The ${a.blacklist?"blacklist":"whitelist"} option is deprecated and will be removed in the next version. Please use the 'partialize' option instead.`);let c=!1,p=new Set,m=new Set,d;try{d=a.getStorage()}catch{}if(d)d.removeItem||console.warn(`[zustand persist middleware] The given storage for item '${a.name}' does not contain a 'removeItem' method, which will be required in v4.`);else return e((...b)=>{console.warn(`[zustand persist middleware] Unable to update item '${a.name}', the given storage is currently unavailable.`),r(...b)},o,n);let f=_u(a.serialize),h=s(()=>{let b=a.partialize(is({},o()));a.whitelist&&Object.keys(b).forEach(C=>{var I;!((I=a.whitelist)!=null&&I.includes(C))&&delete b[C]}),a.blacklist&&a.blacklist.forEach(C=>delete b[C]);let A,E=f({state:b,version:a.version}).then(C=>d.setItem(a.name,C)).catch(C=>{A=C});if(A)throw A;return E},"setItem"),w=n.setState;n.setState=(b,A)=>{w(b,A),h()};let y=e((...b)=>{r(...b),h()},o,n),S,T=s(()=>{var b;if(!d)return;c=!1,p.forEach(E=>E(o()));let A=((b=a.onRehydrateStorage)==null?void 0:b.call(a,o()))||void 0;return _u(d.getItem.bind(d))(a.name).then(E=>{if(E)return a.deserialize(E)}).then(E=>{if(E)if(typeof E.version=="number"&&E.version!==a.version){if(a.migrate)return a.migrate(E.state,E.version);console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return E.state}).then(E=>{var C;return S=a.merge(E,(C=o())!=null?C:y),r(S,!0),h()}).then(()=>{A?.(S,void 0),c=!0,m.forEach(E=>E(S))}).catch(E=>{A?.(void 0,E)})},"hydrate");return n.persist={setOptions:s(b=>{a=is(is({},a),b),b.getStorage&&(d=b.getStorage())},"setOptions"),clearStorage:s(()=>{var b;(b=d?.removeItem)==null||b.call(d,a.name)},"clearStorage"),rehydrate:s(()=>T(),"rehydrate"),hasHydrated:s(()=>c,"hasHydrated"),onHydrate:s(b=>(p.add(b),()=>{p.delete(b)}),"onHydrate"),onFinishHydration:s(b=>(m.add(b),()=>{m.delete(b)}),"onFinishHydration")},T(),S||y},"persist");u();l();u();l();var D1=10,UA={chatJoinTimestamps:new Map,chatHistory:[]},N1=We(LA((e,t)=>({...UA,recordChatJoin:s(r=>{e(o=>{let n=new Map(o.chatJoinTimestamps);n.set(r,Date.now());let a=[{chatId:r,lastJoinedTimestamp:Date.now()},...o.chatHistory.filter(c=>c.chatId!==r)].slice(0,D1);return{chatJoinTimestamps:n,chatHistory:a}})},"recordChatJoin"),recordChatLeave:s(r=>{e(o=>{let n=new Map(o.chatJoinTimestamps);return n.delete(r),{chatJoinTimestamps:n}})},"recordChatLeave"),clearChatHistory:s(()=>{e(r=>({...r,chatHistory:[]}))},"clearChatHistory"),removeChatFromHistory:s(r=>{e(o=>({...o,chatHistory:o.chatHistory.filter(n=>n.chatId!==r)}))},"removeChatFromHistory"),reset:s(()=>e(UA),"reset")}),{name:"chat-activity",getStorage:s(()=>DA,"getStorage"),partialize:s(e=>({chatHistory:e.chatHistory}),"partialize")})),MA=s(e=>N1.getState().chatJoinTimestamps.get(e),"getChatJoinTimestamp");var Md=s(async({chatTokenId:e,transactionId:t,tokenBoughtCaip19:r,tokenBoughtAmount:o,tokenBoughtUsdValue:n,tokenSoldCaip19:a,tokenSoldAmount:c,tokenSoldUsdValue:p,walletCaip19:m,chatTokenBalance:d,system:f})=>{if(!MA(e))return;let w=await K.api().bearer(!0).post("/social/v1/events/trades",{chatTokenId:e,tokenBoughtCaip19:r,tokenBoughtAmount:o,tokenBoughtUsdValue:n,tokenSoldCaip19:a,tokenSoldAmount:c,tokenSoldUsdValue:p,transactionId:t,walletCaip19:m,chatTokenBalance:d,system:f});if(!le(w)){let y=new Error(os({name:"publishSystemChatTradeMessage",response:w}));throw P.captureError(y,M.Chat),y}},"publishSystemChatTradeMessage");u();l();var B1=s(e=>{let{data:t}=Bd(e);return OA(t)},"useFollowersAndFollowingCount"),OA=s(e=>{let t={followers:e?.followers&&typeof e.followers=="object"&&e?.followers?.totalItems||0,following:e?.following&&typeof e.following=="object"&&e?.following?.totalItems||0};return{...t,formattedFollowers:pn(t.followers||0,{compact:!0}),formattedFollowing:pn(t.following||0,{compact:!0})}},"getFollowersAndFollowingCount");u();l();u();l();u();l();var QA=D(L());var Od=s(()=>{let{data:[e]}=hr(["enable-perps"]),{data:t}=_e(),r=(0,QA.useMemo)(()=>t?.addresses.some(o=>x.isEVMNetworkID(o.networkID))??!1,[t]);return e&&r},"useIsPerpsSupported");u();l();var qA;(function(e){e.BID="B",e.ASK="A"})(qA||(qA={}));var zA;(function(e){e.OPEN="open",e.FILLED="filled",e.CANCELED="canceled",e.TRIGGERED="triggered",e.REJECTED="rejected",e.MARGIN_CANCELED="margin_canceled"})(zA||(zA={}));var Qd=i.string().regex(/^\d*\.?\d+$/,"Invalid numeric string"),_a=i.string().regex(/^-?\d*\.?\d+$/,"Invalid signed numeric string");u();l();var L1=qm.extend({chainId:Mm,address:i.string()}),GA=i.object({symbol:i.string(),name:i.string(),token:L1,logoUri:i.string(),szDecimals:i.number(),maxLeverage:i.number(),price:_a,priceChange24h:i.object({amount:_a,percentage:_a}),volume24h:Qd,openInterest:Qd,fundingRate:_a,assetId:i.number(),isAtOpenInterestCap:i.boolean().optional(),description:i.string().optional()}),KA=i.object({markets:i.array(GA).transform(e=>e.reduce((t,r)=>{let o=GA.safeParse(r);return o.success&&(t[O(o.data.token)]=o.data),t},{}))}),Aye=i.object({id:i.string(),name:i.string(),logoUri:i.string(),currentPrice:i.number(),maxLeverage:i.number(),szDecimals:i.number(),assetId:i.number(),symbol:i.string()});u();l();var jA=D(L());u();l();var Iu=class{static{s(this,"CashSwapStateListener")}queryClient;storage;authRepository;cashAccount;constructor(t,r,o,n){this.queryClient=t,this.storage=r,this.authRepository=o,this.cashAccount=n}onStateChange(t,r,o,n){if(t.type===j.TransactionConfirmed){let{sell:a,buy:c,quote:p}=o.executingQuote,m=new U(p.sellAmount),d=new U(p.buyAmount);ip({queryClient:this.queryClient,storage:this.storage,authRepository:this.authRepository,sellCaip19:X(a),sellAmountBN:m,sellAddress:a.data.walletAddress,buyCaip19:X(c),buyAmountBN:d,buyAddress:c.data.walletAddress,cashAccountAddress:this.cashAccount?.addressDetails.address})}}};u();l();var Fu=class{static{s(this,"FailedCashSwapExecuteSwapStateListener")}authRepository;constructor(t){this.authRepository=t}onStateChange(t,r,o,n){let{executingQuote:a}=o,{sell:c,buy:p}=a;if(!(!je(c)&&!je(p)))switch(t.type){case j.SimulationFailed:P.addBreadcrumb(M.Cash,"Cash swap simulation failure detected, recording...",Y.Info,{sellToken:c.data.symbol,buyToken:p.data.symbol}),this.recordFailure(a,"simulation",t.error,t.executionId);break;case j.TransactionSubmissionFailed:P.addBreadcrumb(M.Cash,"Cash swap submission failure detected, recording...",Y.Info,{sellToken:c.data.symbol,buyToken:p.data.symbol}),this.recordFailure(a,"submission",t.error,t.executionId);break}}async recordFailure(t,r,o,n){try{let a=await this.authRepository?.getUser();if(!a){P.addBreadcrumb(M.Cash,"Cannot record failed cash swap: user not found",Y.Info);return}let{accessToken:c,userID:p}=a,m=t.sell,d=t.buy,f=t.quote,h=t.quoteInput,w=m.data.walletAddress,y=d.data.walletAddress;if(!w&&h?.taker){let A=et(h.taker);A.resourceType===ee.address&&(w=A.address)}if(!y&&h?.takerDestination){let A=et(h.takerDestination);A.resourceType===ee.address&&(y=A.address)}let S={type:Fo.Swap,input:{owner:w,mint:m.data.tokenAddress??"",amount:f.sellAmount,symbol:m.data.symbol??void 0,name:m.data.name??void 0,decimals:m.data.decimals,logoUri:m.data.logoUri??void 0},output:{owner:y,mint:d.data.tokenAddress??"",amount:f.buyAmount,symbol:d.data.symbol??void 0,name:d.data.name??void 0,decimals:d.data.decimals,logoUri:d.data.logoUri??void 0},quoteId:f.rfqProps?.quoteId,quoteSource:Oe(f).map(A=>A.name).join(",")},T=m.data.chain.id,b=o?.message||o?.type||"Unknown error";await pp({accessToken:c,userID:p,idempotencyKey:n,swapInfo:S,chainId:T,failureReason:b,skipNotification:!0,occurredAt:new Date().toISOString()}),P.addBreadcrumb(M.Cash,"Recorded failed cash swap",Y.Info,{failureType:r,sellToken:m.data.symbol,buyToken:d.data.symbol})}catch(a){P.addBreadcrumb(M.Cash,"Failed to record failed cash swap",Y.Error,a instanceof Error?{error:a.message}:{})}}};u();l();var vu=class{static{s(this,"SocialExecuteSwapStateListener")}swapMode;queryClient;enableChatBadges;dismissChatBadgeSheet;constructor(t,r,o,n){this.swapMode=t,this.queryClient=r,this.enableChatBadges=o,this.dismissChatBadgeSheet=n}dismissBadgeSheet(){this.enableChatBadges&&this.dismissChatBadgeSheet()}onStateChange(t,r,o,n){if(t.type===j.TransactionSubmissionStarted&&this.dismissBadgeSheet(),t.type===j.TransactionConfirmed){let{buy:a,sell:c,quote:p,account:m}=o.executingQuote,d=a.data.chain.id,f=m.addresses.find(h=>h.networkID===d);if(f){let h=X(a),w=X(c),y=Ee(p.buyAmount,a.data.decimals).toNumber(),S=Ee(p.sellAmount,c.data.decimals).toNumber(),T=O({chainId:f.networkID,address:f.address,resourceType:ee.address}),b=this.swapMode.type==="buy"?O(h):O(w),E=this.queryClient.getQueryData(cf.userProfile())?.id??"",C=this.queryClient.getQueryData(Pr.tokenChatBalance(b,E)),I=0;C&&(I=C.quantity>0?C.quantity/10**C.decimals:0);let N=["trades"];this.enableChatBadges&&N.push("badges"),Md({chatTokenId:b,transactionId:t.txReceipt.id,tokenBoughtCaip19:O(h),tokenBoughtAmount:y,tokenBoughtUsdValue:a.data.price?y*a.data.price:0,tokenSoldCaip19:O(w),tokenSoldAmount:S,tokenSoldUsdValue:c.data.price?S*c.data.price:0,walletCaip19:T,chatTokenBalance:I,system:{messages:N}})}}}};var VA=s(()=>{},"noop"),HA=s(e=>{let t=ot(),{connection:r}=dn(),o=wt(),n=on(),a=v.language,c=Se(),p=ze(),m=cu(),d=co(),f=Qa(),h=tn("kill-swapper-simulation")??!1,w=Ke("enable-chat-badges"),{data:y}=Ls();return(0,jA.useCallback)(async({showFungibleDetails:T,showBuyFungibleScreen:b=VA,showRetrySwap:A,swapMode:E,executeSwapStateListeners:C,toastMessageParser:I,uiContext:N="swapperInterstitial",preprocessor:Q,dismissChatBadgeSheet:R=VA})=>{let H=new Jn(T,b,d,[Te.SlippageExceeded],A,I),q=new Wn(p,o,f),k=new Iu(p,o,f,y),F=new $n(m,c,N,e),G=new Zn(c),W=new Yn,re=new Hn(go),Z=new vu(E,p,w,R),He=new Fu(f);try{t.subscribeExecution(q),t.subscribeExecution(k),t.subscribeExecution(G),t.subscribeExecution(F),t.subscribeExecution(H),t.subscribeExecution(W),t.subscribeExecution(re),t.subscribeExecution(He),or&&t.subscribeExecution(Z),C.forEach(st=>t.subscribeExecution(st));let Ue=await c.getDeviceId();await t.swap({signer:n,storage:o,locale:a,deviceId:Ue,connection:r,authRepository:f,isSimulationKilled:h,preprocessor:Q})}catch{}finally{t.unsubscribeExecution(q),t.unsubscribeExecution(k),t.unsubscribeExecution(G),t.unsubscribeExecution(F),t.unsubscribeExecution(H),t.unsubscribeExecution(W),t.unsubscribeExecution(re),t.unsubscribeExecution(He),t.unsubscribeExecution(Z),C.forEach(Ue=>t.unsubscribeExecution(Ue))}},[d,p,m,c,t,n,o,a,r,f,h,e,w,y])},"useExecuteSwapTokenSwap");u();l();u();l();var Zr="perps",$A={historicalOrders:s((e,t)=>[Zr,"historical-orders",e,t],"historicalOrders"),market:s(e=>[Zr,"market",e],"market"),markets:s(e=>[Zr,"markets",e.sort()],"markets"),defaultLeverage:s(()=>[Zr,"default-leverage"],"defaultLeverage"),assetLeverage:s(()=>[Zr,"asset-leverage"],"assetLeverage"),permissions:s(()=>[Zr,"config"],"permissions"),fungibleToPerpMap:s(()=>[Zr,"fungible-to-perp-map"],"fungibleToPerpMap"),fundsInTransitBanner:s(e=>[Zr,"funds-in-transit-banner",e],"fundsInTransitBanner"),fundsInTransitBannerDismissed:s(()=>[Zr,"funds-in-transit-banner-dismissed"],"fundsInTransitBannerDismissed")};u();l();var U1={perp:6,spot:8};function WA(e,t,r="perp",o=_.ROUND_HALF_UP){let n=new _(e);if(n.isInteger())return n.toString();let a=U1[r],c=Math.max(a-t,0);return n.precision(5,o).toFixed(c,o).replace(/\.?0+$/,"")}s(WA,"formatUiPrice");var M1=z({days:1}),O1=z({minutes:5});var qd=s((e,t=!1)=>ae({enabled:e.length>0,queryKey:$A.markets(e),gcTime:M1,staleTime:O1,async queryFn(){try{return await Q1(e,t)}catch(r){throw P.addBreadcrumb(M.Perps,"Failed to get perp markets",Y.Error,{caip19s:e.join(","),error:r instanceof Error?r.message:"Unknown error"}),r}}}),"useGetPerpMarkets");async function Q1(e,t=!1){let r=await K.api().get("/swap/v2/perp/markets",{params:{tokens:e.join(",")}});if(!le(r))throw new Error("Failed to get perp markets: response is not okay");let o=r.data,n=KA.safeParse(o);if(!n.success)throw new Error("Failed to get perp markets: schema validation failed");if(t){let a=n.data.markets,c={};for(let[p,m]of Object.entries(a))c[p]={...m,price:WA(m.price,m.szDecimals),priceChange24h:{...m.priceChange24h,percentage:String(Number(m.priceChange24h.percentage)/100)}};return c}return n.data.markets}s(Q1,"getPerpMarkets");var Du=D(L());u();l();var ox=D(WE()),nx=D(HE());var q1=i.object({domain:i.string(),url:i.string(),name:i.string(),category:i.string(),imageUrl:i.string(),slug:i.string()}),sx=i.object({uuid:i.string(),data:i.array(q1)}),z1=i.object({type:i.literal("site"),url:i.string(),name:i.string(),category:i.string(),imageUrl:i.string(),description:i.string().optional()}),G1=i.object({type:i.literal("tokenCategory"),id:i.string(),name:i.string(),subtitle:i.string().optional(),imageUrl:i.string(),description:i.string().optional()}),ax=i.discriminatedUnion("type",[z1,G1]),sSe=s(e=>e.type==="site","isFeaturedSite");var K1=i.object({chainId:pt,address:i.string(),name:i.string(),symbol:i.string(),logoUrl:i.string(),marketCap:i.number(),price:i.number(),priceChange:i.number(),volume:i.number(),volumeChange:i.number(),spamStatus:rl.optional().default(ie.NotVerified)}),V1=i.object({chainId:pt,address:i.string(),name:i.string(),symbol:i.string(),logoUrl:i.string(),marketCap:i.number(),price:i.number(),priceChange:i.number(),volume:i.number(),volumeChange:i.number(),spamStatus:rl.optional().default(ie.NotVerified)}),aSe=i.object({id:i.string(),name:i.string(),imageUri:i.string()}),ix=i.object({items:i.array(K1)}),iSe=i.object({items:i.array(V1)}),j1=i.object({paymentTokenId:i.string(),name:i.string(),symbol:i.string(),decimals:i.number()}),H1=i.object({verified:i.boolean(),collectionUrl:i.string(),marketplaceId:i.string(),marketplaceName:i.string(),marketplaceCollectionId:i.string()}),$1=i.object({marketplaceId:i.string(),paymentToken:j1,value:i.string()}),W1=i.object({id:i.string(),name:i.string(),volume:i.string().optional(),volumePercentChange:i.number(),marketplacePages:i.array(H1),floorPrices:i.array($1),imageUrl:i.string()}),cx=i.object({uuid:i.string(),data:i.array(W1)}),Z1=["tokens","perps","sites","collections","learn","suggested-users-to-follow","suggested-users-to-follow-by-pnl","token-categories","tokens-for-you","trending-perps"],rr=i.enum(["shortcuts","carousel",...Z1]),Y1=i.object({type:i.literal(rr.enum.shortcuts)}),X1=i.object({type:i.literal(rr.enum.carousel)}),J1=i.object({type:i.literal(rr.enum["suggested-users-to-follow"]),limit:i.number()}),eD=["7d","30d"],ZA=i.enum(eD),tD=i.object({type:i.literal(rr.enum["suggested-users-to-follow-by-pnl"]),limit:i.number(),timeFrame:i.array(ZA).refine(e=>new Set(e).size===e.length),timeFrameDefault:ZA}),Ia="all_networks",cs=i.union([pt,i.literal(Ia)]),rD=["asc","desc"],zd=i.enum(rD),oD=["rank","volume","price","price-change","market-cap"],YA=i.enum(oD),nD=["1h","24h","7d","30d"],XA=i.enum(nD),sD=i.object({type:i.literal(rr.enum.tokens),sortBy:i.array(YA).refine(e=>new Set(e).size===e.length),sortByDefault:YA,sortDirectionDefault:zd,network:i.array(cs).refine(e=>new Set(e).size===e.length),networkDefault:cs,timeFrame:i.array(XA).refine(e=>new Set(e).size===e.length),timeFrameDefault:XA,rankAlgo:i.string(),limit:i.number(),listLimit:i.number()}),aD=i.object({type:i.literal(rr.enum["token-categories"])}),iD=["volume","price-change","open-interest","trending"],Pu=i.enum(iD),cD=["1h","24h","7d","30d"],Ru=i.enum(cD),uD=i.object({type:i.literal(rr.enum.perps),sortBy:i.array(Pu).refine(e=>new Set(e).size===e.length),sortByDefault:Pu,sortDirectionDefault:zd,timeFrame:i.array(Ru).refine(e=>new Set(e).size===e.length),timeFrameDefault:Ru,limit:i.number(),listLimit:i.number()}),lD=i.object({type:i.literal(rr.enum["trending-perps"]),sortBy:i.array(Pu).refine(e=>new Set(e).size===e.length),sortByDefault:Pu,sortDirectionDefault:zd,timeFrame:i.array(Ru).refine(e=>new Set(e).size===e.length),timeFrameDefault:Ru,limit:i.number(),listLimit:i.number()}),pD=["top","rank"],JA=i.enum(pD),dD=["24h","7d","30d"],ex=i.enum(dD),mD=i.object({type:i.literal(rr.enum.sites),sortBy:i.array(JA).refine(e=>new Set(e).size===e.length),sortByDefault:JA,network:i.array(cs).refine(e=>new Set(e).size===e.length),networkDefault:cs,timeFrame:i.array(ex).refine(e=>new Set(e).size===e.length),timeFrameDefault:ex,rankAlgo:i.string(),limit:i.number(),listLimit:i.number()}),fD=["top","rank"],tx=i.enum(fD),gD=["24h","7d","30d"],rx=i.enum(gD),hD=i.object({type:i.literal(rr.enum.collections),sortBy:i.array(tx).refine(e=>new Set(e).size===e.length),sortByDefault:tx,network:i.array(cs).refine(e=>new Set(e).size===e.length),networkDefault:cs,timeFrame:i.array(rx).refine(e=>new Set(e).size===e.length),timeFrameDefault:rx,rankAlgo:i.string(),limit:i.number(),listLimit:i.number()}),yD=i.object({type:i.literal(rr.enum.learn),limit:i.number()}),wD=i.object({type:i.literal(rr.enum["tokens-for-you"]),limit:i.number(),listLimit:i.number()}),Gd=i.discriminatedUnion("type",[Y1,X1,J1,tD,sD,uD,lD,mD,hD,yD,aD,wD]),ux=i.object({sections:i.array(Gd).refine(e=>(0,ox.default)(e,(0,nx.default)(e,"type")))}),cSe=i.object({uuid:i.string(),data:i.array(Fm)}),uSe=i.object({tokenAddress:i.string(),bondingCurve:i.string(),migratedPool:i.string().optional(),name:i.string(),image:i.string(),symbol:i.string(),marketCap:i.coerce.number(),liquidity:i.coerce.number(),bondingCurvePercentage:i.coerce.number(),tokenCreatedAt:i.coerce.date(),twitter:i.string(),website:i.string(),telegram:i.string(),discord:i.string(),migratedAt:i.coerce.date().optional(),type:i.enum(["NEW","ABOUT_TO_MIGRATE","MIGRATED"]).optional(),slot:i.coerce.number().optional(),devHolding:i.coerce.number(),snipersHolding:i.coerce.number(),bundlersHolding:i.coerce.number(),top10Holding:i.coerce.number(),volume:i.coerce.number(),buysCount:i.coerce.number(),sellsCount:i.coerce.number(),uniqueHolders:i.coerce.number(),telegramCallCount:i.coerce.number(),bondingCurvePlatform:i.string()});var lx=ux.parse({sections:[{type:"shortcuts"},{type:"carousel"},{type:"tokens",sortBy:["rank","volume","price","price-change","market-cap"],sortByDefault:"rank",sortDirectionDefault:"asc",network:["solana:101","eip155:1","eip155:137","eip155:8453","sui:mainnet","bip122:000000000019d6689c085ae165831e93","all_networks"],networkDefault:"solana:101",timeFrame:["1h","24h","7d","30d"],timeFrameDefault:"24h",rankAlgo:"default",limit:3,listLimit:100},{type:"perps",sortBy:["volume","price-change","open-interest"],sortByDefault:"volume",sortDirectionDefault:"desc",timeFrame:["24h"],timeFrameDefault:"24h",limit:3,listLimit:100},{type:"trending-perps",sortBy:["trending"],sortByDefault:"trending",sortDirectionDefault:"desc",timeFrame:["24h"],timeFrameDefault:"24h",limit:3,listLimit:100},{type:"tokens-for-you",limit:3,listLimit:50},{type:"token-categories"},{type:"suggested-users-to-follow-by-pnl",limit:3,timeFrame:["7d","30d"],timeFrameDefault:"7d"},{type:"sites",sortBy:["rank","top"],sortByDefault:"rank",network:["solana:101","eip155:1","eip155:137","eip155:8453","sui:mainnet","bip122:000000000019d6689c085ae165831e93","all_networks"],networkDefault:"solana:101",timeFrame:["24h","7d","30d"],timeFrameDefault:"24h",rankAlgo:"default",limit:3,listLimit:50},{type:"learn",limit:3}]}),SD=s(e=>{try{let t=JSON.parse(e??"");return t?.sections?{sections:t.sections.filter(o=>Gd.safeParse(o).success)}:lx}catch{return lx}},"parseFeatureFlagConfig"),Kd=s(()=>{let e=Ht.getMultivariateAssignment("explore-config"),{data:[t]}=hr(["enable-fungible-categories"]),r=Ke("enable-social-tokens-for-you"),o=Od(),n=Ke("enable-trending-perps");return(0,Du.useMemo)(()=>{let a=SD(e);return or||(a={...a,sections:a.sections.filter(c=>c.type!=="suggested-users-to-follow")}),(!r||!or)&&(a={...a,sections:a.sections.filter(c=>c.type!=="tokens-for-you")}),t||(a={...a,sections:a.sections.filter(c=>c.type!=="token-categories")}),o||(a={...a,sections:a.sections.filter(c=>c.type!=="perps")}),n||(a={...a,sections:a.sections.filter(c=>c.type!=="trending-perps")}),a},[e,t,o,r,n])},"useExploreConfig"),Vd=s(()=>{let e=Kd();return(0,Du.useMemo)(()=>{let t=[];for(let r of e.sections)(r.type==="collections"||r.type==="tokens"||r.type==="perps"||r.type==="sites"||r.type==="learn"||r.type==="suggested-users-to-follow"||r.type==="suggested-users-to-follow-by-pnl"||r.type==="token-categories"||r.type==="tokens-for-you"||r.type==="trending-perps")&&t.push(r);return t},[e.sections])},"useExploreConfigNavigatableSections"),jd=s(e=>{let t=Kd();return(0,Du.useMemo)(()=>t.sections.find(o=>o.type===e)??null,[t.sections,e])},"useExploreConfigSection");u();l();u();l();u();l();u();l();var px="@phantom/fungible-categories",Nu={fungibleCategories:s(e=>[px,"fungible-categories",e],"fungibleCategories"),fungibleCategoryById:s(e=>[px,"fungible-category",e],"fungibleCategoryById")};u();l();var dx=i.object({items:i.array(mg)}),mx=i.object({id:i.string(),name:i.string(),imageUri:i.string().nullish().transform(e=>e??""),items:fg.array()});var Hd=s(({limit:e,searchQuery:t}={})=>{let{data:[r]}=hr(["enable-fungible-categories"]);return ae({enabled:r,queryKey:Nu.fungibleCategories({enabled:r,searchQuery:t}),queryFn:s(async()=>{let o=await K.api().get("/fungibles/v1/categories",{params:{limit:"100",...t?{query:t}:{}}});return dx.parse(o.data)},"queryFn"),select:s(o=>e?o.items.slice(0,e):o.items,"select")})},"useFungibleCategories");u();l();var bD=s(({id:e})=>{let{data:[t]}=hr(["enable-fungible-categories"]);return ae({enabled:t,queryKey:Nu.fungibleCategoryById({id:e,enabled:t}),queryFn:s(async()=>{let r=await K.api().get(`/fungibles/v1/categories/${e}`,{params:{includePrices:"true"}});return mx.parse(r.data)},"queryFn")})},"useFungibleCategoryById");var Qe=D(L());u();l();u();l();u();l();var fx={tokenSearchEnabled:s(()=>!0,"tokenSearchEnabled"),trendingTokensEnabled:s(()=>!1,"trendingTokensEnabled")};u();l();var gx={tokenSearchEnabled:s(()=>!0,"tokenSearchEnabled"),trendingTokensEnabled:s(()=>!0,"trendingTokensEnabled")};u();l();var hx={tokenSearchEnabled:s(()=>!0,"tokenSearchEnabled"),trendingTokensEnabled:s(()=>!1,"trendingTokensEnabled")};u();l();var yx={tokenSearchEnabled:s(()=>!0,"tokenSearchEnabled"),trendingTokensEnabled:s(()=>!0,"trendingTokensEnabled")};u();l();var wx={tokenSearchEnabled:s(()=>!0,"tokenSearchEnabled"),trendingTokensEnabled:s(()=>!1,"trendingTokensEnabled")};u();l();var Sx={tokenSearchEnabled:s(()=>!0,"tokenSearchEnabled"),trendingTokensEnabled:s(()=>!1,"trendingTokensEnabled")};u();l();var bx={tokenSearchEnabled:s(()=>!1,"tokenSearchEnabled"),trendingTokensEnabled:s(()=>!1,"trendingTokensEnabled")};u();l();var Tx={tokenSearchEnabled:s(()=>!0,"tokenSearchEnabled"),trendingTokensEnabled:s(()=>!0,"trendingTokensEnabled")};u();l();var Ax={tokenSearchEnabled:s(()=>!0,"tokenSearchEnabled"),trendingTokensEnabled:s(()=>!0,"trendingTokensEnabled")};u();l();var xx={tokenSearchEnabled:s(()=>!0,"tokenSearchEnabled"),trendingTokensEnabled:s(()=>!1,"trendingTokensEnabled")};var TD=new Jo({[ne.Solana]:Ax,[ne.Ethereum]:yx,[ne.Polygon]:Tx,[ne.Base]:gx,[ne.Arbitrum]:fx,[ne.Bitcoin]:hx,[ne.Monad]:bx,[ne.Sui]:xx,[ne.Hypercore]:wx,[ne.Hyperevm]:Sx}),$d=Xo(TD);u();l();var Ex=s(e=>["explore-dapp",e],"createExploreDappQueryKey");var kx=s(e=>e.addresses.map(t=>x.getMainnetNetworkID(t.networkID))??[],"getAccountMainnetNetworkIds");function Cx(e){try{return sr.get(e).nonNativeFungibleTokenType}catch{return oe.SolanaNative}}s(Cx,"getExploreTokenTypeFromChain");u();l();u();l();var Kt="@phantom/explore",lt={RecentlyViewedSearchItems:[Kt,"RecentlyViewedSearchItems"],sitesV2({sortBy:e,timeFrame:t,networkIDs:r,limit:o,locale:n,rankAlgo:a}){return[Kt,"sitesV2",ke,n,{sortBy:e,timeFrame:t,networkIDs:r,rankAlgo:a,limit:o}]},recommendedSites(e,t){return[Kt,"sites","recommended",ke,t,e]},featuredItems(e,t){return[Kt,"items","featured",ke,t,e]},tokensV2({sortBy:e,sortDirection:t,timeFrame:r,networkIDs:o,limit:n,rankAlgo:a}){return[Kt,"tokensV2",{sortBy:e,sortDirection:t,timeFrame:r,networkIDs:o,rankAlgo:a,limit:n}]},curated({networkIDs:e,limit:t}){return[Kt,"curated",{networkIDs:e,limit:t}]},collectionsV2({sortBy:e,timeFrame:t,networkIDs:r,limit:o,locale:n,rankAlgo:a}){return[Kt,"collectionsV2",ke,n,{sortBy:e,timeFrame:t,networkIDs:r,rankAlgo:a,limit:o}]},featuredTransactions(e,t){return[Kt,"transactions","featured",ke,t,e]},learn(e,t){return[Kt,"learn",ke,t,e]},perpMarkets(e,t,r,o,n,a){return[Kt,"perp-markets",{chainId:e,sortBy:t,sortDirection:r,timeFrame:o,limit:n,search:a}]}};var AD=10,Ix=pe.RecentlyViewedSearchItems;async function xD(e){return await e.get(Ix)??[]}s(xD,"getRecentlyViewedSearchItem");async function Fx(e,t){await e.set(Ix,t)}s(Fx,"setRecentlyViewedSearchItem");function Wd(e){return ae({queryKey:lt.RecentlyViewedSearchItems,queryFn:s(async()=>xD(e),"queryFn"),staleTime:0,enabled:!0})}s(Wd,"useGetRecentlyViewedSearchItems");function ED(e){let t=ze();return Eo({mutationFn:s(async o=>{let n=_x(o),c=(t.getQueryData(lt.RecentlyViewedSearchItems)??[]).filter(p=>_x(p)!==n);c.unshift(o),c=c.slice(0,AD),await Fx(e,c),t.setQueryData(lt.RecentlyViewedSearchItems,c),await t.refetchQueries({queryKey:lt.RecentlyViewedSearchItems})},"mutationFn")})}s(ED,"useAddRecentlyViewedSearchItem");function kD(e){let t=ze();return Eo({mutationFn:s(async()=>{await Fx(e,[]),t.setQueryData(lt.RecentlyViewedSearchItems,[]),await t.refetchQueries({queryKey:lt.RecentlyViewedSearchItems})},"mutationFn")})}s(kD,"useClearRecentlyViewedSearchItem");function _x(e){return e.type==="token"||e.type==="perp"?O(X(e.data)):e.data.id}s(_x,"keyFromSearchItem");u();l();var Zd=D(Ux()),Bu=D(L());u();l();var Mx={fields:["domain","name","category","tags"],storeFields:["domain","name","category","tags","imageUrl"],searchOptions:{boost:{name:2},prefix:!0,fuzzy:s(e=>e.length>3?.2:!1,"fuzzy")}};var Ox=s(e=>{try{let{hostname:t,pathname:r}=new URL(e);return t+r}catch{return e}},"getHostnameAndPath"),UD=s((e=[],t=[])=>{let r=[...e,...t],o=(0,Zd.default)(t,a=>Ox(a.domain)),n=new Map;return r.forEach(a=>{let c=Ox(a.domain);if(!n.has(c)){let p=o[c]||a;n.set(c,p)}}),Array.from(n.values())},"combineAndDeduplicateDapps"),MD=s(e=>{let t={isRecommended:"true"};return e.networkIds&&(t.chainIds=e.networkIds.join(",")),`/dapps/v1?${new URLSearchParams(t).toString()}`},"getRecommendedDappsEndpoint"),OD=s(async e=>{let t=await K.api().get(MD(e));if(!le(t))throw new Error("Error fetching recommended dapps from registry");if(!t?.data||!t?.data?.data)throw new Error("No data returned from registry");let r=t.data,o=(0,Zd.default)(r.data??[],a=>a.id);return Object.values(o)},"fetchRecommendedDapps"),QD=s(e=>{let t=ze();return ae({queryKey:["dapps","recommended",e],queryFn:s(async()=>{try{let o=await OD(e);return Hm.batch(()=>{for(let n of o){let a=Ex(n.domain),c=t.getQueryState(a);t.setQueryData(a,()=>n??c?.data??null)}}),o}catch(o){throw P.captureError(o,M.DappRegistry),o}},"queryFn"),gcTime:z({days:1}),staleTime:z({days:1})})},"useRecommendedSearchDapps"),Qx=s((e,t)=>{let{searchQuery:r,networkIds:o}=e,{data:n=[],...a}=QD({networkIds:o}),c=(0,Bu.useMemo)(()=>n.sort((h,w)=>w.recommendationScore-h.recommendationScore),[n]),p=(0,Bu.useMemo)(()=>UD(t,c),[t,c]),m=jh(r),d=wg(p,m,Mx);return{data:(0,Bu.useMemo)(()=>{let h=new Map(p.map(w=>[w.id,w]));return d.map(w=>h.get(w.id)).filter(w=>w!==void 0)},[d,p]),...a}},"useRecommendedSearchDappsWithQuery");u();l();u();l();var qx=s(async({sortBy:e,sortDirection:t,timeFrame:r,networkIDs:o,limit:n,rankAlgo:a,anonymousId:c})=>{let p=new URLSearchParams({timeFrame:r,sortBy:e,sortDirection:t,limit:n.toString(),rankAlgo:a,...c?{anonymousId:c}:{}});o.forEach(f=>{p.append("chainIds[]",f)});let m=await K.api().noBearer().get("/explore/v2/trending-tokens",{params:p});if(!le(m))throw new Error("Failed to fetch tokens");let d=ix.safeParse(m.data);if(!d.success)throw new Error("Failed to parse tokens");return d.data},"getTokensV2");u();l();var us=s((e,t)=>{let r=Ga(),n=Vd().find(c=>c.type===t),a=[];return n&&"network"in n?n.network.forEach(c=>{c!==Ia&&r.includes(c)&&a.push(c)}):a=r,e!==Ia&&!a.includes(e)?[]:e===Ia?a:[e]},"useExploreNetwork");var qD=z({minutes:1}),zD=z({minutes:1}),GD=100,Yd=s(({sortBy:e,sortDirection:t,timeFrame:r,network:o,limit:n,rankAlgo:a,enableQuery:c=!0})=>{let p=Se(),m=us(o,"tokens"),d=GD;return ae({queryKey:lt.tokensV2({sortBy:e,sortDirection:t,timeFrame:r,networkIDs:m,limit:d,rankAlgo:a}),enabled:c,async queryFn(){let f=await p.getDeviceId();return qx({sortBy:e,sortDirection:t,timeFrame:r,networkIDs:m,limit:d,rankAlgo:a,anonymousId:f})},gcTime:zD,staleTime:qD,retry:3,select:s(f=>n>=d?f:{...f,items:f.items.slice(0,n)},"select")})},"useTokensV2");var ls=3,KD=15,Lu=50,zx={[ie.Trusted]:1,[ie.Verified]:2,[ie.NotVerified]:3,[ie.PossibleSpam]:4,[ie.Spam]:5},VD=s((e,t=100)=>{let[r,o]=(0,Qe.useState)(!1);return(0,Qe.useEffect)(()=>{let n;return e?n=setTimeout(()=>o(!0),t):o(!1),()=>clearTimeout(n)},[e,t]),r},"useDelayedLoading"),jD=s(e=>{let t=Cx(e.chainId),r=x.getChainDefinition(e.chainId),o={name:e.name,symbol:e.symbol,logoUri:e.logoUrl,spamStatus:e.spamStatus,chain:{id:e.chainId,symbol:r.tokenSymbol,name:r.name,imageUrl:r.iconUrl}};switch(t){case oe.SPL:return{type:t,data:{...o,mintAddress:e.address}};case oe.ERC20:return{type:t,data:{...o,contractAddress:e.address}};case oe.BRC20:return{type:t,data:{...o,firstCreatedInscriptionId:e.address}};default:return null}},"mapExploreTokenToTokenMetadata"),HD=s(e=>e.reduce((t,r)=>{let o=jD(r);return o&&t.push(o),t},[]),"reduceExploreTokensToTokenMetadata"),$D=s(({searchQuery:e,networkIds:t,excludePlaceholderTokens:r=!1,extraDapps:o=[],actorSearchHook:n})=>{let[a,c]=(0,Qe.useState)(!1),[p,m]=(0,Qe.useState)(!1),[d,f]=(0,Qe.useState)(!1),[h,w]=(0,Qe.useState)(!1),[y,S]=(0,Qe.useState)(!1),T=Ke("enable-monad-mainnet"),b=(0,Qe.useMemo)(()=>t.filter(Lt=>x.isMonadNetworkID(Lt)&&x.isMainnetNetworkID(Lt)?T:$d.get(Lt).tokenSearchEnabled()),[t,T]);(0,Qe.useEffect)(()=>{c(!1),m(!1),f(!1),w(!1),S(!1)},[e]);let{data:A=[],isLoading:E}=Aa({query:e,networkIds:b,searchContext:"explore",enableQuery:!!e}),{data:C,isLoading:I}=Hd({limit:e?void 0:10,searchQuery:e}),N=jd("tokens"),{data:Q}=Yd({sortBy:N?.sortByDefault??"rank",sortDirection:N?.sortDirectionDefault??"asc",timeFrame:N?.timeFrameDefault??"24h",network:N?.networkDefault??Yo.Mainnet,limit:10,rankAlgo:N?.rankAlgo??"default",enableQuery:!e&&!r}),{tokens:R,perps:H}=(0,Qe.useMemo)(()=>A.sort((Jr,As)=>zx[Jr.data.spamStatus??ie.NotVerified]-zx[As.data.spamStatus??ie.NotVerified]).reduce((Jr,As)=>(As.type===oe.HypercoreAsset?Jr.perps.push(As):Jr.tokens.push(As),Jr),{tokens:[],perps:[]}),[A]),q=(0,Qe.useMemo)(()=>Q?.items?HD(Q.items):[],[Q?.items]),k=e.length===0?KD:ls,F=(0,Qe.useMemo)(()=>R.slice(0,p?Lu:k),[p,R,k]),G=(0,Qe.useMemo)(()=>H.slice(0,d?Lu:k),[d,H,k]),W=(0,Qe.useMemo)(()=>[...F.map(Lt=>O(X(Lt))),...q.map(Lt=>O(X(Lt)))],[F,q]),{data:re={},isLoading:Z}=to({query:{data:W},enabled:W.length>0}),He=(0,Qe.useMemo)(()=>G.map(Lt=>O(X(Lt))),[G]),{data:Ue,isPending:st}=qd(He,!0),{data:Wo=[],isLoading:Ao}=Qx({networkIds:b,searchQuery:e},o),La=Wo.slice(0,a?Lu:ls),Fe=n??(()=>({data:void 0,isLoading:!1})),{data:De,isLoading:at}=Fe({query:e}),Ne=!!e,At=Ao||E||I||at,J=Ne&&!At,Am=wt(),{data:bs}=Wd(Am),{actorsAll:xm,actors:Em}=(0,Qe.useMemo)(()=>{let Lt=De?.actors??[],Jr=Lt.slice(0,h?Lu:ls);return{actorsAll:Lt,actors:Jr}},[h,De?.actors]),km=(0,Qe.useMemo)(()=>{if(C)return y?C:C.slice(0,k)},[C,y,k]),Ts=(0,Qe.useMemo)(()=>({actors:Em,dapps:Wo,searchedDapps:La,renderShowMoreDappsButton:Ne&&Wo.length>ls,isLoading:At,tokens:F,perps:G,trendingTokens:q,renderShowMoreTokensButton:Ne&&R.length>k,renderShowMorePerpsButton:Ne&&H.length>k,renderShowMoreUsersButton:Ne&&xm.length>ls,priceMap:re,isPriceMapLoading:Z,showSearchResults:J,showMoreTokens:p,setShowMoreTokens:m,showMorePerps:d,setShowMorePerps:f,showMoreDapps:a,setShowMoreDapps:c,showMoreUsers:h,setShowMoreUsers:w,recentlyViewedSearchItems:bs,categories:km,showMoreCategories:y,setShowMoreCategories:S,renderShowMoreCategoriesButton:Ne&&C&&C?.length>ls,perpMarketMap:Ue,isPerpMarketMapLoading:st}),[Em,Wo,La,Ne,At,F,G,q,R.length,H.length,k,xm.length,re,Z,J,p,d,a,h,bs,km,y,C,Ue,st]),[Cm,OE]=(0,Qe.useState)(null),QE=VD(At);return(0,Qe.useEffect)(()=>{Ts.isLoading||OE(e?Ts:null)},[Ts.isLoading,e]),{...Ts.isLoading&&Cm?Cm:Ts,showSpinner:QE&&Ne}},"useExploreSearchList");u();l();u();l();var Kx=D(L());u();l();var Gx=s(async(e,t)=>{let r=new URLSearchParams({appVersion:ke,limit:"6",locale:t,platform:Mt});e.forEach(c=>{r.append("chainIds[]",c)});let o=await K.api().noBearer().get("/explore/v1/featured-items",{params:r});if(!le(o))throw new Error("Failed to fetch featured items");let n=await o.data;if(!n.data||!Array.isArray(n.data))return[];let a=[];for(let c of n.data)try{let p=ax.parse(c);a.push(p)}catch{}return a},"getFeaturedItems");var WD=z({minutes:10}),ZD=z({minutes:10}),YD=s(()=>{let{data:e}=_e(),t=(0,Kx.useMemo)(()=>e?kx(e):[],[e]),r=wr(v.language)??"en",o=s(async()=>{if(!e)throw new Error("No account found");return Gx(t,r)},"queryFn");return ae({queryKey:lt.featuredItems(t,r),enabled:!!e,queryFn:o,gcTime:WD,staleTime:ZD})},"useExploreFeaturedItems");u();l();u();l();var XD={rank:"trending",top:"top"},Vx=s(async({sortBy:e,timeFrame:t,networkIDs:r,limit:o,locale:n,rankAlgo:a})=>{let c=new URLSearchParams({appVersion:ke,limit:o.toString(),locale:n,platform:Mt,rankAlgo:a,rankBy:XD[e],timeframe:t});r.forEach(d=>{c.append("chainIds[]",d)});let p=await K.api().noBearer().get("/explore/v1/trending-dapps",{params:c});if(!le(p))throw new Error("Failed to fetch sites");let m=sx.safeParse(p.data);if(!m.success)throw new Error("Failed to parse sites");return m.data},"getSitesV2");var JD=z({minutes:10}),eN=z({minutes:10}),tN=s(({sortBy:e,timeFrame:t,network:r,limit:o,rankAlgo:n})=>{let{data:a}=_e(),c=us(r,"sites"),p=wr(v.language)??"en";return ae({queryKey:lt.sitesV2({sortBy:e,timeFrame:t,networkIDs:c,locale:p,limit:o,rankAlgo:n}),enabled:!!a,async queryFn(){if(!a)throw new Error("No account found");return Vx({sortBy:e,timeFrame:t,networkIDs:c,locale:p,limit:o,rankAlgo:n})},gcTime:eN,staleTime:JD,retry:3})},"useSitesV2");u();l();u();l();var rN={rank:"trending",top:"volume"},oN=s(e=>e.floorPrices.length>0&&e.marketplacePages.length>0,"collectionWithValueAndMarketPlace"),jx=s(async({sortBy:e,timeFrame:t,networkIDs:r,limit:o,locale:n,rankAlgo:a})=>{let c=new URLSearchParams({appVersion:ke,limit:o.toString(),locale:n,platform:Mt,rankAlgo:a,rankBy:rN[e],timeframe:t});r.forEach(d=>{c.append("chainIds[]",d.toString())});let p=await K.api().noBearer().get("/explore/v1/trending-collections",{params:c});if(!le(p))throw new Error("Failed to fetch collections");let m=cx.safeParse(p.data);if(!m.success)throw new Error("Failed to parse collections");return{...m.data,data:m.data.data.filter(oN)}},"getCollectionsV2");var nN=z({minutes:10}),sN=z({minutes:10}),aN=s(({sortBy:e,timeFrame:t,network:r,limit:o,rankAlgo:n})=>{let{data:a}=_e(),c=us(r,"collections"),p=wr(v.language)??"en";return ae({queryKey:lt.collectionsV2({sortBy:e,timeFrame:t,networkIDs:c,locale:p,limit:o,rankAlgo:n}),enabled:!!a,async queryFn(){if(!a)throw new Error("No account found");return jx({sortBy:e,timeFrame:t,networkIDs:c,locale:p,limit:o,rankAlgo:n})},gcTime:sN,staleTime:nN,retry:3})},"useCollectionsV2");u();l();u();l();var Hx=s(async(e,t)=>{let r=new URLSearchParams({appVersion:ke,locale:t,platform:Mt});e.forEach(a=>{r.append("chainIds[]",a)});let o=await K.api().noBearer().get("/explore/v1/learn-grid",{params:r});if(!le(o))throw new Error("Failed to fetch learn grid");return o.data},"getLearnItems");var iN=z({minutes:10}),cN=z({minutes:10}),uN=s(()=>{let e=Ga(),t=wr(v.language)??"en";return ae({queryKey:lt.learn(e,t),enabled:e.length>0,async queryFn(){return Hx(e,t)},gcTime:cN,staleTime:iN})},"useLearnV2");u();l();var ws=D(L(),1);u();l();var fs=D(L(),1);u();l();var Xd={location:0,distance:50,threshold:.2,shouldSort:!0,keys:[{name:"token.name",weight:.4},{name:"token.symbol",weight:.4},{name:"token.caip19.chainId",weight:.2}]};var Jd=30,lN=6,em=3e4,tm=5,rm=["100","500","1000"];u();l();u();l();var ps="@phantom/fiat-ramp",Fa=`${ps}:fungibles`,pN=`${ps}:payment-methods`,dN=`${ps}:providers`,mN=`${ps}:recommended-quote`,fN=`${ps}:status`,gN=`${ps}:completed`,To={fiatRampTokens(e,t,r){return[Fa,e,t,r]},fiatRampPaymentMethods(e,t,r){return[pN,e,t,r]},fiatRampProviders(e,t,r){return[dN,e,t,r]},fiatRampRecommendedQuote(e,t,r){return[mN,e,t,r]},fiatRampStatus(e,t,r){return[fN,e,t,r]},fiatRampCompleted(e,t,r){return[gN,e,t,r]}};u();l();u();l();u();l();var hN=i.object({name:i.string().nullish().default(null),symbol:i.string().nullish().default(null),decimals:i.number(),caip19:Ot,logoURI:i.string().nullish().default(null)}),yN=i.object({token:hN,addressType:Um.optional()}),nm=i.object({id:i.string(),name:i.string(),tag:i.string(),logo:i.string(),quote:i.object({displaySourceAmount:i.string(),displayDestinationAmount:i.string(),displayFee:i.string()}).optional()}),Vo;(function(e){e.CARD="CARD",e.MOBILE_WALLET="MOBILE_WALLET",e.BANK_TRANSFER="BANK_TRANSFER",e.EXCHANGE="EXCHANGE",e.LOCAL="LOCAL"})(Vo||(Vo={}));var sm=i.object({id:i.string(),type:i.nativeEnum(Vo),name:i.string(),estimatedArrival:i.string(),assets:i.object({icon:i.string(),roundIcon:i.string()}),description:i.string().optional()}),vEe=i.object({groups:i.array(i.object({groupName:i.string(),tokens:i.array(yN)}))}),PEe=i.object({paymentMethods:i.array(sm),provider:nm.optional()}),REe=i.object({providers:i.array(nm),paymentMethod:sm,token:Ot}),DEe=i.object({provider:nm,paymentMethod:sm,location:i.object({countryCode:i.string(),subdivision:i.string().optional()}).optional(),token:Ot.optional(),tokenAmount:i.string().optional(),fiatAmount:i.string().optional(),fiatCurrencyCode:i.string().optional(),minPurchaseAmount:i.string().optional(),maxPurchaseAmount:i.string().optional(),quickSelectDenominations:i.array(i.string()).optional()}),NEe=i.object({url:i.string(),sessionId:i.string()}),om;(function(e){e.PENDING="PENDING",e.COMPLETED="COMPLETED",e.FAILED="FAILED"})(om||(om={}));var BEe=i.object({status:i.nativeEnum(om),tokenAmount:i.number().optional(),fiatCurrencyCode:i.string().optional(),usdFiatAmount:i.number().optional(),usdFiatFeeAmount:i.number().optional(),fiatFeeAmount:i.number().optional(),cryptoTransactionId:i.string().optional(),createdAt:i.date().optional(),updatedAt:i.date().optional()}),Nt=class extends Error{static{s(this,"FiatRampError")}constructor(t){super(t),this.name="FiatRampError"}};var $x=new Nt("Failed to get FiatRampPaymentMethods"),Wx=s(async(e,t,r)=>{try{let o=await K.api().headers(e).bearer(r).post("/fiat_ramp/v2/onramp/payment_methods",t);if(!le(o))throw $x;return o.data}catch{throw $x}},"getPaymentMethods");var wN=z({days:7}),SN=z({hours:1}),va=s((e,t,r,o)=>{let n={"x-client-platform":e,"x-client-app-version":t,"x-client-locale":r},{data:a}=yr(),c=a?.userID,p=a?.accessToken;return ae({queryKey:To.fiatRampPaymentMethods(n,o,c),queryFn:s(()=>Wx(n,o,p),"queryFn"),gcTime:wN,staleTime:SN})},"useFiatRampPaymentMethods");u();l();u();l();var Zx=new Nt("Failed to get FiatRampProviders"),Yx=s(async(e,t,r)=>{try{let o=await K.api().headers(e).bearer(r).post("/fiat_ramp/v2/onramp/providers",t);if(!le(o))throw Zx;return o.data}catch{throw Zx}},"getProviders");var bN=z({seconds:Jd}),TN=z({hours:1}),am=s((e,t,r,o)=>{let n={"x-client-platform":e,"x-client-app-version":t,"x-client-locale":r},{data:a}=yr(),c=a?.userID,p=a?.accessToken;return ae({queryKey:To.fiatRampProviders(n,o,c),queryFn:s(()=>Yx(n,o,p),"queryFn"),gcTime:TN,staleTime:bN,enabled:!!o.destinationAddress})},"useFiatRampProviders");u();l();u();l();var Xx=new Nt("Failed to get FiatRampRecommendedQuote"),Jx=s(async(e,t,r)=>{try{let o=await K.api().headers(e).bearer(r).post("/fiat_ramp/v2/onramp/recommended_quote",t);if(!le(o))throw Xx;return o.data}catch{throw Xx}},"getRecommendedQuote");var AN=z({days:7}),xN=z({hours:1}),Uu=s((e,t,r,o,n=!0)=>{let a={"x-client-platform":e,"x-client-app-version":t,"x-client-locale":r},{data:c}=yr(),p=c?.userID,m=c?.accessToken;return ae({queryKey:To.fiatRampRecommendedQuote(a,o,p),queryFn:s(()=>Jx(a,o,m),"queryFn"),gcTime:AN,staleTime:xN,enabled:n})},"useFiatRampRecommendedQuote");u();l();u();l();var eE=new Nt("Failed to get FiatRampTokens"),tE=s(async(e,t,r)=>{try{let o=await K.api().headers(e).bearer(r).post("/fiat_ramp/v2/onramp/tokens",t);if(!le(o))throw eE;return o.data}catch{throw eE}},"getSupportedFiatRampTokens");u();l();var Mu=s(e=>e.sort((t,r)=>x.compareNetworkID(t.token.caip19.chainId,r.token.caip19.chainId)),"sortFiatTokens");var EN=z({days:7}),kN=z({hours:1}),ds=s((e,t,r,o=!0,n)=>{let{data:a}=_e(),c=Array.from(new Set(a?.addresses?.map(y=>y.networkID))),p=Array.from(new Set(a?.addresses?.map(y=>y.addressType))),m={chainIDs:c},d={"x-client-platform":e,"x-client-app-version":t,"x-client-locale":r},{data:f}=yr(),h=f?.userID,w=f?.accessToken;return ae({queryKey:To.fiatRampTokens(d,m,h),queryFn:s(()=>tE(d,m,w),"queryFn"),gcTime:EN,staleTime:kN,enabled:o&&c.length>0,select:s(y=>{let S={...y,groups:y.groups.map(T=>({...T,tokens:Mu(T.tokens.filter(b=>b.addressType?p.includes(b.addressType):!0))}))};return n?n(S):S},"select")})},"useFiatRampGroupedTokens");u();l();u();l();var rE=s(e=>{let t=e?.groups.flatMap(r=>r.tokens)??[];return Mu(t)},"flattenAndSortTokens");var ms=s((e,t,r,o=!0)=>ds(e,t,r,o,rE),"useAllFiatRampTokens");u();l();var Yr={onClose:s(()=>{},"onClose"),context:"modal",fungible:void 0,purchaseAmount:"0",purchaseType:"currency",isPurchaseAmountValid:!1,error:void 0,redirectErrorMessage:void 0,ownerPublicKey:"",price:0,minPurchaseAmountUsd:tm,maxPurchaseAmountUsd:em,quickSelectDenominations:rm,paymentMethod:void 0,provider:void 0,checkoutQuoteType:"recommended",redirectURL:void 0,stripePaymentMethod:void 0},Bt=We(e=>({...Yr,setState:s(t=>e(r=>({...r,...t})),"setState"),reset:s(()=>{e(Yr)},"reset")}));var oE=s(({platform:e,version:t,onClosePress:r,onNextPress:o})=>{let n=Se(),{i18n:a}=Ie(),c=a.language,{setState:p}=Bt(),{data:m}=_e(),d=Array.from(new Set(m?.addresses?.map(R=>R.addressType))),{data:f=[]}=ms(e,t,c),{data:h,isPending:w,isFetching:y,isError:S}=ds(e,t,c),T=h?.groups??[],b=w||y||S,[A,E]=(0,fs.useState)(""),C=Ha(A)??"",I=A.length>0,N=yg(f,C,Xd),Q=(0,fs.useCallback)(({tokenWithMetadata:R,ownerPublicKey:H})=>{let{token:q}=R,{name:k,symbol:F,caip19:G}=q,{chainId:W}=G;n.capture("fiatOnrampFungibleSelected",{data:{networkId:W,chainId:x.getChainID(W),asset:{name:k,symbol:F,type:"fungible"}}}),p({...Yr,onClose:r,ownerPublicKey:H,fungible:R.token}),o()},[n,r,o,p]);return(0,fs.useEffect)(()=>{n.capture("fiatOnrampInitiated")},[n]),{enabledAddressTypes:d,groupedTokens:T,isLoading:b,isSearching:I,searchedTokens:N,searchTerm:A,selectedAccount:m,onClosePress:r,onTokenPress:Q,setSearchTerm:E}},"useFiatRampSelectFungible");u();l();var jt=D(L(),1);u();l();var hs=D(L(),1);u();l();var im=D(L(),1);var cm=s(({marginBottom:e=0})=>{let{t}=Ie(),{data:[r]}=hr(["enable-buy-flow-warning"]);return r?im.default.createElement(fe,{marginBottom:e},im.default.createElement(yf,{level:"4-error"},t("buyFlowHealthWarning"))):null},"BuyFlowWarning");u();l();var jo=D(L(),1);u();l();var Vt=D(L(),1);u();l();var pr=D(L(),1);var Ou=48,um=pr.default.memo(({networkId:e,logoURI:t,type:r})=>{let o=CN({disableBadge:!1,tokenType:r,chain:x.getChainID(e)});return pr.default.createElement(fe,{size:Ou,position:"relative"},t?pr.default.createElement(Nr,{src:t,height:Ou,width:Ou,borderRadius:"circle",fallback:pr.default.createElement(nE,null)}):pr.default.createElement(nE,null),o?pr.default.createElement(_N,{networkId:e}):null)}),nE=s(()=>pr.default.createElement(fe,{alignItems:"center",justifyContent:"center",size:Ou,backgroundColor:"areaBase",borderRadius:"circle"},pr.default.createElement(eo.Coin,{size:"50%",color:"borderBase"})),"TokenImageFallback"),CN=s(({disableBadge:e,tokenType:t,chain:r})=>e?!1:sr.get(r).alwaysShowNetworkBadge?!0:!St(t),"showNetworkBadge"),_N=s(({networkId:e})=>pr.default.createElement(fe,{right:"-2",bottom:"-2",position:"absolute",borderColor:"elementBase",borderStyle:"solid",borderWidth:2,style:{borderRadius:9}},pr.default.createElement(Tg,{networkID:e,size:18})),"ChainBadge");u();l();var gs=D(L(),1);var sE=s(({image:e,name:t,symbol:r,onPress:o})=>gs.default.createElement(fe,{backgroundColor:"elementBase",borderRadius:"base",padding:16,onPress:o},gs.default.createElement(fe,{gap:12},e,gs.default.createElement(fe,{gap:4,alignItems:"flex-start"},gs.default.createElement(dt,null,t),gs.default.createElement(dt,{color:"textDiminished"},r)))),"TokenCard");var Pa=Vt.default.memo(({enabledAddressTypes:e,selectedAccount:t,tokenWithMetadata:r,type:o,onPress:n})=>{let{token:a,addressType:c}=r,{caip19:p,logoURI:m,name:d,symbol:f}=a,{chainId:h}=p,w=Wf(p),{t:y}=Ie(),S=d??y("assetDetailUnknownToken"),T=(0,Vt.useMemo)(()=>{let A=t?.addresses.find(E=>c?E.addressType===c&&E.networkID===h:E.networkID===h)?.address??"";return x.isEVMNetworkID(h)?A.toLowerCase():A},[t,c,h]),b=(0,Vt.useCallback)(()=>{n({tokenWithMetadata:r,ownerPublicKey:T})},[n,r,T]);return c&&!e.includes(c)?Vt.default.createElement(Vt.default.Fragment,null):o==="card"?Vt.default.createElement(sE,{onPress:b,image:Vt.default.createElement(um,{logoURI:m,networkId:p.chainId,type:w}),name:S,symbol:f}):Vt.default.createElement(ja,{onPress:b,start:Vt.default.createElement(um,{logoURI:m,networkId:p.chainId,type:w}),topLeft:{text:S,after:Vt.default.createElement(Ag,{networkID:p.chainId,address:T})},bottomLeft:f})});var aE=s(({enabledAddressTypes:e,group:t,groupIndex:r,selectedAccount:o,onTokenPress:n})=>{let a=r===0;return jo.default.createElement(fe,{key:t.groupName,marginTop:a?8:24},jo.default.createElement(dt,{font:xo?"bodyMedium":"title3Semibold",color:"textDiminished",marginBottom:8},t.groupName),jo.default.createElement(fe,{flexWrap:"wrap",direction:"row",gap:a?0:"list"},t.tokens.map((c,p)=>{let{token:m,addressType:d}=c,f=`${m.symbol}-${m.caip19.chainId}-${p}`;return d&&!e.includes(d)?null:a?jo.default.createElement(fe,{key:f,flexBasis:"50%",paddingLeft:p%2===0?0:4,paddingRight:p%2===0?4:0,paddingBottom:p>=t.tokens.length-2?0:8},jo.default.createElement(Pa,{enabledAddressTypes:e,selectedAccount:o,tokenWithMetadata:t.tokens[p],type:"card",onPress:n})):jo.default.createElement(Pa,{key:f,tokenWithMetadata:t.tokens[p],enabledAddressTypes:e,selectedAccount:o,type:"row",onPress:n})})))},"FiatRampTokenGroup");var iE=hs.default.memo(({groupedTokens:e,enabledAddressTypes:t,selectedAccount:r,onTokenPress:o})=>hs.default.createElement(hs.default.Fragment,null,hs.default.createElement(cm,{marginBottom:16}),e.map((n,a)=>hs.default.createElement(aE,{enabledAddressTypes:t,group:n,groupIndex:a,key:n.groupName,onTokenPress:o,selectedAccount:r}))));u();l();var ys=D(L(),1);var cE=ys.default.memo(({enabledAddressTypes:e,searchedTokens:t,selectedAccount:r,onTokenPress:o})=>ys.default.createElement(ys.default.Fragment,null,t.map((n,a)=>ys.default.createElement(fe,{key:`${n.token.symbol}-${n.token.caip19.chainId}-${a}`,marginBottom:8},ys.default.createElement(Pa,{enabledAddressTypes:e,selectedAccount:r,tokenWithMetadata:n,type:"row",onPress:o})))));var uE=s(e=>{let{isLoading:t,isSearching:r,searchedTokens:o,selectedAccount:n,enabledAddressTypes:a,onTokenPress:c,groupedTokens:p}=e;return jt.default.createElement(jt.default.Fragment,null,t?jt.default.createElement(IN,null):r?jt.default.createElement(jt.default.Fragment,null,o.length>0?jt.default.createElement(cE,{searchedTokens:o,selectedAccount:n,enabledAddressTypes:a,onTokenPress:c}):jt.default.createElement(FN,null)):jt.default.createElement(iE,{enabledAddressTypes:a,groupedTokens:p,selectedAccount:n,onTokenPress:c}))},"FiatRampFungiblesCore"),IN=s(()=>jt.default.createElement(fe,{gap:"list",paddingTop:"screen"},[...Array(3)].map((e,t)=>jt.default.createElement(sn,{key:t,topRight:!1,bottomRight:!1}))),"FiatRampTokensLoading"),FN=s(()=>{let{t:e}=Ie();return jt.default.createElement(fe,{flex:1,alignItems:"center",justifyContent:"center"},jt.default.createElement(dt,{font:"body",color:"textDiminished",align:"center"},e("noBuyOptionsAvailableInCountry")))},"FiatRampTokensEmpty");var lE={container:Ju({display:"flex",flexDirection:"column",height:"100%"}),listContainer:Ju({overflow:"auto",minHeight:0,paddingTop:16,paddingBottom:80})},pE=s(({platform:e,navigateToForm:t,onBackPress:r})=>{let{t:o}=Ie(),n=oE({platform:e,version:ke,onClosePress:r,onNextPress:t});return ws.default.createElement(fe,{flex:1,className:lE.container},ws.default.createElement(hf,{id:"search",label:"Search",showLabel:!1,placeholder:o("assetListSearch"),setValue:n.setSearchTerm,value:n.searchTerm||""},ws.default.createElement(eo.Search,{size:16,color:"textDiminished"})),ws.default.createElement(fe,{flex:1,className:lE.listContainer},ws.default.createElement(uE,{...n})))},"FiatRampFungibles");u();l();u();l();var fE=D(L(),1);u();l();var Ye=D(L(),1);u();l();var Ra=D(L());var dE=s(({platform:e,navigateToAllProviders:t})=>{let{t:r}=Ie(),o=Bt(),{provider:n,fungible:a}=o,{currencyCode:c}=mt(),{data:p}=va(e,ke,v.language,{token:a?.caip19,fiatCurrencyCode:c,providerId:n?.id}),m=p?.provider||n;return Ra.default.createElement(fe,{onPress:t,direction:"row",alignItems:"center",justifyContent:"flex-start",gap:4},Ra.default.createElement(Nr,{borderRadius:6,width:20,height:20,src:m?.logo??""}),Ra.default.createElement(dt,{font:"captionSemibold",color:"textBase",children:m?.name||r("fiatRampChangeProviderTitle")}),Ra.default.createElement(eo.ChevronDown,{size:16}))},"FiatRampSelectedProvider");u();l();var dr=D(L(),1);var lm=s(({assets:e,type:t,name:r,onClick:o,estimatedArrival:n})=>{let a=(0,dr.useMemo)(()=>{let c=dr.default.createElement(fe,{borderRadius:"circle",size:48,alignItems:"center",justifyContent:"center",backgroundColor:"black"},dr.default.createElement(Nr,{width:28,height:28,src:e.icon}));switch(t){case Vo.CARD:return dr.default.createElement(ks,{icon:"CreditCard",size:48,backgroundColor:"black",color:"white"});case Vo.BANK_TRANSFER:return dr.default.createElement(ks,{icon:"Bank",size:48,backgroundColor:"black",color:"white"});case Vo.MOBILE_WALLET:return r.toLowerCase().includes("apple")?dr.default.createElement(ks,{icon:"LogoApplePay",size:48,backgroundColor:"black",color:"white"}):r.toLowerCase().includes("google")?dr.default.createElement(ks,{icon:"LogoGooglePay",size:48,backgroundColor:"black",color:"white"}):c;default:return c}},[e.icon,r,t]);return dr.default.createElement(wf,{rows:[{type:"base",start:a,topLeft:{text:r,font:"title3Semibold"},bottomLeft:{before:dr.default.createElement(eo.Clock,{color:"textDiminished",size:14}),text:n},onPress:o}]})},"FiatRampPaymentMethodRow");var vN=["ios","android"],mE=s(({platform:e,navigateToAllProviders:t,navigateToForm:r})=>{let{t:o}=Ie(),n=Se(),a=Bt(),c=Bt(E=>E.setState),{provider:p,fungible:m}=a,{currencyCode:d}=mt(),{data:f,isFetching:h,isPending:w}=va(e,ke,v.language,{token:m?.caip19,fiatCurrencyCode:d,providerId:p?.id}),{provider:y,paymentMethods:S}=f??{},T=y||p,b=(0,Ye.useCallback)(E=>{c({paymentMethod:E,provider:T,checkoutQuoteType:"selected"}),n.capture("fiatOnrampPaymentMethodSelected",{data:{paymentMethodId:E.id}}),r()},[n,r,T,c]),A=(0,Ye.useMemo)(()=>h||w?Ye.default.createElement(Ye.default.Fragment,null,[...Array(3)].map((E,C)=>Ye.default.createElement(sn,{key:C,topRight:!1,bottomRight:!1}))):S?.length===0?Ye.default.createElement(PN,null):Ye.default.createElement(Ye.default.Fragment,null,S?.map(E=>Ye.default.createElement(lm,{key:E.id,onClick:s(()=>b(E),"onClick"),...E}))),[h,w,b,S]);return Ye.default.createElement(fe,{gap:12},!vN.includes(e)&&Ye.default.createElement(fe,{direction:"row",alignItems:"center",gap:16,justifyContent:"space-between"},Ye.default.createElement(dt,{font:"title1Semibold",color:"textBase",children:o("fiatRampPaymentMethodsTitle")}),Ye.default.createElement(dE,{platform:e,navigateToAllProviders:t})),Ye.default.createElement(dt,{font:"label",color:"textDiminished",children:o("buyThirdPartyScreenPaymentMethodDescription")}),Ye.default.createElement(fe,{gap:8},A))},"FiatRampPaymentMethodsCore"),PN=s(()=>{let{t:e}=Ie();return Ye.default.createElement(fe,{flex:1,alignItems:"center",justifyContent:"center"},Ye.default.createElement(dt,{font:"body",color:"textDiminished",align:"center"},e("buyThirdPartyScreenPaymentMethodEmptyState")))},"FiatRampPaymentMethodsEmpty");var gE=s(({platform:e,navigateToAllProviders:t,navigateToForm:r})=>fE.default.createElement(mE,{platform:e,navigateToAllProviders:t,navigateToForm:r}),"FiatRampPaymentMethods");u();l();var yE=D(L(),1);u();l();var yt=D(L(),1);var hE=s(({platform:e,navigateToPaymentMethods:t})=>{let{t:r}=Ie(),o=Se(),n=Ke("enable-fiat-ramp-provider-quotes"),a=Bt(),c=Bt(C=>C.setState),{paymentMethod:p,purchaseType:m,purchaseAmount:d,fungible:f,ownerPublicKey:h}=a,{currencyCode:w}=mt(),{data:y,isFetching:S,isPending:T}=am(e,ke,v.language,{...m==="currency"?{fiatAmount:d}:{tokenAmount:d},token:f?.caip19,fiatCurrencyCode:w,destinationAddress:h&&f?{address:h,chainId:f?.caip19.chainId,resourceType:ee.address}:void 0}),b=y?.paymentMethod||p,A=(0,yt.useCallback)(C=>{o.capture("fiatOnrampProviderSelected",{data:{chainId:y?.token?.chainId,providerId:C.id,paymentMethodId:b?.id,destinationAmount:C.quote?.displayDestinationAmount,sourceAmount:C.quote?.displaySourceAmount,asset:y?.token,tag:C.tag}}),c({provider:C,paymentMethod:b,checkoutQuoteType:"selected"}),t?.()},[o,y?.token,c,b,t]),E=(0,yt.useMemo)(()=>y?.providers.map((C,I)=>{let N=C.id===a.provider?.id;return n?{type:"base",start:yt.default.createElement(Nr,{width:48,height:48,borderRadius:6,src:C.logo}),topLeft:C.name,topRight:{text:C.quote?.displayDestinationAmount,color:"textBase"},bottomRight:C.quote?.displaySourceAmount?{text:`~${C.quote.displaySourceAmount}`}:void 0,bottomLeft:C.tag&&{text:C.tag,color:I===0?"spotPositive":"textDiminished"},onPress:s(()=>A(C),"onPress")}:{type:"radio",active:N,start:yt.default.createElement(Nr,{width:24,height:24,borderRadius:6,src:C.logo}),topLeft:C.name,topRight:C.tag,onPress:s(()=>A(C),"onPress")}})??[],[a.provider?.id,n,A,y?.providers]);return yt.default.createElement(fe,{gap:16},yt.default.createElement(dt,{font:"label",color:"textDiminished",children:r("buyThirdPartyScreenProvidersDescription")}),yt.default.createElement(fe,{gap:8},S||T?yt.default.createElement(DN,null):y?.providers.length===0?yt.default.createElement(RN,null):E.map(C=>yt.default.createElement(ja,{...C,key:C.topLeft}))))},"FiatRampProvidersCore"),RN=s(()=>{let{t:e}=Ie();return yt.default.createElement(fe,{flex:1,alignItems:"center",justifyContent:"center"},yt.default.createElement(dt,{font:"body",color:"textDiminished",align:"center"},e("buyThirdPartyScreenProvidersEmptyState")))},"FiatRampProvidersEmpty"),DN=s(()=>[...Array(3)].map((e,t)=>yt.default.createElement(sn,{key:t,topRight:!1,bottomRight:!1})),"LoadingTable");var wE=s(({platform:e,navigateToPaymentMethods:t})=>yE.default.createElement(hE,{platform:e,navigateToPaymentMethods:t}),"FiatRampProviders");u();l();u();l();u();l();var Ho=D(L(),1);u();l();var Qu=D(L(),1);var pm=s(({clientPlatform:e,appVersion:t,locale:r,caip19:o,addressType:n,enabled:a=!0,destinationAddress:c})=>{let{data:p,isLoading:m,isError:d,isFetched:f}=_e(),{data:h=[],isLoading:w,isError:y,isFetched:S}=ms(e,t,r,a),T=(0,Qu.useMemo)(()=>{if(o)return h.find(A=>n&&x.getChainName(et(o).chainId)===x.bitcoin.name?O(A.token.caip19)===o&&"addressType"in A&&A.addressType===n:O(A.token.caip19)===o)},[n,o,h]),b=(0,Qu.useMemo)(()=>{if(!T)return"";if(c)return c;let A=p?.addresses.find(E=>T?.addressType?E.addressType===T.addressType&&E.networkID===T?.token.caip19.chainId:E.networkID===T?.token.caip19.chainId)?.address??"";return T?.token.caip19.chainId&&x.isEVMNetworkID(T.token.caip19.chainId)&&(A=A.toLowerCase()),A},[c,p?.addresses,T]);return(0,Qu.useMemo)(()=>({tokenToBuy:T,destinationAddress:b,isLoading:m||w,isError:d||y,isFetched:f&&S}),[b,y,d,S,f,w,m,T])},"useFiatRampTokenMetadataFromCaip19");var SE=s(({caip19:e,amount:t,clientPlatform:r,redirectURL:o,addressType:n,destinationAddress:a,provider:c,paymentMethod:p,navigateToFiatRampForm:m,onClose:d,captureAnalyticsEvent:f})=>{let{setState:h}=Bt(),{tokenToBuy:w,destinationAddress:y,isLoading:S,isError:T,isFetched:b}=pm({clientPlatform:r,appVersion:ke,locale:v.language,caip19:e,addressType:n,destinationAddress:a}),A=(0,Ho.useMemo)(()=>{if(w)return{token:w?.token.caip19,providerId:c,paymentMethodId:p,destinationAddress:{address:y,chainId:w?.token.caip19?.chainId,resourceType:ee.address}}},[w,c,p,y]),{data:E,isLoading:C}=Uu(r,ke,v.language,A??{},!!A&&!!c&&!!p),I=(0,Ho.useMemo)(()=>e?C?!1:!!w&&!!y:!0,[e,C,y,w]),N=(0,Ho.useCallback)(()=>{!e||!w||!y||h({...Yr,onClose:d??(()=>{}),ownerPublicKey:y,fungible:w?.token,purchaseAmount:t??Yr.purchaseAmount,redirectURL:o,provider:E?.provider,paymentMethod:E?.paymentMethod})},[e,w,y,h,d,t,o,E?.provider,E?.paymentMethod]),Q=(0,Ho.useCallback)(()=>{if(!e){f?.(),m?.();return}!w||!y||(N(),f?.(),m?.())},[e,f,y,m,N,w]);return(0,Ho.useMemo)(()=>({canBuy:I,openBuy:Q,saturateState:N,resolvedDestinationAddress:y,token:w,isLoading:S,isError:T,isFetched:b}),[I,y,T,b,S,Q,N,w])},"useBuyFlowForToken");u();l();var NN=new Nt("Failed to get FiatRampProviderUrl"),BN=s(async(e,t,r,o,n)=>{try{let a={"x-client-platform":e,"x-client-app-version":t,"x-client-locale":r},c=await K.api().headers(a).bearer(n).post("/fiat_ramp/v2/onramp/provider_url",o);if(!le(c))throw new Nt(c.data.message);return c.data}catch(a){throw a instanceof Nt?a:NN}},"getProviderUrl");u();l();var qu=D(L());var LN=["enable","reject"],UN=s(({continueSwap:e,dismiss:t})=>{let r=Se(),{setSlippageSetting:o}=co(),n=(0,qu.useCallback)(c=>{switch(t(),c){case"enable":r.capture("autoSlippageOptIn",{data:{step:"enabledAutoSlippage"}}),o({type:ce.Auto}),Sa();break;case"reject":r.capture("autoSlippageOptIn",{data:{step:"rejectedAutoSlippage"}}),o({type:ce.Fixed}),e();break}},[e,t,o,r]),a=(0,qu.useMemo)(()=>LN.map(c=>({label:v.t(c==="enable"?"swapSlippageOptInEnableOption":"swapSlippageOptInRejectOption"),variant:c==="enable"?"primary":"secondary",onPress:s(()=>n(c),"onPress")})),[n]);return{title:v.t("swapSlippageOptInTitle"),description:v.t("swapSlippageOptInSubtitle"),learnMoreText:v.t("commandLearnMore"),learnMoreUrl:ET,options:a}},"useAutoSlippageOptInProps");u();l();var TE=D(L());u();l();var Ss=D(L());var MN=U(1);function bE(e,t,r){let o=Se(),[n,a]=(0,Ss.useState)(!1),c=(0,Ss.useCallback)(async()=>{await o.capture("swapperToggleBestPriceRatio",{data:{unitCurrency:n?"buy token":"sell token"}}),a(!n)},[o,n]),p=V(d=>d.sellFungible),m=V(d=>d.buyFungible);return(0,Ss.useMemo)(()=>{let d=!1,f="";if(t&&r){let h=m?.data,w=p?.data;if(h&&w){let{buyAmount:y,sellAmount:S}=r,T=Ee(y,h.decimals),b=Ee(S,w.decimals),A=T.dividedBy(b),E=`1 ${w.symbol} \u2248 ${_n(A)} ${h.symbol}`,C=`1 ${h.symbol} \u2248 ${_n(MN.dividedBy(A))} ${w.symbol}`;d=new U(r.buyAmount).isEqualTo(e),f=n?C:E}}return{isBestRate:d,rate:f,flip:c}},[e,r,n,t,p,m,c])}s(bE,"useExchangeRate");var ON=s(({selectProvider:e})=>{let{currentQuote:t,quoteResponse:r}=rt(),{currencySymbol:o,fromUsd:n}=mt(),a=t?.buyAmount??"",c=bE(a,r,t),p=qi(Oe(t)),m=t?.baseProvider.name??"";return{details:(0,TE.useMemo)(()=>t?se(t)?qN({quote:t,selectProvider:e,exchangeRate:c,currencySymbol:o,fromUsd:n}):QN({provider:m,sources:p,exchangeRate:c,selectProvider:e}):[],[t,m,p,c,e,o,n]),footnote:v.t("swapProviderPricingFootnote")}},"useSwapPricing"),QN=s(({provider:e,sources:t,exchangeRate:r,selectProvider:o})=>[{label:v.t("swapProviderPricingProvider"),value:e,icon:"chevron-right",onPress:o},{label:v.t("swapProviderPricingMarket"),value:t},{label:v.t("swapProviderPricingPrice"),value:r.rate,icon:"swap",onPress:r.flip}],"getStandardRows"),qN=s(({quote:e,selectProvider:t,exchangeRate:r,currencySymbol:o,fromUsd:n})=>{let a=e.baseProvider.name,c=qn(e).toString(),p=Fr(yo(e));return[{label:v.t("swapProviderPricingProvider"),value:a,icon:"chevron-right",onPress:t},{label:v.t("swapProviderPricingPrice"),value:r.rate,icon:"swap",onPress:r.flip},{label:v.t("swapProviderPricingFees"),value:`${o}${n(Number(c),2)} ${v.t("swapProvidersFee")}`},{label:v.t("swapProviderPricingTime"),value:p}]},"getBridgeRows");u();l();u();l();var dm=D(L());var zN=.05,GN=s(({sellNetworkId:e,buyNetworkId:t,destinationMinRequiredBalance:r,priceMap:o})=>{if(!e||!t||!o)return new _(0);let n=O(gr(x.getChainID(e))),a=O(gr(x.getChainID(t))),c=o[n]?.usd,p=o[a]?.usd;if(!c||!p)return new _(0);let m=Ee(r.toNumber(),x.getTokenDecimals(t)),d=lg(m.toNumber(),p),f=pg(d,c,x.getTokenDecimals(e));return new _(f).times(1+zN)},"getSourceBridgeFeeForMinRequiredBalance"),AE=s(({sellFungible:e,buyFungible:t})=>{let r=e?.data.chain.id,o=t?.data.chain.id,n=o??r,a=$t(r,o),{fungible:c}=ii({key:t?.data.key}),{data:p}=_e(),m=(0,dm.useMemo)(()=>p?.addresses.find(y=>y.networkID===n),[p,n]),f=So().map(y=>gr(y)),{data:h}=to({query:{data:f},queryOptions:{refetchInterval:!1}}),{data:w=0}=Co(m);return(0,dm.useMemo)(()=>{if(c)return new _(0);let y=new _(w);return a?GN({sellNetworkId:r,buyNetworkId:o,destinationMinRequiredBalance:y,priceMap:h}):y},[c,w,a,r,o,h])},"useDestinationMinRequiredBalance");u();l();var mm=D(L());var xE=s(e=>{let t=e?.data.chain.id,{data:r}=_e(),o=(0,mm.useMemo)(()=>r?.addresses.find(a=>a.networkID===t),[r,t]),{data:n=0}=Co(o);return(0,mm.useMemo)(()=>new _(n),[n])},"useSourceMinRequiredBalance");u();l();function EE({sellFungible:e,totalFees:t,minRequiredBalance:r,currentQuote:o}){let n=e?.type?St(e?.type):!1,{source:a,destination:c}=r;if(n){let p=new _(o?.sellAmount??0);return t.plus(p)}else{let p=a.plus(c);return t.plus(p)}}s(EE,"getTotalNativeRequirement");u();l();function kE({sellFungible:e,sellNativeFungible:t,totalNativeRequirement:r}){let o=e?.data.chain.id,n=t?Ct(t.data.amount,t.data.decimals):"-",a=t?Ct(r,t.data.decimals):"-";return{networkId:o,balance:n,required:a}}s(kE,"getInsufficientBalanceArgs");u();l();var CE=D(L());var KN=s(({goToAssetSelect:e})=>{let{setSearchQuery:t}=V();return(0,CE.useCallback)(r=>{r==="buy"&&t(""),e(r)},[e,t])},"useOnSwapAssetSelect");u();l();var Rr=D(L());u();l();u();l();var zu=class{static{s(this,"StandardProviderRowStrategy")}getRow({quote:t,buyToken:r}){let o=`${ar(Ee(t.buyAmount,r.decimals),sr.get(r.networkId).formDisplayPrecision)} ${r.symbol}`;return{type:"standard",key:t.baseProvider.id,logoUri:t.baseProvider.logoUri,topLeft:{text:t.baseProvider.name},topRight:{text:o,color:"textDiminished"}}}getAutoRow(){return{type:"standard",key:ir,topLeft:{text:v.t("selectSwapProviderAutoLabel")},topRight:{text:v.t("selectSwapProviderAutoDescription"),color:"textDiminished"}}}},fm=class extends zu{static{s(this,"BridgeProviderRowStrategy")}getRow(t){let{quote:r,currencySymbol:o,fromUsd:n}=t;if(!se(r))throw new Error("Quote is not a bridge quote");let a=super.getRow(t),c=Fr(yo(r)),p=qn(r).toString();return{...a,type:"bridge",bottomLeft:{text:c},bottomRight:{text:`${o}${n(Number(p),2)} ${v.t("swapProvidersFee")}`}}}getAutoRow(){return{type:"bridge",key:ir,topLeft:{text:v.t("selectSwapProviderAutoLabel")},topRight:{text:v.t("selectSwapProviderAutoDescription"),color:"textDiminished"},bottomLeft:{text:v.t("selectSwapProviderAutoTBD")},bottomRight:{text:v.t("selectSwapProviderAutoTBD")}}}},gm=new zu,hm=new fm;var Gu=s(({quoteResponse:e,buyToken:t,currencySymbol:r,setSelectedProvider:o,fromUsd:n})=>{let a=e.type==="xchain",c=a?hm.getAutoRow():gm.getAutoRow(),p={...c,onPress:s(()=>o(c.key),"onPress")},m=e.quotes.reduce((d,f)=>{let w=(a?hm:gm).getRow({quote:f,buyToken:t,currencySymbol:r,fromUsd:n});return[...d,{...w,onPress:s(()=>o(f.baseProvider.id),"onPress")}]},[]);return[p,...m]},"getSwapProviderRows");var VN=s(({dismiss:e})=>{let{fromUsd:t,currencySymbol:r}=mt(),o=Se(),n=ot(),a=Hr(S=>S.setPreferredProvider),c=Hr(S=>S.preferredProvider),[p,m]=(0,Rr.useState)(c??ir),[d,f]=(0,Rr.useState)(n.getQuoteProcessorState());(0,Rr.useEffect)(()=>{let S=n.subscribeQuoteProcessor({onStateChange(T,b){f(b)}});return()=>S()},[n]);let h=(0,Rr.useMemo)(()=>{let S=d.type;if(S!=="firstQuoteReceived"&&S!=="quoteProcessed")return[];let{response:T,input:b}=d,{buy:A}=b;return Gu({quoteResponse:T,buyToken:{networkId:A.data.chain.id,decimals:A.data.decimals,symbol:A.data.symbol??""},currencySymbol:r,setSelectedProvider:m,fromUsd:t})},[d,r,t]),w=(0,Rr.useCallback)(()=>{let S=p===ir?void 0:p;a(S),o.capture("swapperProviderSelected",{data:{provider:S}}),e()},[p,a,e,o]),y=(0,Rr.useMemo)(()=>[{theme:"secondary",disabled:!1,label:v.t("commandCancel"),onPress:e},{theme:"primary",disabled:p===(c??ir),label:v.t("commandApply"),onPress:w}],[w,e,p,c]);return{selectedProvider:p,rows:h,buttons:y}},"useSelectPreferredProvider");u();l();var $o=D(L());var jN=s(({dismiss:e})=>{let{fromUsd:t,currencySymbol:r}=mt(),o=Se(),n=V(S=>S.quoteResponse),a=V(S=>S.buyFungible),c=V(S=>S.selectedBaseProvider),p=V(S=>S.setSelectedBaseProvider),m=Hr(S=>S.setPreferredProvider),[d,f]=(0,$o.useState)(c),h=(0,$o.useMemo)(()=>!n||!a?[]:Gu({quoteResponse:n,buyToken:{networkId:a.data.chain.id,decimals:a.data.decimals,symbol:a.data.symbol??""},currencySymbol:r,setSelectedProvider:f,fromUsd:t}),[n,a,r,t,f]),w=(0,$o.useCallback)(()=>{p(d),m(d),o.capture("swapperProviderSelected",{data:{provider:d}}),e()},[d,p,m,e,o]),y=(0,$o.useMemo)(()=>[{background:"element",disabled:!1,label:v.t("commandCancel"),onPress:e},{background:"spot",disabled:d===c,label:v.t("commandApply"),onPress:w}],[w,e,d,c]);return{selectedProvider:d,rows:h,buttons:y}},"useSelectSwapProvider");u();l();var Na=D(L());var Da=We(e=>({isInitializeComplete:!0,swapMode:void 0,setSwapMode:s(t=>e({swapMode:t,isInitializeComplete:!1}),"setSwapMode"),setIsInitializeComplete:s(t=>e({isInitializeComplete:t}),"setIsInitializeComplete")})),HN=Da.getState().setSwapMode,$N=s(()=>Da(e=>e.isInitializeComplete===!1),"useInitializingClassicSwapMode"),WN=s(()=>{let e=ot(),t=af(),r=zo(),o=(0,Na.useMemo)(()=>t.find(p=>r.includes(p))??Yo.Mainnet,[t,r]),n=Da(p=>p.swapMode),a=Da(p=>p.setSwapMode),c=Da(p=>p.setIsInitializeComplete);return(0,Na.useEffect)(()=>e.subscribeToken({onStateChange:s(p=>{p.type==="initializeCompleted"&&c(!0)},"onStateChange")}),[e,c]),(0,Na.useMemo)(()=>{if(n)return n;let p={type:"swap",network:o,takerCaip19:void 0,takerDestinationCaip19:void 0};return a(p),p},[o,n,a])},"useClassicSwapMode");u();l();var qe=D(L());u();l();function Ku(e,t,r,o){if(r==="sell")return o.includes("insufficientBalance");let n=e?.sellAmount,a=t.find(c=>c.percentage===1)?.amount.toString();return!!n&&!!a&&new _(n).gt(a)}s(Ku,"hasInsufficientSellBalance");var ZN=s(e=>{let{tokenState:t,quotedAmounts:r,quoteProcessorState:o,sellPercentages:n,inputErrors:a,setAmount:c}=e,p=Ke("enable-be-swapper-max-amount"),[m,d]=(0,qe.useState)(void 0),[f,h]=(0,qe.useState)(""),[w,y]=(0,qe.useState)("crypto"),[S,T]=(0,qe.useState)("sell"),b=(0,qe.useRef)(!1),{currencySymbol:A,toUsd:E,fromUsd:C,formatLocalizedPrice:I}=mt(),N=bf(),{balanceDisplayStrategy:Q}=oT(),R=Ni(),H=fb(),q=ot(),k=(0,qe.useCallback)((Fe,De,at,Ne)=>{if(d(void 0),Fe===""){h(Fe),c({amount:"0",denomination:Ne??w,perspective:De,tokenStateOverride:at});return}let At=bg(Fe);aB(At)&&(h(At),c({amount:w==="fiat"?String(E(At)):At,denomination:Ne??w,perspective:De,tokenStateOverride:at}))},[w,h,c,E]),F=(0,qe.useCallback)((Fe,De)=>{S==="buy"&&T("sell"),d(Fe);let at=Fe.getAmountForDenomination(w),Ne=w==="fiat"?C(at.toString()):at.toString();h(iB(new U(Ne),w,De)),c({amount:at.toString(),denomination:w,perspective:"sell"})},[d,S,w,c,C]),G=(0,qe.useCallback)(()=>{q.switchTokens()},[q]),W=(0,qe.useCallback)(Fe=>{let De=oB({perspective:S,currencyDenomination:w,quotedAmounts:r,fromUsd:C});De&&k(De.toString(),S,Fe)},[w,S,k,r,C]);(0,qe.useEffect)(()=>q.subscribeToken({onStateChange:s((De,at,Ne)=>{De.type==="switchTokens"&&(W(Ne),b.current=!0,p&&q.refreshPair({swapMode:De.mode,cashAddresses:R,settings:H})),p&&De.type==="changeToken"&&(b.current=!0,q.refreshPair({swapMode:De.mode,cashAddresses:R,settings:H}))},"onStateChange")}),[q,W,R,H,p]),(0,qe.useEffect)(()=>{b.current&&(b.current=!1,k(f,S))},[n]);let re=(0,qe.useCallback)(()=>{let Fe=w==="crypto"?"fiat":"crypto";if(y(Fe),!!r)switch(Fe){case"crypto":let De=wm(S,r);h(De.toString());break;case"fiat":let at=ym(S,r)?.toFixed(2)??"0",Ne=C(at);h(String(Ne));break}},[w,S,r,C]),Z=(0,qe.useMemo)(()=>vT(),[]),{sellAsset:He,buyAsset:Ue}=_E(t),st=FT({sellAsset:He,buyAsset:Ue,currencyDenomination:w}),Wo=(0,qe.useMemo)(()=>rB(["sell","buy"],Fe=>YN({perspective:Fe,tokenState:t,quoteProcessorState:o,currencyDenomination:w,currentPerspective:S,inputAmount:f,inputErrors:a,isBalanceHidden:N,balanceDisplayStrategy:Q,sellPercentages:n,currencyDenominationSupportRules:Z,isBuyAmountEditable:st,quotedAmounts:r,currencySymbol:A,fromUsd:C,formatLocalizedPrice:I})),[w,f,a,N,Q,n,S,o,r,t,Z,st,A,C,I]),Ao=(0,qe.useCallback)(()=>{k("",S)},[k,S]);(0,qe.useEffect)(()=>{let Fe=q.subscribeToken({onStateChange(De,at,Ne){!bt(at)||!bt(Ne)||De.type==="changeToken"&&at.sellToken.data.tokenAddress!==Ne.sellToken.data.tokenAddress&&Ao()}});return()=>Fe()},[q,Ao]),(0,qe.useEffect)(()=>q.subscribeAccountChange({onAccountChange:s(De=>{Ao(),q.stopQuoteProcessor();let at=q.getTokenState(),Ne=De.addresses[0];bt(at)&&Ne&&q.initializeSwap({swapMode:{type:"swap",network:Ne.networkID,takerCaip19:void 0,takerDestinationCaip19:void 0},cashAddresses:R,settings:H})},"onAccountChange")}),[q,Ao,R,H]);let La=(0,qe.useCallback)(Fe=>{if(T(Fe),!r||!bt(t))return;let{sellAsset:De,buyAsset:at}=_E(t);if(!(Fe==="sell"?De:at))return;let At,J;switch(w){case"crypto":At=wm(Fe,r).toString(),J=At;break;case"fiat":let bs=ym(Fe,r)?.toFixed(2)??"0";At=String(C(bs)),J=bs;break}h(At),c({amount:J,denomination:w,perspective:Fe})},[w,r,t,C,h,c]);return{inputAmount:f,tokens:Wo,currencyDenomination:w,inputPerspective:S,tokenState:t,quotedAmounts:r,quoteProcessorState:o,inputErrors:a,currentSellPercentage:m,sellPercentages:n,switchTokens:G,setInputAmount:k,switchCurrencyDenomination:re,setSellPercentage:F,clearInput:Ao,setInputPerspective:La,setCurrencyDenomination:y}},"useClassicSwapperAssets");function YN({perspective:e,tokenState:t,quoteProcessorState:r,currencyDenomination:o,currentPerspective:n,inputAmount:a,inputErrors:c,isBalanceHidden:p,balanceDisplayStrategy:m,sellPercentages:d,currencyDenominationSupportRules:f,isBuyAmountEditable:h,quotedAmounts:w,currencySymbol:y,fromUsd:S,formatLocalizedPrice:T}){if(!bt(t))return;let b=eB(e,w),A=tB(e,n,t,a,w),E=o==="crypto"?b:new U(S(A)).toFixed(2),C=sB(a);e===n?E=a:C.gt(0)||(E="");let I=f.every(F=>F.isSupported(e,t.sellToken,t.sellTokenPrice?.usd,t.buyToken,t.buyTokenPrice?.usd)),N=e==="sell"?t.sellToken:t.buyToken,Q=o==="crypto"?T(new U(S(A)).toNumber()):JN(b,N),R=d.find(F=>F.percentage===1)?.amount.toString(),H=e==="sell"?R:void 0,q=XN(w,d,n,c);return{perspective:e,fungible:N,balance:nB(N,m,p,H),amount:E,secondaryAmount:C.gt(0)?Q:"",isAmountLoading:r.type==="starting"&&e!==n,isSecondaryAmountLoading:r.type==="starting",hasAmountWarning:q,isAmountEditable:e==="sell"?!0:h,supportsCurrencyDenominationSwitching:I,amountPrefix:o==="fiat"?y:void 0,percentages:e==="sell"?d:[],warnings:e==="buy"?t.warnings:[]}}s(YN,"createSwapperAsset");function XN(e,t,r,o){return Ku(e,t,r,o)?!0:o.length>0}s(XN,"hasInputAmountWarning");function JN(e,t){let r=sr.get(t.data.chain.id).formDisplayPrecision;return`${ar(new U(e),r)} ${t.data.symbol??""}`}s(JN,"formatSecondaryAmount");function eB(e,t){return t?wm(e,t).toString():"0"}s(eB,"parseCyrptoAmount");function tB(e,t,r,o,n){if(n)return ym(e,n)?.toString()??"0";{if(e!==t||!bt(r))return"0";let a=e==="sell"?r.sellTokenPrice:r.buyTokenPrice;return a?.usd?new U(o).times(a.usd).toString():"0"}}s(tB,"parseFiatAmount");function ym(e,t){switch(e){case"sell":return t?.sellAmountUsd;case"buy":return t?.buyAmountUsd}}s(ym,"getQuotedUsdAmount");function wm(e,t){switch(e){case"sell":return t.sellAmount;case"buy":return t.buyAmount}}s(wm,"getQuotedCryptoAmount");function rB(e,t){return e.reduce((r,o,n)=>{let a=t(o,n,e);return a!=null&&r.push(a),r},[])}s(rB,"compactMap");function oB({perspective:e,currencyDenomination:t,quotedAmounts:r,fromUsd:o}){if(r)switch(e){case"sell":return t==="crypto"?r.buyAmount:r.buyAmountUsd?new U(o(r.buyAmountUsd.toString(),2)):void 0;case"buy":return t==="crypto"?r.sellAmount:r.sellAmountUsd?new U(o(r.sellAmountUsd.toString(),2)):void 0}}s(oB,"getOppositeQuotedAmount");function nB(e,t,r,o){let n=o?U(o):e.data?.balance;if(!(!n||r))return je(e)?Va(n):t.format(n,e.data?.symbol??"")}s(nB,"parseBalance");function sB(e){return e==null?new U(0):e===""?new U(0):new U(e)}s(sB,"normalizeInputAmount");function aB(e){try{let t=new U(e);return t.isFinite()?!t.isNegative():!1}catch{return!1}}s(aB,"isValidAmount");function _E(e){return bt(e)?{sellAsset:e.sellToken,buyAsset:e.buyToken}:{sellAsset:void 0,buyAsset:void 0}}s(_E,"getTokens");var iB=s((e,t,r)=>t==="fiat"?e.gte(.01)?e.decimalPlaces(2).toString():e.decimalPlaces(5,U.ROUND_UP).toString():e.decimalPlaces(r.data.decimals).toString(),"truncateDisplayAmount");u();l();var RE=D(L());u();l();var Sm=D(L());u();l();var Hu=D(L());u();l();u();l();var Vu=class{static{s(this,"GaslessSwapInterceptor")}gaslessSwapFeeResult;insufficientFundsInterceptor;constructor(t,r){this.gaslessSwapFeeResult=t,this.insufficientFundsInterceptor=r}intercept(t){return this.gaslessSwapFeeResult.success?"continue":this.insufficientFundsInterceptor.intercept(t)}};u();l();var ju=class{static{s(this,"InsufficientFundsInterceptor")}intercept({hasInsufficientFunds:t,showInsufficientFunds:r}){return t?(r(),"interrupt"):"continue"}};var IE=s(e=>{let t=new ju,r=cB(e);return r?[new Vu(r,t)]:[t]},"getExecuteSwapInterceptors"),cB=s(e=>{if(e.type!=="firstQuoteReceived"&&e.type!=="quoteProcessed")return;let t=e.quote;if(It(t))return t.gaslessSwapFeeResult},"getGaslessSwapFeeResult");var FE=s(e=>{let t=(0,Hu.useMemo)(()=>IE(e.quoteProcessorState),[e.quoteProcessorState]);return{executeSwapInterceptors:(0,Hu.useCallback)(()=>{for(let o of t){let n=o.intercept(e);if(n==="interrupt")return n}return"continue"},[t,e])}},"useExecuteSwapInterceptors");u();l();var $u=D(L());var vE=s((e,t)=>{let{sellFungible:r,buyFungible:o}=uB(e),n=pB(t),a=xE(r),c=AE({sellFungible:r,buyFungible:o}),p=(0,$u.useMemo)(()=>lB(t),[t]),m=(0,$u.useMemo)(()=>{if(r&&St(r.type)&&x.isBitcoinNetworkID(r.data.chain.id))return r.data.key;let f=r?.data.chain.id;return f?eg(f,void 0):void 0},[r]),{fungible:d}=ii({key:m,enableSorting:!1,enablePrices:!1});return(0,$u.useMemo)(()=>{if(!r||!d||!o||!n)return{hasInsufficientFunds:!1,insufficientFundsArgs:void 0,analyticsFields:void 0};if(je(r)||je(o))return{hasInsufficientFunds:!1,insufficientFundsArgs:void 0,analyticsFields:rd(t)};let f=EE({sellFungible:r,totalFees:p,minRequiredBalance:{source:a,destination:c},currentQuote:n}),h=rd(t);return{hasInsufficientFunds:new _(d?.data.amount??0).lt(f),insufficientFundsArgs:kE({sellFungible:r,sellNativeFungible:d,totalNativeRequirement:f}),analyticsFields:h}},[r,o,n,p,a,c,d,t])},"useHasInsufficientFunds");function uB(e){return e.type!=="pair"?{sellFungible:void 0,buyFungible:void 0}:{sellFungible:e.sellToken,buyFungible:e.buyToken}}s(uB,"getTokens");function lB(e){return e.type!=="quoteProcessed"?new _(0):e.nextProcessedQuote.fees.fees.reduce((t,r)=>t.plus(r.amount),new _(0))}s(lB,"getTotalFees");function pB(e){if(e.type==="quoteProcessed")return e.quote}s(pB,"getQuote");var PE=s(({performSwap:e,goToInsufficientFunds:t,tokenState:r,quoteProcessorState:o})=>{let{hasInsufficientFunds:n,insufficientFundsArgs:a,analyticsFields:c}=vE(r,o),p=(0,Sm.useCallback)(()=>a&&t(a,c),[t,a,c]),{executeSwapInterceptors:m}=FE({hasInsufficientFunds:n,showInsufficientFunds:p,quoteProcessorState:o});return{swap:(0,Sm.useCallback)(()=>{m()==="continue"&&e()},[m,e])}},"useExecuteSwapAction");var bm=class{static{s(this,"ClassicExecuteSwapStateListener")}resetSwapper;constructor(t){this.resetSwapper=t}onStateChange(t,r,o,n){t.type===j.ExecuteSwapStarted&&this.resetSwapper()}},Tm=class{static{s(this,"UpdateBalancesExecuteSwapStateListener")}swapper;constructor(t){this.swapper=t}onStateChange(t,r,o,n){let{sell:a,quote:c}=o.executingQuote;if(t.type===j.TransactionConfirmed){let p=a.data.balance?new _(a.data.balance):void 0;if(!p)return;let m=new _(c.sellAmount).shiftedBy(-a.data.decimals),d=p.minus(m);this.swapper.updateBalances({sellTokenBalance:d,sellTokenCaip19:O(X(a))})}}},dB=s(({swapMode:e,quotedAmounts:t,tokenState:r,inputErrors:o,quoteProcessorState:n,currentPerspective:a,sellPercentages:c,showFungibleDetails:p,showBuyFungibleScreen:m,retryAndNavigateToSwapper:d,resetSwapper:f,goToInsufficientFunds:h,preprocessor:w})=>{let y=ot(),S=HA(),T=(0,RE.useCallback)(()=>{S({showFungibleDetails:p,showBuyFungibleScreen:m,showRetrySwap:d,swapMode:e,executeSwapStateListeners:[new bm(f),new Tm(y)],quotedAmounts:t,uiContext:"swapperClassic",preprocessor:w})},[S,p,m,d,e,f,t,y,w]),{swap:b}=PE({performSwap:T,goToInsufficientFunds:h,tokenState:r,quoteProcessorState:n});return{buttonState:mB(r,o,t,n,a,c),swap:b}},"useClassicSwapperButton"),mB=s((e,t,r,o,n,a)=>e.type!=="pair"?{type:"untradable",label:""}:o.type==="error"?{type:"untradable",label:v.t("swapNoQuotesFound")}:Ku(r,a,n,t)?{type:"insufficientBalance",label:v.t("swapReviewInsufficientBalance")}:o.type!=="quoteProcessed"?{type:"loading",label:v.t("swapReviewFlowActionButtonPrimary")}:r?{type:"tradable",label:v.t("swapReviewFlowActionButtonPrimary")}:{type:"untradable",label:v.t("swapReviewFlowActionButtonPrimary")},"parseTradeButtonState");u();l();var Wu=D(L(),1);u();l();var Xr=s(()=>!0,"defaultShouldDehydrateQueryPredicate"),DE={auth:Xr,tokens:Xr,prices:sg,collectibles:gg,currency:Sf,staking:xg,swapper:xd,transferFungibleLoggingContext:Xr,user:uf,[el]:Xr,[gf]:Xr,[Fa]:Xr,[Eg]:Xr,[Rs]:Xr,[Kt]:Xr,"test-debug-query":Ma},NE=s(e=>{if(e.queryKey.length===0)return!1;let t=String(e.queryKey[0]);return e.state.status!=="success"?!1:DE[t]?DE[t](e):!1},"shouldDehydrateQuery");var BE=new $m({defaultOptions:{mutations:{retry:!1,networkMode:"offlineFirst"},queries:{retry:!1,staleTime:1/0,gcTime:1/0,refetchOnWindowFocus:!1,networkMode:"offlineFirst"}}}),fB=Vm({underlyingStorage:new $f,throttleMs:1e3,enableDebugLogs:Ma()}),gB=s(({children:e})=>(Mh([[og,BE]]),e),"HydrateAtoms"),t1e=s(e=>Wu.default.createElement(Zm,{client:BE,persistOptions:{persister:fB,dehydrateOptions:{shouldDehydrateQuery:NE},buster:hB,maxAge:1/0}},Wu.default.createElement(rg,null,Wu.default.createElement(gB,null,e.children))),"QueryProvider"),hB="25.2.0";u();l();var Ba=D(_m(),1),UE=D(L(),1),Xe=D(Nm(),1);u();l();function xe(e,t,r=$e()){return{jsonrpc:"2.0",id:r,method:e,params:t}}s(xe,"createRpcRequest");u();l();var mr=D(Nm(),1);var wB=s(async()=>{let e=xe("getPhantomOrganization",[]),t=await Je(mr.default.runtime,e);if("error"in t)throw new Error(t.error.message);return t.result},"getPhantomOrganization"),SB=s(async()=>{let e=xe("getOrCreatePhantomOrganization",[]),t=await Je(mr.default.runtime,e);if("error"in t)throw new Error(t.error.message);return t.result},"getOrCreatePhantomOrganization"),bB=s(async()=>{let e=xe("RetrieveKMSWallet",[]),t=await Je(mr.default.runtime,e);if("error"in t)throw new Error(t.error.message);return t.result},"retrieveKMSWallet"),m1e=s(async()=>{let e=xe("GetKMSWalletStatus",[]),t=await Je(mr.default.runtime,e);if("error"in t)throw new Error(t.error.message);return t.result},"getKMSWalletStatus"),f1e=s(async(e,t,r,o,n)=>{let a=xe("addUserToCurrentUserOrganization",[e,t,r,o,n]),c=await Je(mr.default.runtime,a);if("error"in c)throw new Error(c.error.message);return c.result},"addUserToCurrentUserOrganization"),TB=s(async(e,t)=>{let r=xe("deleteUserFromOrganization",[e,t]),o=await Je(mr.default.runtime,r);if("error"in o)throw new Error(o.error.message);return o.result},"deleteUserFromOrganization"),LE=s(()=>({getPhantomOrganization:s(async()=>await wB(),"getPhantomOrganization"),getOrCreatePhantomOrganization:s(async()=>await SB(),"getOrCreatePhantomOrganization"),retrieveKMSWallet:s(async()=>await bB(),"retrieveKMSWallet"),deleteUserFromOrganization:s(async({organizationId:e,username:t})=>await TB(e,t),"deleteUserFromOrganization"),getKmsAccounts:s(async()=>{let e=xe("getKmsAccounts",[]),t=await Je(mr.default.runtime,e);if("error"in t)throw new Error(t.error.message);return t.result},"getKmsAccounts"),getWalletWithTag:s(async({organizationId:e,tag:t})=>{let r=xe("getWalletWithTag",[e,t]),o=await Je(mr.default.runtime,r);if("error"in o)throw new Error(o.error.message);return o.result},"getWalletWithTag"),updateUserInOrganization:s(async({organizationId:e,username:t,newPolicy:r,addTraits:o,removeTraits:n})=>{let a=xe("updateUserInOrganization",[e,t,n,o,r]),c=await Je(mr.default.runtime,a);if("error"in c)throw new Error(c.error.message);return c.result},"updateUserInOrganization"),getAccounts:s(async({organizationId:e,walletId:t,accounts:r})=>{let o=xe("getAccounts",[e,t,r]),n=await Je(mr.default.runtime,o);if("error"in n)throw new Error(n.error.message);return n.result},"getAccounts")}),"createKMSProxy");var AB=LE(),xB=s(async(e,t,r)=>{let o=t.fold(c=>Buffer.from(c.buffer).toString("base64")),n=xe("importPrivateKeyAccount",[e,o,r]),a=await P.startSpan("importPrivateKeyAccount",()=>Je(Xe.default.runtime,n));if("error"in a)throw new Error(a.error.message);if(typeof a.result=="string")return JSON.parse(a.result);throw new Error("importPrivateKeyAccount: Invalid response from background script")},"importPrivateKeyAccount"),_1e=s(async(e,t,r)=>{let o=e.getEntropy(),n=xe("importSeedAccount",[Ba.default.encode(o),t,r]);o.fill(0);let a=await P.startSpan("importSeedAccount",()=>Je(Xe.default.runtime,n));if("error"in a)throw new Error(a.error.message);if(typeof a.result=="string")return JSON.parse(a.result);throw new Error("importS*edAccount: Invalid response from background script")},"importSeedAccount"),I1e=s(async(e,t,r)=>{let o=e.getEntropy(),n=xe("importSocialSeedAccount",[Ba.default.encode(o),t,r]);o.fill(0);let a=await P.startSpan("importSeedlessAccount",()=>Je(Xe.default.runtime,n));if("error"in a)throw new Error(a.error.message);if(typeof a.result=="string")return JSON.parse(a.result);throw new Error("importS*edlessAccount: Invalid response from background script")},"importSeedlessAccount"),F1e=s(async e=>{let t=e.getEntropy(),r=xe("isExistingSeed",Ba.default.encode(t));t.fill(0);let o=await P.startSpan("isExistingSeed",()=>Je(Xe.default.runtime,r));if("error"in o)throw new Error(o.error.message);if(typeof o.result=="boolean"||o.result===null)return o.result;throw new Error("isExistingS*ed: Invalid response from background script")},"isExistingSeed"),EB=s(async e=>{let t=xe("addAccountForSeed",[e]),r=await P.startSpan("addAccountForSeed",async()=>Et(await Xe.default.runtime.sendMessage(Ut(t))));if("error"in r)throw new Error(r.error.message);if(typeof r.result=="string")return JSON.parse(r.result);throw new Error("addAccountForS*ed: Invalid response from background script")},"addAccountForSeed"),kB=s(async e=>{let t=xe("addAccountForSeedless",[e]),r=await P.startSpan("addAccountForSeedless",async()=>Et(await Xe.default.runtime.sendMessage(Ut(t))));if("error"in r)throw new Error(r.error.message);if(typeof r.result=="string")return JSON.parse(r.result);throw new Error("addAccountForS*ed: Invalid response from background script")},"addAccountForSeedless"),CB=s(async(e,t)=>{let r=xe("addLedgerAccounts",[e,t]),o=await P.startSpan("connectLedgerAccounts",async()=>Et(await Xe.default.runtime.sendMessage(Ut(r))));if("error"in o)throw new Error(o.error.message);if(typeof o.result=="string")return JSON.parse(o.result);throw new Error("connectLedgerAccounts: Invalid response from background script")},"connectLedgerAccounts"),_B=s(async e=>{let t=xe("importReadOnlyAccount",e),r=await P.startSpan("addReadonlyAccount",async()=>Et(await Xe.default.runtime.sendMessage(Ut(t))));if("error"in r)throw new Error(r.error.message);if(typeof r.result=="string")return JSON.parse(r.result);throw new Error("addReadonlyAccount: Invalid response from background script")},"addReadonlyAccount"),v1e=s(async(e,t,r)=>{let o=xe("exportPrivateKey",[e,t,r]),n=await P.startSpan("exportPrivateKey",async()=>Et(await Xe.default.runtime.sendMessage(Ut(o))));if("error"in n)throw new Error(n.error.message);if(typeof n.result=="string")return Zu.from(Buffer.from(n.result,"hex"));throw new Error("exportPrivateKey: Invalid response from background script")},"exportPrivateKey"),P1e=s(async(e,t)=>{let r=xe("exportEntropy",[e,t]),o=await P.startSpan("exportEntropy",async()=>Et(await Xe.default.runtime.sendMessage(Ut(r))));if("error"in o)throw new Error(o.error.message);if(typeof o.result=="string")return Zu.from(Buffer.from(o.result,"hex"));throw new Error("exportEntropy: Invalid response from background script")},"exportEntropy"),IB=s(async()=>{let e=xe("deriveAddresses",void 0),t=await Je(Xe.default.runtime,e);if("error"in t)throw new Error(t.error.message);return t.result},"deriveAddresses"),FB=s(async e=>{let t=xe("removeAccount",e),r=await Je(Xe.default.runtime,t);if("error"in r)throw new Error(r.error.message);return r.result},"removeAccount"),vB=s(async(e,t)=>{let r=xe("reorderAccount",{identifier:e,toIndex:t}),o=await Je(Xe.default.runtime,r);if("error"in o)throw new Error(o.error.message);return o.result},"reorderAccount"),PB=s(async()=>{let e=xe("getAllAccounts",void 0),t=Et(await Xe.default.runtime.sendMessage(Ut(e)));if("error"in t)throw new Error(t.error.message);if(typeof t.result=="string"){let r=JSON.parse(t.result);return rf({accounts:r}).accounts}throw new Error("fetchAllAccounts: Invalid response from background script")},"fetchAllAccounts"),RB=s(async()=>{let e=xe("getAllSeeds",void 0),t=Et(await Xe.default.runtime.sendMessage(Ut(e)));if("error"in t)throw new Error(t.error.message);if(typeof t.result=="string")return JSON.parse(t.result);throw new Error("fetchAllSe*dMetas: Invalid response from background script")},"fetchAllSeedMetas"),DB=s(async()=>{let e=xe("getAllSeedlessSeeds",void 0),t=Et(await Xe.default.runtime.sendMessage(Ut(e)));if("error"in t)throw new Error(t.error.message);if(typeof t.result=="string")return JSON.parse(t.result);throw new Error("fetchAllSe*dlessMetas: Invalid response from background script")},"fetchAllSeedlessMetas"),NB=s(async e=>{let t=xe("getAuthenticationPublicKey",{secretIdentifier:e}),r=Et(await Xe.default.runtime.sendMessage(Ut(t)));if("error"in r)throw new Error(r.error.message);if(typeof r.result=="string")return JSON.parse(r.result);throw new Error("getAuthenticationPublicK*y: Invalid response from background script")},"getAuthenticationPublicKey"),BB=s(async()=>{let e=xe("checkVaultIntegrity",void 0),t=Et(await Xe.default.runtime.sendMessage(Ut(e)));if("error"in t)throw new Error(t.error.message);return t.result},"checkVaultIntegrity"),LB=s(async(e,t)=>{let r=of.parse(t);"chainType"in r&&r.chainType===he.Solana&&r.signingType==="transaction"&&typeof r.message!="string"&&(r.message=Ba.default.encode(r.message));let o=xe("sign",{accountIdentifier:e,params:r}),n=Et(await Xe.default.runtime.sendMessage(Ut(o)));if("error"in n)throw new Error(n.error.message);if(typeof n.result=="string")return Et(n.result);throw new Error("sign: Invalid response from background script")},"sign"),ME={addAccountForSeed:EB,addReadonlyAccount:_B,importPrivateKeyAccount:xB,connectLedgerAccounts:CB,fetchAllAccounts:PB,fetchAllSeedMetas:RB,fetchAllSeedlessMetas:DB,connectSolanaSeedVaultAccounts:s(()=>{throw new Error("Solana Seed Vault is not supported on browser extension.")},"connectSolanaSeedVaultAccounts"),deriveAddresses:IB,removeAccount:s(async e=>{if(!await FB(e))throw new Error("Error while removing account")},"removeAccount"),reorderAccount:s(async(e,t)=>{if(!await vB(e,t))throw new Error("Error while reordering account")},"reorderAccount"),sign:LB,getAuthenticationPublicKey:NB,addAccountForSeedless:kB,checkVaultIntegrity:BB,getCashAddress:s(async()=>{throw new Error("getCashAddress: Not implemented on browser extension")},"getCashAddress"),getAgentAddress:s(async()=>{throw new Error("getAgentAddress: Not implemented on browser extension")},"getAgentAddress"),getCashKMSAccount:s(async()=>{throw new Error("getCashKMSAccount: Not implemented on browser extension")},"getCashKMSAccount"),getKMSInstance:s(()=>AB,"getKMSInstance"),addKMSVaultAccount:s(()=>{throw new Error("addKMSVaultAccount: Only callable from background script, not UI")},"addKMSVaultAccount")},R1e=s(()=>ME,"getVaultProxy");function D1e({children:e}){return UE.default.createElement(ef,{vault:ME},e)}s(D1e,"VaultProxyProvider");export{gk as a,ak as b,yL as c,ik as d,ro as e,ck as f,li as g,fk as h,_o as i,Sl as j,hk as k,yk as l,wk as m,bl as n,Tl as o,ft as p,$l as q,Ct as r,Io as s,ql as t,Ek as u,kk as v,Ck as w,Eh as x,Uk as y,Fk as z,Bh as A,jh as B,sSe as C,Ia as D,YD as E,Hd as F,bD as G,Od as H,Qd as I,_a as J,L1 as K,wo as L,Jt as M,Me as N,lp as O,ir as P,V as Q,SS as R,e4 as S,t4 as T,cu as U,Re as V,nC as W,Wh as X,Zh as Y,se as Z,fy as _,ye as $,Ce as aa,vt as ba,Pt as ca,ce as da,co as ea,Vn as fa,cb as ga,be as ha,wb as ia,Sb as ja,$ as ka,Ze as la,rt as ma,Qo as na,Wc as oa,j as pa,Ab as qa,Oe as ra,Bc as sa,kb as ta,Cb as ua,jn as va,lb as wa,Jc as xa,kH as ya,$t as za,Xp as Aa,Mn as Ba,bt as Ca,Ey as Da,F9 as Ea,hv as Fa,ot as Ga,xv as Ha,kv as Ia,yv as Ja,Gn as Ka,qY as La,Kn as Ma,$Y as Na,ab as Oa,GX as Pa,wv as Qa,Mv as Ra,ht as Sa,ha as Ta,gb as Ua,wa as Va,Use as Wa,er as Xa,vP as Ya,PP as Za,NP as _a,vme as $a,HP as ab,bue as bb,mT as cb,aT as db,UP as eb,zo as fb,bd as gb,YP as hb,JP as ib,Gle as jb,oR as kb,Jle as lb,epe as mb,tpe as nb,aR as ob,cpe as pb,upe as qb,iR as rb,hpe as sb,ype as tb,VP as ub,wR as vb,SR as wb,Td as xb,bR as yb,jce as zb,jP as Ab,TR as Bb,Bd as Cb,T1 as Db,A1 as Eb,B1 as Fb,Kd as Gb,Vd as Hb,jd as Ib,ED as Jb,kD as Kb,Yd as Lb,$D as Mb,tN as Nb,aN as Ob,uN as Pb,lN as Qb,em as Rb,tm as Sb,rm as Tb,Bt as Ub,Uu as Vb,SE as Wb,pE as Xb,gE as Yb,wE as Zb,BN as _b,UN as $b,KN as ac,VN as bc,jN as cc,ON as dc,$N as ec,WN as fc,ZN as gc,dB as hc,NE as ic,BE as jc,t1e as kc,xe as lc,bB as mc,m1e as nc,f1e as oc,LE as pc,_1e as qc,I1e as rc,F1e as sc,v1e as tc,P1e as uc,DB as vc,R1e as wc,D1e as xc};
/*! Bundled license information:

use-sync-external-store/cjs/use-sync-external-store-shim.production.js:
  (**
   * @license React
   * use-sync-external-store-shim.production.js
   *
   * Copyright (c) Meta Platforms, Inc. and affiliates.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE file in the root directory of this source tree.
   *)

use-sync-external-store/cjs/use-sync-external-store-shim.development.js:
  (**
   * @license React
   * use-sync-external-store-shim.development.js
   *
   * Copyright (c) Meta Platforms, Inc. and affiliates.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE file in the root directory of this source tree.
   *)

use-sync-external-store/cjs/use-sync-external-store-shim/with-selector.production.js:
  (**
   * @license React
   * use-sync-external-store-shim/with-selector.production.js
   *
   * Copyright (c) Meta Platforms, Inc. and affiliates.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE file in the root directory of this source tree.
   *)

use-sync-external-store/cjs/use-sync-external-store-shim/with-selector.development.js:
  (**
   * @license React
   * use-sync-external-store-shim/with-selector.development.js
   *
   * Copyright (c) Meta Platforms, Inc. and affiliates.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE file in the root directory of this source tree.
   *)

pako/dist/pako.esm.mjs:
  (*! pako 2.1.0 https://github.com/nodeca/pako @license (MIT AND Zlib) *)
*/
//# sourceMappingURL=chunk-Q2TGNWPS.js.map
